(function(a){a.jgrid={defaults:{recordtext:"View {0} - {1} of {2}",emptyrecords:"No records to view",loadtext:"Loading...",pgtext:"Page {0} of {1}"},search:{caption:"Search...",Find:"Find",Reset:"Reset",odata:["equal","not equal","less","less or equal","greater","greater or equal","begins with","does not begin with","is in","is not in","ends with","does not end with","contains","does not contain"],groupOps:[{op:"AND",text:"all"},{op:"OR",text:"any"}],matchText:" match",rulesText:" rules"},edit:{addCaption:"Add Record",
editCaption:"Edit Record",bSubmit:"Submit",bCancel:"Cancel",bClose:"Close",saveData:"Data has been changed! Save changes?",bYes:"Yes",bNo:"No",bExit:"Cancel",msg:{required:"Field is required",number:"Please, enter valid number",minValue:"value must be greater than or equal to ",maxValue:"value must be less than or equal to",email:"is not a valid e-mail",integer:"Please, enter valid integer value",date:"Please, enter valid date value",url:"is not a valid URL. Prefix required ('http://' or 'https://')"}},
view:{caption:"View Record",bClose:"Close"},del:{caption:"Delete",msg:"Delete selected record(s)?",bSubmit:"Delete",bCancel:"Cancel"},nav:{edittext:"",edittitle:"Edit selected row",addtext:"",addtitle:"Add new row",deltext:"",deltitle:"Delete selected row",searchtext:"",searchtitle:"Find records",refreshtext:"",refreshtitle:"Reload Grid",alertcap:"Warning",alerttext:"Please, select row",viewtext:"",viewtitle:"View selected row"},col:{caption:"Show/Hide Columns",bSubmit:"Submit",bCancel:"Cancel"},
errors:{errcap:"Error",nourl:"No url is set",norecords:"No records to process",model:"Length of colNames <> colModel!"},formatter:{integer:{thousandsSeparator:" ",defaultValue:"0"},number:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,defaultValue:"0.00"},currency:{decimalSeparator:".",thousandsSeparator:" ",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0.00"},date:{dayNames:["Sun","Mon","Tue","Wed","Thr","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],AmPm:["am","pm","AM","PM"],S:function(b){return b<11||b>13?["st","nd","rd","th"][Math.min((b-1)%10,3)]:"th"},srcformat:"Y-m-d",newformat:"d/m/Y",masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",
SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:false},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:true},idName:"id"}}})(jQuery);
(function(a){a.jgrid=a.jgrid||{};a.extend(a.jgrid,{htmlDecode:function(b){if(b=="&nbsp;"||b=="&#160;"||b.length==1&&b.charCodeAt(0)==160)return"";return!b?b:String(b).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},htmlEncode:function(b){return!b?b:String(b).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")},format:function(b){var d=a.makeArray(arguments).slice(1);return b.replace(/\{(\d+)\}/g,function(c,f){return d[f]})},
getAbsoluteIndex:function(b,d){var c=0,f=0,g,h;if(a.browser.version>7)return d;for(h=0;h<b.cells.length;h++){g=b.cells(h);if(g.style.display=="none")c++;else f++;if(f>d)return h}return h},stripHtml:function(b){var d=/<("[^"]*"|'[^']*'|[^'">])*>/gi;return b?b.replace(d,""):b},stringToDoc:function(b){var d;if(typeof b!=="string")return b;try{d=(new DOMParser).parseFromString(b,"text/xml")}catch(c){d=new ActiveXObject("Microsoft.XMLDOM");d.async=false;d.loadXML(b)}return d&&d.documentElement&&d.documentElement.tagName!=
"parsererror"?d:null},parse:function(b){b=b;if(b.substr(0,9)=="while(1);")b=b.substr(9);if(b.substr(0,2)=="/*")b=b.substr(2,b.length-4);b||(b="{}");with(window)return eval("("+b+")")},empty:function(){for(;this.firstChild;)this.removeChild(this.firstChild)}});a.fn.jqGrid=function(b){b=a.extend(true,{url:"",height:150,page:1,rowNum:20,records:0,pager:"",pgbuttons:true,pginput:true,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:false,selarrrow:[],savedRow:[],
shrinkToFit:true,xmlReader:{},jsonReader:{},subGrid:false,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:false,loadonce:false,multiselect:false,multikey:false,editurl:null,search:false,caption:"",hidegrid:true,hiddengrid:false,
postData:{},userData:{},treeGrid:false,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd"},forceFit:false,gridstate:"visible",cellEdit:false,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[false,""],scroll:false,multiboxonly:false,deselectAfterSort:true,scrollrows:false,autowidth:false,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:false,rownumWidth:25,
rownumbers:false,pagerpos:"center",recordpos:"right",footerrow:false,userDataOnFooter:false,hoverrows:true,altclass:"ui-priority-secondary",viewsortcols:[false,"vertical",true],resizeclass:"",autoencode:false},a.jgrid.defaults,b||{});var d={headers:[],cols:[],footers:[],dragStart:function(c,f,g){this.resizing={idx:c,startX:f.clientX,sOL:g[0]};this.hDiv.style.cursor="col-resize";this.curGbox=a("#rs_m"+b.id,"#gbox_"+b.id);this.curGbox.css({display:"block",left:g[0],top:g[1],height:g[2]});document.onselectstart=
new Function("return false")},dragMove:function(c){if(this.resizing){var f=c.clientX-this.resizing.startX;c=this.headers[this.resizing.idx];var g=c.width+f,h;if(g>33){this.curGbox.css({left:this.resizing.sOL+f});if(b.forceFit===true){h=this.headers[this.resizing.idx+b.nv];f=h.width-f;if(f>33){c.newWidth=g;h.newWidth=f;this.newWidth=b.tblwidth}}else{this.newWidth=b.tblwidth+f;c.newWidth=g}}}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var c=this.resizing.idx,f=this.headers[c].newWidth||
this.headers[c].width;this.resizing=false;a("#rs_m"+b.id).css("display","none");b.colModel[c].width=f;this.headers[c].width=f;this.headers[c].el.style.width=f+"px";if(this.cols.length>0)this.cols[c].style.width=f+"px";if(this.footers.length>0)this.footers[c].style.width=f+"px";if(b.forceFit===true){f=this.headers[c+b.nv].newWidth||this.headers[c+b.nv].width;this.headers[c+b.nv].width=f;this.headers[c+b.nv].el.style.width=f+"px";if(this.cols.length>0)this.cols[c+b.nv].style.width=f+"px";if(this.footers.length>
0)this.footers[c+b.nv].style.width=f+"px";b.colModel[c+b.nv].width=f}else{b.tblwidth=this.newWidth;a("table:first",this.bDiv).css("width",b.tblwidth+"px");a("table:first",this.hDiv).css("width",b.tblwidth+"px");this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(b.footerrow){a("table:first",this.sDiv).css("width",b.tblwidth+"px");this.sDiv.scrollLeft=this.bDiv.scrollLeft}}}this.curGbox=null;document.onselectstart=new Function("return true")},scrollGrid:function(){if(b.scroll===true){var c=this.bDiv.scrollTop;
if(c!=this.scrollTop){this.scrollTop=c;if(this.bDiv.scrollHeight-c-a(this.bDiv).height()<=0)if(parseInt(b.page,10)+1<=parseInt(b.lastpage,10)){b.page=parseInt(b.page,10)+1;this.populate()}}}this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(b.footerrow)this.sDiv.scrollLeft=this.bDiv.scrollLeft}};return this.each(function(){if(!this.grid){this.p=b;var c;if(this.p.colNames.length===0)for(c=0;c<this.p.colModel.length;c++)this.p.colNames[c]=this.p.colModel[c].label||this.p.colModel[c].name;if(this.p.colNames.length!==
this.p.colModel.length)alert(a.jgrid.errors.model);else{var f=a("<div class='ui-jqgrid-view'></div>"),g,h=a.browser.msie?true:false,j=a.browser.safari&&!window.chrome?true:false;a(f).insertBefore(this);a(this).appendTo(f).removeClass("scroll");var k=a("<div class='ui-jqgrid ui-widget ui-widget-content ui-corner-all'></div>");a(k).insertBefore(f).attr("id","gbox_"+this.id);a(f).appendTo(k).attr("id","gview_"+this.id);g=h&&a.browser.version<=6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':
"";a("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(g).insertBefore(f);a("<div class='loading ui-state-default ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(f);a(this).attr({cellSpacing:"0",cellPadding:"0",border:"0",role:"grid","aria-multiselectable":this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var e=this,l=a.isFunction(this.p.beforeSelectRow)?this.p.beforeSelectRow:false;g=a.isFunction(this.p.ondblClickRow)?this.p.ondblClickRow:
false;var o=a.isFunction(this.p.onSortCol)?this.p.onSortCol:false,m=a.isFunction(this.p.loadComplete)?this.p.loadComplete:false,n=a.isFunction(this.p.loadError)?this.p.loadError:false,q=a.isFunction(this.p.loadBeforeSend)?this.p.loadBeforeSend:false,r=a.isFunction(this.p.onRightClickRow)?this.p.onRightClickRow:false,t=a.isFunction(this.p.afterInsertRow)?this.p.afterInsertRow:false,v=a.isFunction(this.p.onHeaderClick)?this.p.onHeaderClick:false,w=a.isFunction(this.p.beforeRequest)?this.p.beforeRequest:
false,z=a.isFunction(this.p.onCellSelect)?this.p.onCellSelect:false,B=function(s,x){s=parseInt(s,10);return isNaN(s)?x?x:0:s},p=function(s,x){var u=e.p.colModel[s].align,I='style="',E=e.p.colModel[s].classes;if(u)I+="text-align:"+u+";";if(e.p.colModel[s].hidden===true)I+="display:none;";if(x===0)I+="width: "+d.headers[s].width+"px;";return I+'"'+(E!==undefined?' class="'+E+'"':"")},y=function(s,x,u,I,E){s=G(s,x,u,E,"add");return'<td role="gridcell" '+p(u,I)+">"+s+"</td>"},G=function(s,x,u,I,E){u=
e.p.colModel[u];if(typeof u.formatter!=="undefined"){s={rowId:s,colModel:u};x=a.isFunction(u.formatter)?u.formatter(x,s,I,E):a.fmatter?a.fn.fmatter(u.formatter,x,s,I,E):D(x)}else x=D(x);return x},D=function(s){return s===undefined||s===null||s===""?"&#160;":e.p.autoencode?a.jgrid.htmlEncode(s+""):s+""},Q=function(s,x,u){s='<input type="checkbox" id="jqg_'+s+'" class="cbox" name="jqg_'+s+'"/>';return"<td role='gridcell' "+p(x,u)+">"+s+"</td>"},Y=function(s,x,u,I){u=(parseInt(u)-1)*parseInt(I)+1+x;
return'<td role="gridcell" class="ui-state-default jqgrid-rownum" '+p(s,x)+">"+u+"</td>"},aa=function(s){var x,u=[],I=0,E;for(E=0;E<e.p.colModel.length;E++){x=e.p.colModel[E];if(x.name!=="cb"&&x.name!=="subgrid"&&x.name!=="rn"){u[I]=s=="xml"?x.xmlmap||x.name:x.jsonmap||x.name;I++}}return u},Z=function(s,x,u){var I=new Date;e.p.reccount=0;if(a.isXMLDoc(s)){if(e.p.treeANode===-1&&e.p.scroll===false){var E=a("tbody:first",x);e.p.gridview||a("*",E).children().unbind();if(h)a.jgrid.empty.apply(E[0]);else E[0].innerHTML=
"";E=null;u=0}else u=u>0?u:0;var N;E=0;var J,C,F=0,K=0,L=0,ba,T,ca=[],ka={},wa=e.rows.length,oa,ea,na=[],ga=0,Ca=e.p.altRows===true?e.p.altclass:"";e.p.xmlReader.repeatitems||(ca=aa("xml"));if(e.p.keyIndex===false){ba=e.p.xmlReader.id;T=ba.indexOf("[")===-1?function(xa,Da){return a(ba,xa).text()||Da}:function(xa,Da){return xa.getAttribute(ba.replace(/[\[\]]/g,""))||Da}}else T=function(xa){return ca.length-1>=e.p.keyIndex?a(ca[e.p.keyIndex],xa).text():a(e.p.xmlReader.cell+":eq("+e.p.keyIndex+")",xa).text()};
a(e.p.xmlReader.page,s).each(function(){e.p.page=this.textContent||this.text||1});a(e.p.xmlReader.total,s).each(function(){e.p.lastpage=this.textContent||this.text||1});a(e.p.xmlReader.records,s).each(function(){e.p.records=this.textContent||this.text||0});a(e.p.xmlReader.userdata,s).each(function(){e.p.userData[this.getAttribute("name")]=this.textContent||this.text});s=a(e.p.xmlReader.root+" "+e.p.xmlReader.row,s);var za=s.length,ra=0;if(s&&za)for(var Ea=e.p.rowNum;ra<za;){oa=s[ra];ea=T(oa,ra+1);
N=ra%2==1?Ca:"";na[ga++]='<tr id="'+ea+'" role="row" class ="ui-widget-content jqgrow '+N+'">';if(e.p.rownumbers===true){na[ga++]=Y(0,ra,e.p.page,e.p.rowNum);L=1}if(e.p.multiselect===true){na[ga++]=Q(ea,L,ra);F=1}if(e.p.subGrid===true){na[ga++]=a(e).addSubGridCell(F+L,ra+u);K=1}if(e.p.xmlReader.repeatitems===true)a(e.p.xmlReader.cell,oa).each(function(xa){J=this.textContent||this.text;ka[e.p.colModel[xa+F+K+L].name]=J;na[ga++]=y(ea,J,xa+F+K+L,ra+u,oa)});else for(N=0;N<ca.length;N++){J=a(ca[N],oa).text();
ka[e.p.colModel[N+F+K+L].name]=J;na[ga++]=y(ea,J,N+F+K+L,ra+u,oa)}na[ga++]="</tr>";if(e.p.gridview===false){if(e.p.treeGrid===true){N=e.p.treeANode>=-1?e.p.treeANode:0;C=a(na.join(""))[0];try{a(e).setTreeNode(ka,C)}catch(Ga){}wa===0?a("tbody:first",x).append(C):a(e.rows[ra+N+u]).after(C)}else a("tbody:first",x).append(na.join(""));if(e.p.subGrid===true)try{a(e).addSubGrid(e.rows[e.rows.length-1],F+L)}catch(Ia){}t&&e.p.afterInsertRow(ea,ka,oa);na=[];ga=0}ka={};E++;ra++;if(Ea!=-1&&E>Ea)break}e.p.gridview===
true&&a("table:first",x).append(na.join(""));e.p.totaltime=new Date-I;if(E>0){e.grid.cols=e.rows[0].cells;if(e.p.records===0)e.p.records=za}na=null;if(!e.p.treeGrid&&!e.p.scroll){e.grid.bDiv.scrollTop=0;e.p.reccount=E}e.p.treeANode=-1;e.p.userDataOnFooter&&a(e).footerData("set",e.p.userData,true);ha(false)}},fa=function(s,x,u){var I=new Date;e.p.reccount=0;if(s){if(e.p.treeANode===-1&&e.p.scroll===false){u=a("tbody:first",x);e.p.gridview||a("*",u).children().unbind();if(h)a.jgrid.empty.apply(u[0]);
else u[0].innerHTML="";u=0}else u=u>0?u:0;var E=0,N,J,C,F=[],K,L=0,ba=0,T=0,ca,ka,wa,oa={},ea,na=e.rows.length,ga;C=[];ea=0;var Ca=e.p.altRows===true?e.p.altclass:"";e.p.page=s[e.p.jsonReader.page]||1;e.p.lastpage=s[e.p.jsonReader.total]||1;e.p.records=s[e.p.jsonReader.records]||0;e.p.userData=s[e.p.jsonReader.userdata]||{};e.p.jsonReader.repeatitems||(F=aa("json"));if(e.p.keyIndex===false){wa=e.p.jsonReader.id;if(F.length>0&&!isNaN(wa))wa=F[wa]}else wa=F.length>0?F[e.p.keyIndex]:e.p.keyIndex;if(ka=
s[e.p.jsonReader.root]){ca=ka.length;s=0;for(var za=e.p.rowNum;s<ca;){K=ka[s];ga=K[wa];if(ga===undefined)ga=F.length===0?e.p.jsonReader.cell?K[e.p.jsonReader.cell][wa]||s+1:s+1:s+1;N=s%2==1?Ca:"";C[ea++]='<tr id="'+ga+'" role="row" class= "ui-widget-content jqgrow '+N+'">';if(e.p.rownumbers===true){C[ea++]=Y(0,s,e.p.page,e.p.rowNum);T=1}if(e.p.multiselect){C[ea++]=Q(ga,T,s);L=1}if(e.p.subGrid){C[ea++]=a(e).addSubGridCell(L+T,s+u);ba=1}if(e.p.jsonReader.repeatitems===true){if(e.p.jsonReader.cell)K=
K[e.p.jsonReader.cell];for(J=0;J<K.length;J++){C[ea++]=y(ga,K[J],J+L+ba+T,s+u,K);oa[e.p.colModel[J+L+ba+T].name]=K[J]}}else for(J=0;J<F.length;J++){N=K[F[J]];if(N===undefined)try{N=eval("cur."+F[J])}catch(ra){}C[ea++]=y(ga,N,J+L+ba+T,s+u,K);oa[e.p.colModel[J+L+ba+T].name]=K[F[J]]}C[ea++]="</tr>";if(e.p.gridview===false){if(e.p.treeGrid===true){ea=e.p.treeANode>=-1?e.p.treeANode:0;C=a(C.join(""))[0];try{a(e).setTreeNode(oa,C)}catch(Ea){}na===0?a("tbody:first",x).append(C):a(e.rows[s+ea+u]).after(C)}else a("tbody:first",
x).append(C.join(""));if(e.p.subGrid===true)try{a(e).addSubGrid(e.rows[e.rows.length-1],L+T)}catch(Ga){}t&&e.p.afterInsertRow(ga,oa,K);C=[];ea=0}oa={};E++;s++;if(za!=-1&&E>za)break}e.p.gridview===true&&a("table:first",x).append(C.join(""));e.p.totaltime=new Date-I;if(E>0){e.grid.cols=e.rows[0].cells;if(e.p.records===0)e.p.records=ca}}if(!e.p.treeGrid&&!e.p.scroll){e.grid.bDiv.scrollTop=0;e.p.reccount=E}e.p.treeANode=-1;e.p.userDataOnFooter&&a(e).footerData("set",e.p.userData,true);ha(false)}},ha=
function(s){var x,u,I,E,N,J,C;I=(parseInt(e.p.page)-1)*parseInt(e.p.rowNum);if(e.p.pager){if(e.p.loadonce){x=u=1;e.p.lastpage=e.page=1;a(".selbox",e.p.pager).attr("disabled",true)}else{x=B(e.p.page);u=B(e.p.lastpage);a(".selbox",e.p.pager).attr("disabled",false)}if(e.p.pginput===true){a(".ui-pg-input",e.p.pager).val(e.p.page);a("#sp_1",e.p.pager).html(e.p.lastpage)}if(e.p.viewrecords){E=e.p.scroll===true?0:I;if(e.p.reccount===0)a(".ui-paging-info",e.p.pager).html(e.p.emptyrecords);else{E=E+1;N=I+
e.p.reccount;J=e.p.records;if(a.fmatter){C=a.jgrid.formatter.integer||{};E=a.fmatter.util.NumberFormat(E,C);N=a.fmatter.util.NumberFormat(N,C);J=a.fmatter.util.NumberFormat(J,C)}a(".ui-paging-info",e.p.pager).html(a.jgrid.format(e.p.recordtext,E,N,J))}}if(e.p.pgbuttons===true){if(x<=0)x=u=1;x==1?a("#first, #prev",e.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover"):a("#first, #prev",e.p.pager).removeClass("ui-state-disabled");x==u?a("#next, #last",e.p.pager).addClass("ui-state-disabled").removeClass("ui-state-hover"):
a("#next, #last",e.p.pager).removeClass("ui-state-disabled")}}s===true&&e.p.rownumbers===true&&a("td.jqgrid-rownum",e.rows).each(function(F){a(this).html(I+1+F)});a.isFunction(e.p.gridComplete)&&e.p.gridComplete()},ia=function(){if(!e.grid.hDiv.loading){var s={},x,u=e.p.prmNames;if(u.search!==null)s[u.search]=e.p.search;if(u.nd!=null)s[u.nd]=(new Date).getTime();if(u.rows!==null)s[u.rows]=e.p.rowNum;if(u.page!==null)s[u.page]=e.p.page;if(u.sort!==null)s[u.sort]=e.p.sortname;if(u.order!==null)s[u.order]=
e.p.sortorder;a.extend(e.p.postData,s);var I=e.p.scroll===false?0:e.rows.length-1;if(a.isFunction(e.p.datatype))e.p.datatype(e.p.postData,"load_"+e.p.id);else{w&&e.p.beforeRequest();x=e.p.datatype.toLowerCase();switch(x){case "json":case "jsonp":case "xml":case "script":a.ajax({url:e.p.url,type:e.p.mtype,dataType:x,data:e.p.postData,complete:function(E,N){if(N=="success"||E.statusText=="OK"&&E.status=="200"){x==="xml"?Z(E.responseXML,e.grid.bDiv,I):fa(a.jgrid.parse(E.responseText),e.grid.bDiv,I);
m&&m(E)}sa()},error:function(E,N,J){n&&n(E,N,J);sa()},beforeSend:function(E){pa();q&&q(E)}});if(e.p.loadonce||e.p.treeGrid)e.p.datatype="local";break;case "xmlstring":pa();Z(s=a.jgrid.stringToDoc(e.p.datastr),e.grid.bDiv);e.p.datatype="local";m&&m(s);e.p.datastr=null;sa();break;case "jsonstring":pa();s=typeof e.p.datastr=="string"?a.jgrid.parse(e.p.datastr):e.p.datastr;fa(s,e.grid.bDiv);e.p.datatype="local";m&&m(s);e.p.datastr=null;sa();break;case "local":case "clientside":pa();e.p.datatype="local";
ya();sa();break}}}},pa=function(){e.grid.hDiv.loading=true;if(!e.p.hiddengrid)switch(e.p.loadui){case "disable":break;case "enable":a("#load_"+e.p.id).show();break;case "block":a("#lui_"+e.p.id).show();a("#load_"+e.p.id).show();break}},sa=function(){e.grid.hDiv.loading=false;switch(e.p.loadui){case "disable":break;case "enable":a("#load_"+e.p.id).hide();break;case "block":a("#lui_"+e.p.id).hide();a("#load_"+e.p.id).hide();break}},ya=function(){var s=/[\$,%]/g,x=[],u=0,I,E,N,J=e.p.sortorder=="asc"?
1:-1;a.each(e.p.colModel,function(C){if(this.index==e.p.sortname||this.name==e.p.sortname){u=e.p.lastsort=C;I=this.sorttype;return false}});N=I=="float"||I=="number"||I=="currency"?function(C){C=parseFloat(C.replace(s,""));return isNaN(C)?0:C}:I=="int"||I=="integer"?function(C){return B(C.replace(s,""))}:I=="date"?function(C){var F=e.p.colModel[u].datefmt||"Y-m-d",K=C;C={m:1,d:1,y:1970,h:0,i:0,s:0};var L,ba,T;K=K.split(/[\\\/:_;.\t\T\s-]/);F=F.split(/[\\\/:_;.\t\T\s-]/);var ca=a.jgrid.formatter.date.monthNames;
L=0;for(ba=F.length;L<ba;L++){if(F[L]=="M"){T=a.inArray(K[L],ca);if(T!==-1&&T<12)K[L]=T+1}if(F[L]=="F"){T=a.inArray(K[L],ca);if(T!==-1&&T>11)K[L]=T+1-12}C[F[L].toLowerCase()]=parseInt(K[L],10)}C.m=parseInt(C.m,10)-1;F=C.y;if(F>=70&&F<=99)C.y=1900+C.y;else if(F>=0&&F<=69)C.y=2E3+C.y;return(new Date(C.y,C.m,C.d,C.h,C.i,C.s,0)).getTime()}:function(C){return a.trim(C.toUpperCase())};a.each(e.rows,function(C,F){try{E=a.unformat(a(F).children("td").eq(u),{colModel:e.p.colModel[u]},u,true)}catch(K){E=a(F).children("td").eq(u).text()}F.sortKey=
N(E);x[C]=this});if(e.p.treeGrid)a(e).SortTree(J);else{x.sort(function(C,F){if(C.sortKey<F.sortKey)return-J;if(C.sortKey>F.sortKey)return J;return 0});if(x[0]){a("td",x[0]).each(function(C){a(this).css("width",d.headers[C].width+"px")});d.cols=x[0].cells}a.each(x,function(C,F){a("tbody",e.grid.bDiv).append(F);F.sortKey=null})}if(e.p.multiselect){a("tbody tr",e.grid.bDiv).removeClass("ui-state-highlight");a("[id^=jqg_]",e.rows).attr("checked",false);a("#cb_jqg",e.grid.hDiv).attr("checked",false);e.p.selarrrow=
[]}e.grid.bDiv.scrollTop=0},A=function(){var s=a(e.p.pager).attr("id")||"pager",x=e.p.pginput===true?"<td>"+a.jgrid.format(e.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1'></span>")+"</td>":"",u="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",I,E,N,J,C=function(F){a.isFunction(e.p.onPaging)&&e.p.onPaging(F);e.p.selrow=null;if(e.p.multiselect){e.p.selarrrow=[];a("#cb_jqg",
e.grid.hDiv).attr("checked",false)}e.p.savedRow=[]};I="pg_"+s;E=s+"_left";N=s+"_center";J=s+"_right";a(e.p.pager).addClass("ui-jqgrid-pager corner-bottom").append("<div id='"+I+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;' role='row'><tbody><tr><td id='"+E+"' align='left'></td><td id='"+N+"' align='center' style='white-space:nowrap;'></td><td id='"+J+"' align='right'></td></tr></tbody></table></div>");
if(e.p.pgbuttons===true){u+="<td id='first' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-first'></span></td>";u+="<td id='prev' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-prev'></span></td>";u+=x!=""?"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>"+x+"<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>":"";u+="<td id='next' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-next'></span></td>";
u+="<td id='last' class='ui-pg-button ui-corner-all'><span class='ui-icon ui-icon-seek-end'></span></td>"}else if(x!="")u+=x;if(e.p.rowList.length>0){x="<select class='ui-pg-selbox' role='listbox'>";for(E=0;E<e.p.rowList.length;E++)x+="<option role='option' value="+e.p.rowList[E]+(e.p.rowNum==e.p.rowList[E]?" selected":"")+">"+e.p.rowList[E];x+="</select>";u+="<td>"+x+"</td>"}u+="</tr></tbody></table>";e.p.viewrecords===true&&a("td#"+s+"_"+e.p.recordpos,"#"+I).append("<div style='text-align:"+e.p.recordpos+
"' class='ui-paging-info'></div>");a("td#"+s+"_"+e.p.pagerpos,"#"+I).append(u);x=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+x+";visibility:hidden;' ></div>");u=a(u).clone().appendTo("#testpg").width();a("#testpg").remove();if(u>0){u+=25;a("td#"+s+"_"+e.p.pagerpos,"#"+I).width(u)}e.p._nvtd=[];e.p._nvtd[0]=u?Math.floor((e.p.width-u)/2):Math.floor(e.p.width/3);e.p._nvtd[1]=0;u=null;a(".ui-pg-selbox","#"+
I).bind("change",function(){e.p.page=Math.round(e.p.rowNum*(e.p.page-1)/this.value-0.5)+1;e.p.rowNum=this.value;C("records");ia();return false});if(e.p.pgbuttons===true){a(".ui-pg-button","#"+I).hover(function(){if(a(this).hasClass("ui-state-disabled"))this.style.cursor="default";else{a(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(){if(!a(this).hasClass("ui-state-disabled")){a(this).removeClass("ui-state-hover");this.style.cursor="default"}});a("#first, #prev, #next, #last",
e.p.pager).click(function(){var F=B(e.p.page),K=B(e.p.lastpage),L=false,ba=true,T=true,ca=true,ka=true;if(K===0||K===1)ka=ca=T=ba=false;else if(K>1&&F>=1)if(F===1)T=ba=false;else{if(!(F>1&&F<K))if(F===K)ka=ca=false}else if(K>1&&F===0){ka=ca=false;F=K-1}if(this.id==="first"&&ba){e.p.page=1;L=true}if(this.id==="prev"&&T){e.p.page=F-1;L=true}if(this.id==="next"&&ca){e.p.page=F+1;L=true}if(this.id==="last"&&ka){e.p.page=K;L=true}if(L){C(this.id);ia()}return false})}e.p.pginput===true&&a("input.ui-pg-input",
"#"+I).keypress(function(F){if((F.charCode?F.charCode:F.keyCode?F.keyCode:0)==13){e.p.page=a(this).val()>0?a(this).val():e.p.page;C("user");ia();return false}return this})},H=function(s,x,u,I){if(e.p.colModel[x].sortable)if(!(e.p.savedRow.length>0)){if(!u){if(e.p.lastsort==x)if(e.p.sortorder=="asc")e.p.sortorder="desc";else{if(e.p.sortorder=="desc")e.p.sortorder="asc"}else e.p.sortorder="asc";e.p.page=1}if(I)if(e.p.lastsort==x&&e.p.sortorder==I)return;else e.p.sortorder=I;u=a("thead:first",e.grid.hDiv).get(0);
a("tr th:eq("+e.p.lastsort+") span.ui-grid-ico-sort",u).addClass("ui-state-disabled");a("tr th:eq("+e.p.lastsort+")",u).attr("aria-selected","false");a("tr th:eq("+x+") span.ui-icon-"+e.p.sortorder,u).removeClass("ui-state-disabled");a("tr th:eq("+x+")",u).attr("aria-selected","true");if(!e.p.viewsortcols[0])if(e.p.lastsort!=x){a("tr th:eq("+e.p.lastsort+") span.s-ico",u).hide();a("tr th:eq("+x+") span.s-ico",u).show()}e.p.lastsort=x;s=s.substring(5);e.p.sortname=e.p.colModel[x].index||s;u=e.p.sortorder;
o&&o(s,x,u);if(e.p.datatype=="local")e.p.deselectAfterSort&&a(e).resetSelection();else{e.p.selrow=null;e.p.multiselect&&a("#cb_jqg",e.grid.hDiv).attr("checked",false);e.p.selarrrow=[];e.p.savedRow=[]}e.p.scroll===true&&a("tbody tr",e.grid.bDiv).remove();e.p.subGrid&&e.p.datatype=="local"&&a("td.sgexpanded","#"+e.p.id).each(function(){a(this).trigger("click")});ia();if(e.p.sortname!=s&&x)e.p.lastsort=x}},U=function(s){var x,u={},I=j?0:e.p.cellLayout;for(x=u[0]=u[1]=u[2]=0;x<=s;x++)if(e.p.colModel[x].hidden===
false)u[0]+=e.p.colModel[x].width+I;u[0]-=e.grid.bDiv.scrollLeft;if(a(e.grid.cDiv).is(":visible"))u[1]+=a(e.grid.cDiv).height()+parseInt(a(e.grid.cDiv).css("padding-top"))+parseInt(a(e.grid.cDiv).css("padding-bottom"));if(e.p.toolbar[0]==true&&(e.p.toolbar[1]=="top"||e.p.toolbar[1]=="both"))u[1]+=a(e.grid.uDiv).height()+parseInt(a(e.grid.uDiv).css("border-top-width"))+parseInt(a(e.grid.uDiv).css("border-bottom-width"));u[2]+=a(e.grid.bDiv).height()+a(e.grid.hDiv).height();return u};this.p.id=this.id;
if(a.inArray(e.p.multikey,["shiftKey","altKey","ctrlKey"])==-1)e.p.multikey=false;e.p.keyIndex=false;for(c=0;c<e.p.colModel.length;c++)if(e.p.colModel[c].key===true){e.p.keyIndex=c;break}e.p.sortorder=e.p.sortorder.toLowerCase();if(this.p.treeGrid===true)try{a(this).setTreeGrid()}catch(R){}if(this.p.subGrid)try{a(e).setSubGrid()}catch(W){}if(this.p.multiselect){this.p.colNames.unshift("<input id='cb_jqg' class='cbox' type='checkbox'/>");this.p.colModel.unshift({name:"cb",width:j?e.p.multiselectWidth+
e.p.cellLayout:e.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center"})}if(this.p.rownumbers){this.p.colNames.unshift("");this.p.colModel.unshift({name:"rn",width:e.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center"})}e.p.xmlReader=a.extend({root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:true,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:true,
cell:"cell"}},e.p.xmlReader);e.p.jsonReader=a.extend({root:"rows",page:"page",total:"total",records:"records",repeatitems:true,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},e.p.jsonReader);if(e.p.scroll===true){e.p.pgbuttons=false;e.p.pginput=false;e.p.rowList=[]}var O="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",P,X,V,la,da,S,M,qa;X=qa="";if(e.p.shrinkToFit===true&&e.p.forceFit===true)for(c=e.p.colModel.length-1;c>=0;c--)if(!e.p.colModel[c].hidden){e.p.colModel[c].resizable=
false;break}if(e.p.viewsortcols[1]=="horizontal"){qa=" ui-i-asc";X=" ui-i-desc"}P=h?"class='ui-th-div-ie'":"";qa="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+qa+" ui-state-disabled ui-icon ui-icon-triangle-1-n'></span>";qa+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+X+" ui-state-disabled ui-icon ui-icon-triangle-1-s'></span></span>";for(c=0;c<this.p.colNames.length;c++){O+="<th role='columnheader' class='ui-state-default ui-th-column'>";
X=e.p.colModel[c].index||e.p.colModel[c].name;O+="<div id='jqgh_"+e.p.colModel[c].name+"' "+P+">"+e.p.colNames[c];if(X==e.p.sortname)e.p.lastsort=c;O+=qa+"</div></th>"}O+="</tr></thead>";a(this).append(O);a("thead tr:first th",this).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(this.p.multiselect){var Aa=true,Ba=[],ua;if(typeof e.p.onSelectAll!=="function")Aa=false;a("#cb_jqg",this).bind("click",function(){if(this.checked){a("[id^=jqg_]",
e.rows).attr("checked",true);a(e.rows).each(function(s){if(!a(this).hasClass("subgrid")){a(this).addClass("ui-state-highlight").attr("aria-selected","true");e.p.selarrrow[s]=e.p.selrow=this.id}});ua=true;Ba=[]}else{a("[id^=jqg_]",e.rows).attr("checked",false);a(e.rows).each(function(s){if(!a(this).hasClass("subgrid")){a(this).removeClass("ui-state-highlight").attr("aria-selected","false");Ba[s]=this.id}});e.p.selarrrow=[];e.p.selrow=null;ua=false}if(Aa)e.p.onSelectAll(ua?e.p.selarrrow:Ba,ua)})}a.each(e.p.colModel,
function(){if(!this.width)this.width=150});if(e.p.autowidth===true){c=a(k).innerWidth();e.p.width=c>0?c:"nw"}(function(){var s=0,x=e.p.cellLayout,u=0,I,E=e.p.scrollOffset,N,J=false,C,F=0,K=0,L=e.p.multiselectWidth,ba=e.p.subGridWidth,T=e.p.rownumWidth,ca=e.p.cellLayout;a.each(e.p.colModel,function(){if(typeof this.hidden==="undefined")this.hidden=false;if(this.hidden===false){s+=B(this.width);u++}});if(isNaN(e.p.width))e.p.width=d.width=s;else d.width=e.p.width;e.p.tblwidth=s;if(e.p.shrinkToFit===
false&&e.p.forceFit===true)e.p.forceFit=false;if(e.p.shrinkToFit===true){if(j){x=0;L+=ca;ba+=ca;T+=ca}if(e.p.multiselect){F=L;K=L+x;u--}if(e.p.subGrid){F+=ba;K+=ba+x;u--}if(e.p.rownumbers){F+=T;K+=T+x;u--}C=d.width-x*u-K;if(!isNaN(e.p.height)){C-=E;J=true}s=0;a.each(e.p.colModel,function(ka){if(this.hidden===false&&this.name!=="cb"&&this.name!=="subgrid"&&this.name!=="rn"){this.width=N=Math.floor(C/(e.p.tblwidth-F)*this.width);s+=N;I=ka}});L=0;if(J&&d.width-K-(s+x*u)!==E)L=d.width-K-(s+x*u)-E;else if(!J&&
Math.abs(d.width-K-(s+x*u))!==1)L=d.width-K-(s+x*u);e.p.colModel[I].width+=L;e.p.tblwidth=s+F+L}})();a(k).css("width",d.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+e.p.id+"'>&nbsp;</div>");a(f).css("width",d.width+"px");O=a("thead:first",e).get(0);var va="<table role='grid' style='width:"+e.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content footrow'>";a("tr:first th",O).each(function(s){var x=a("div",
this)[0];V=e.p.colModel[s].width;if(typeof e.p.colModel[s].resizable==="undefined")e.p.colModel[s].resizable=true;la=document.createElement("span");a(la).html("&#160;");if(e.p.colModel[s].resizable){a(this).addClass(e.p.resizeclass);a(la).mousedown(function(I){if(e.p.forceFit===true){var E=e.p,N=s,J;for(J=s+1;J<e.p.colModel.length;J++)if(e.p.colModel[J].hidden!==true){N=J;break}E.nv=N-s}d.dragStart(s,I,U(s));return false}).addClass("ui-jqgrid-resize")}else la="";a(this).css("width",V+"px").prepend(la);
e.p.colModel[s].hidden&&a(this).css("display","none");d.headers[s]={width:V,el:this};da=e.p.colModel[s].sortable;if(typeof da!=="boolean")da=e.p.colModel[s].sortable=true;var u=e.p.colModel[s].name;u=="cb"||u=="subgrid"||u=="rn"||(e.p.viewsortcols[2]==false?a(".ui-grid-ico-sort",this).click(function(){H(x.id,s,true,a(this).attr("sort"));return false}):a("div",this).addClass("ui-jqgrid-sortable").click(function(){H(x.id,s);return false}));if(da)if(e.p.viewsortcols[0]){a("div span.s-ico",this).show();
s==e.p.lastsort&&a("div span.ui-icon-"+e.p.sortorder,this).removeClass("ui-state-disabled")}else if(s==e.p.lastsort){a("div span.s-ico",this).show();a("div span.ui-icon-"+e.p.sortorder,this).removeClass("ui-state-disabled")}va+="<td role='gridcell' "+p(s,0)+">&nbsp;</td>"});va+="</tr></tbody></table>";this.appendChild(document.createElement("tbody"));a(this).addClass("ui-jqgrid-btable");f=a("<table class='ui-jqgrid-htable' style='width:"+e.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+
"' cellspacing='0' cellpadding='0' border='0'></table>").append(O);var ta=e.p.caption&&e.p.hiddengrid===true?true:false;c=a("<div class='ui-jqgrid-hbox'></div>");d.hDiv=document.createElement("div");a(d.hDiv).css({width:d.width+"px"}).addClass("ui-state-default ui-jqgrid-hdiv").append(c);a(c).append(f);ta&&a(d.hDiv).hide();e.p._height=0;if(e.p.pager){if(typeof e.p.pager=="string")if(e.p.pager.substr(0,1)!="#")e.p.pager="#"+e.p.pager;a(e.p.pager).css({width:d.width+"px"}).appendTo(k).addClass("ui-state-default ui-jqgrid-pager");
e.p._height+=parseInt(a(e.p.pager).height(),10);ta&&a(e.p.pager).hide();A()}e.p.cellEdit===false&&e.p.hoverrows===true&&a(e).bind("mouseover",function(s){M=a(s.target).parents("tr.jqgrow");a(M).attr("class")!=="subgrid"&&a(M).addClass("ui-state-hover");return false}).bind("mouseout",function(s){M=a(s.target).parents("tr.jqgrow");a(M).removeClass("ui-state-hover");return false});var ja,ma;a(e).before(d.hDiv).click(function(s){S=s.target;var x=a(S).hasClass("cbox");M=a(S,e.rows).parents("tr.jqgrow");
if(a(M).length===0)return this;var u=true;if(l)u=l(M[0].id,s);if(S.tagName=="A"||(S.tagName=="INPUT"||S.tagName=="TEXTAREA"||S.tagName=="OPTION"||S.tagName=="SELECT")&&!x)return true;if(u===true){if(e.p.cellEdit===true)if(e.p.multiselect&&x)a(e).setSelection(M[0].id,true);else{ja=M[0].rowIndex;ma=!a(S).is("td")?a(S).parents("td:first")[0].cellIndex:S.cellIndex;if(h)ma=a.jgrid.getAbsoluteIndex(M[0],ma);try{a(e).editCell(ja,ma,true)}catch(I){}}else if(e.p.multikey)if(s[e.p.multikey])a(e).setSelection(M[0].id,
true);else{if(e.p.multiselect&&x){x=a("[id^=jqg_]",M).attr("checked");a("[id^=jqg_]",M).attr("checked",!x)}}else{if(e.p.multiselect&&e.p.multiboxonly)if(!x){a(e.p.selarrrow).each(function(E,N){var J=e.rows.namedItem(N);a(J).removeClass("ui-state-highlight");a("#jqg_"+N.replace(".","\\."),J).attr("checked",false)});e.p.selarrrow=[];a("#cb_jqg",e.grid.hDiv).attr("checked",false)}a(e).setSelection(M[0].id,true)}if(z){ja=M[0].id;ma=!a(S).is("td")?a(S).parents("td:first")[0].cellIndex:S.cellIndex;if(h)ma=
a.jgrid.getAbsoluteIndex(M[0],ma);z(ja,ma,a(S).html(),S)}}s.stopPropagation()}).bind("reloadGrid",function(){if(e.p.treeGrid===true)e.p.datatype=e.p.treedatatype;if(e.p.datatype=="local")a(e).resetSelection();else if(!e.p.treeGrid){e.p.selrow=null;if(e.p.multiselect){e.p.selarrrow=[];a("#cb_jqg",e.grid.hDiv).attr("checked",false)}if(e.p.cellEdit)e.p.savedRow=[]}e.p.scroll===true&&a("tbody tr",e.grid.bDiv).remove();e.grid.populate();return false});g&&a(this).dblclick(function(s){S=s.target;M=a(S,e.rows).parents("tr.jqgrow");
if(a(M).length===0)return false;ja=M[0].rowIndex;ma=!a(S).is("td")?a(S).parents("td:first")[0].cellIndex:S.cellIndex;if(h)ma=a.jgrid.getAbsoluteIndex(M[0],ma);e.p.ondblClickRow(a(M).attr("id"),ja,ma);return false});r&&a(this).bind("contextmenu",function(s){S=s.target;M=a(S,e.rows).parents("tr.jqgrow");if(a(M).length===0)return false;e.p.multiselect||a(e).setSelection(M[0].id,true);ja=M[0].rowIndex;ma=!a(S).is("td")?a(S).parents("td:first")[0].cellIndex:S.cellIndex;if(h)ma=a.jgrid.getAbsoluteIndex(M[0],
ma);e.p.onRightClickRow(a(M).attr("id"),ja,ma);return false});d.bDiv=document.createElement("div");a(d.bDiv).append(this).addClass("ui-jqgrid-bdiv").css({height:e.p.height+(isNaN(e.p.height)?"":"px"),width:d.width+"px"}).scroll(function(){d.scrollGrid()});a("table:first",d.bDiv).css({width:e.p.tblwidth+"px"});if(h){a("tbody",this).size()==2&&a("tbody:first",this).remove();e.p.multikey&&a(d.bDiv).bind("selectstart",function(){return false})}else e.p.multikey&&a(d.bDiv).bind("mousedown",function(){return false});
ta&&a(d.bDiv).hide();d.cDiv=document.createElement("div");var Fa=e.p.hidegrid===true?a("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){Fa.addClass("ui-state-hover")},function(){Fa.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-circle-triangle-n'></span>"):"";a(d.cDiv).append(Fa).append("<span class='ui-jqgrid-title'>"+e.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix");
a(d.cDiv).insertBefore(d.hDiv);if(e.p.toolbar[0]){d.uDiv=document.createElement("div");if(e.p.toolbar[1]=="top")a(d.uDiv).insertBefore(d.hDiv);else e.p.toolbar[1]=="bottom"&&a(d.uDiv).insertAfter(d.hDiv);if(e.p.toolbar[1]=="both"){d.ubDiv=document.createElement("div");a(d.uDiv).insertBefore(d.hDiv).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);a(d.ubDiv).insertAfter(d.hDiv).addClass("ui-userdata ui-state-default").attr("id","tb_"+this.id);e.p._height+=B(a(d.ubDiv).height());ta&&
a(d.ubDiv).hide()}else a(d.uDiv).width(d.width).addClass("ui-userdata ui-state-default").attr("id","t_"+this.id);e.p._height+=B(a(d.uDiv).height());ta&&a(d.uDiv).hide()}if(e.p.footerrow){d.sDiv=document.createElement("div");c=a("<div class='ui-jqgrid-hbox'></div>");a(d.sDiv).addClass("ui-jqgrid-sdiv").append(c).insertAfter(d.hDiv).width(d.width);a(c).append(va);d.footers=a(".ui-jqgrid-ftable",d.sDiv)[0].rows[0].cells;if(e.p.rownumbers)d.footers[0].className="ui-state-default jqgrid-rownum";ta&&a(d.sDiv).hide()}if(e.p.caption){e.p._height+=
parseInt(a(d.cDiv,e).height(),10);var Ha=e.p.datatype;if(e.p.hidegrid===true){a(".ui-jqgrid-titlebar-close",d.cDiv).click(function(){if(e.p.gridstate=="visible"){a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+e.p.id).slideUp("fast");e.p.pager&&a(e.p.pager).slideUp("fast");if(e.p.toolbar[0]===true){e.p.toolbar[1]=="both"&&a(d.ubDiv).slideUp("fast");a(d.uDiv).slideUp("fast")}e.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+e.p.id).slideUp("fast");a("span",this).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");
e.p.gridstate="hidden";if(v)ta||e.p.onHeaderClick(e.p.gridstate)}else if(e.p.gridstate=="hidden"){a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+e.p.id).slideDown("fast");e.p.pager&&a(e.p.pager).slideDown("fast");if(e.p.toolbar[0]===true){e.p.toolbar[1]=="both"&&a(d.ubDiv).slideDown("fast");a(d.uDiv).slideDown("fast")}e.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+e.p.id).slideDown("fast");a("span",this).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(ta){e.p.datatype=
Ha;ia();ta=false}e.p.gridstate="visible";v&&e.p.onHeaderClick(e.p.gridstate)}return false});if(ta){e.p.datatype="local";a(".ui-jqgrid-titlebar-close",d.cDiv).trigger("click")}}}else a(d.cDiv).hide();a(d.hDiv).after(d.bDiv);a(".ui-jqgrid-labels",d.hDiv).bind("selectstart",function(){return false}).mousemove(function(s){d.resizing&&d.dragMove(s);return false});e.p._height+=parseInt(a(d.hDiv).height(),10);a(document).mouseup(function(){if(d.resizing){d.dragEnd();return false}return true});this.updateColumns=
function(){var s=this.rows[0],x=this;if(s){a("td",s).each(function(u){a(this).css("width",x.grid.headers[u].width+"px")});this.grid.cols=s.cells}return this};e.formatCol=function(s,x){return p(s,x)};e.sortData=function(s,x,u){H(s,x,u)};e.updatepager=function(s){ha(s)};e.formatter=function(s,x,u,I,E){return G(s,x,u,I,E)};a.extend(d,{populate:function(){ia()}});this.grid=d;e.addXmlData=function(s){Z(s,e.grid.bDiv)};e.addJSONData=function(s){fa(s,e.grid.bDiv)};ia();e.p.hiddengrid=false;a(window).unload(function(){a(this).empty();
this.p=this.grid=null})}}})};a.fn.extend({getGridParam:function(b){var d=this[0];if(d.grid)return b?d.p[b]?d.p[b]:null:d.p},setGridParam:function(b){return this.each(function(){this.grid&&typeof b==="object"&&a.extend(true,this.p,b)})},getDataIDs:function(){var b=[],d=0,c;this.each(function(){if((c=this.rows.length)&&c>0)for(;d<c;){b[d]=this.rows[d].id;d++}});return b},setSelection:function(b,d){return this.each(function(){function c(k,e){var l=a(f.grid.bDiv)[0].clientHeight,o=a(f.grid.bDiv)[0].scrollTop,
m=f.rows[k].offsetTop+f.rows[k].clientHeight,n=f.rows[k].offsetTop;if(e=="d")if(m>=l)a(f.grid.bDiv)[0].scrollTop=o+m-n;if(e=="u")if(n<o)a(f.grid.bDiv)[0].scrollTop=o-m+n}var f=this,g,h,j;if(b!==undefined){d=d===false?false:true;g=f.rows.namedItem(b);if(g!=null){if(f.p.selrow&&f.p.scrollrows===true){h=f.rows.namedItem(f.p.selrow).rowIndex;j=f.rows.namedItem(b).rowIndex;if(j>=0)j>h?c(j,"d"):c(j,"u")}if(f.p.multiselect){f.p.selrow=b;h=a.inArray(f.p.selrow,f.p.selarrrow);if(h===-1){a(g).attr("class")!==
"subgrid"&&a(g).addClass("ui-state-highlight").attr("aria-selected","true");g=true;a("#jqg_"+f.p.selrow.replace(".","\\."),f.rows).attr("checked",g);f.p.selarrrow.push(f.p.selrow);f.p.onSelectRow&&d&&f.p.onSelectRow(f.p.selrow,g)}else{a(g).attr("class")!=="subgrid"&&a(g).removeClass("ui-state-highlight").attr("aria-selected","false");g=false;a("#jqg_"+f.p.selrow.replace(".","\\."),f.rows).attr("checked",g);f.p.selarrrow.splice(h,1);f.p.onSelectRow&&d&&f.p.onSelectRow(f.p.selrow,g);g=f.p.selarrrow[0];
f.p.selrow=g===undefined?null:g}}else if(a(g).attr("class")!=="subgrid"){f.p.selrow&&a("tr#"+f.p.selrow.replace(".","\\."),f.grid.bDiv).removeClass("ui-state-highlight").attr("aria-selected","false");f.p.selrow=b;a(g).addClass("ui-state-highlight").attr("aria-selected","true");f.p.onSelectRow&&d&&f.p.onSelectRow(f.p.selrow,true)}}}})},resetSelection:function(){return this.each(function(){var b=this,d;if(b.p.multiselect){a(b.p.selarrrow).each(function(c,f){d=b.rows.namedItem(f);a(d).removeClass("ui-state-highlight").attr("aria-selected",
"false");a("#jqg_"+f.replace(".","\\."),d).attr("checked",false)});a("#cb_jqg",b.grid.hDiv).attr("checked",false);b.p.selarrrow=[]}else if(b.p.selrow){a("tr#"+b.p.selrow.replace(".","\\."),b.grid.bDiv).removeClass("ui-state-highlight").attr("aria-selected","false");b.p.selrow=null}b.p.savedRow=[]})},getRowData:function(b){var d={};this.each(function(){var c=this,f,g;g=c.rows.namedItem(b);if(!g)return d;a("td",g).each(function(h){f=c.p.colModel[h].name;if(f!=="cb"&&f!=="subgrid")if(c.p.treeGrid===
true&&f==c.p.ExpandColumn)d[f]=a.jgrid.htmlDecode(a("span:first",this).html());else try{d[f]=a.unformat(this,{colModel:c.p.colModel[h]},h)}catch(j){d[f]=a.jgrid.htmlDecode(a(this).html())}})});return d},delRowData:function(b){var d=false,c,f,g;this.each(function(){if(c=this.rows.namedItem(b)){g=c.rowIndex;a(c).remove();this.p.records--;this.p.reccount--;this.updatepager(true);d=true;if(b==this.p.selrow)this.p.selrow=null;f=a.inArray(b,this.p.selarrrow);f!=-1&&this.p.selarrrow.splice(f,1)}else return false;
g==0&&d&&this.updateColumns();if(this.p.altRows===true&&d){var h=this.p.altclass;a(this.rows).each(function(j){j%2==1?a(this).addClass(h):a(this).removeClass(h)})}});return d},setRowData:function(b,d){var c,f=false;this.each(function(){var g=this,h,j;if(!g.grid)return false;j=g.rows.namedItem(b);if(!j)return false;d&&a(this.p.colModel).each(function(k){c=this.name;if(d[c]!=undefined){h=g.formatter(b,d[c],k,d,"edit");g.p.treeGrid===true&&c==g.p.ExpandColumn?a("td:eq("+k+") > span:first",j).html(h).attr("title",
a.jgrid.stripHtml(h)):a("td:eq("+k+")",j).html(h);f=true}})});return f},addRowData:function(b,d,c,f){c||(c="last");var g=false,h,j,k=0,e=0,l=0,o,m,n,q="";d&&this.each(function(){b=typeof b!="undefined"?b+"":this.p.records+1;j='<tr id="'+b+'" role="row" class="ui-widget-content jqgrow">';if(this.p.rownumbers===true){q=this.formatCol(l,1);j+='<td role="gridcell" class="ui-state-default jqgrid-rownum" '+q+">0</td>";l=1}if(this.p.multiselect){n='<input type="checkbox" id="jqg_'+b+'" class="cbox"/>';q=
this.formatCol(l,1);j+='<td role="gridcell" '+q+">"+n+"</td>";k=1}if(this.p.subGrid===true){j+=a(this).addSubGridCell(k+l,1);e=1}for(m=k+e+l;m<this.p.colModel.length;m++){h=this.p.colModel[m].name;n=this.formatter(b,d[h],m,d,"add");q=this.formatCol(m,1);j+='<td role="gridcell" '+q+' title="'+a.jgrid.stripHtml(n)+'">'+n+"</td>"}j+="</tr>";if(this.p.subGrid===true){j=a(j)[0];a(this).addSubGrid(j,k+l)}if(this.rows.length===0)a("table:first",this.grid.bDiv).append(j);else switch(c){case "last":a(this.rows[this.rows.length-
1]).after(j);break;case "first":a(this.rows[0]).before(j);break;case "after":o=this.rows.namedItem(f);o!=null&&(a(this.rows[o.rowIndex+1]).hasClass("ui-subgrid")?a(this.rows[o.rowIndex+1]).after(j):a(o).after(j));break;case "before":o=this.rows.namedItem(f);if(o!=null){a(o).before(j);o=o.rowIndex}break}this.p.records++;this.p.reccount++;if(c==="first"||c==="before"&&o==0||this.rows.length===1)this.updateColumns();if(this.p.altRows===true){var r=this.p.altclass;if(c=="last")this.rows.length%2==1&&
a(this.rows[this.rows.length-1]).addClass(r);else a(this.rows).each(function(v){v%2==1?a(this).addClass(r):a(this).removeClass(r)})}try{this.p.afterInsertRow(b,d)}catch(t){}this.updatepager(true);g=true});return g},footerData:function(b,d,c){function f(k){for(var e in k)return false;return true}var g,h=false,j={};if(typeof b=="undefined")b="get";if(typeof c!="boolean")c=true;b=b.toLowerCase();this.each(function(){var k=this,e;if(!k.grid||!k.p.footerrow)return false;if(b=="set")if(f(d))return false;
h=true;a(this.p.colModel).each(function(l){g=this.name;if(b=="set"){if(d[g]!=undefined){e=c?k.formatter("",d[g],l,d,"edit"):d[g];a("tr.footrow td:eq("+l+")",k.grid.sDiv).html(e).attr("title",a.jgrid.stripHtml(e));h=true}}else if(b=="get")j[g]=a("tr.footrow td:eq("+l+")",k.grid.sDiv).html()})});return b=="get"?j:h},ShowHideCol:function(b,d){return this.each(function(){var c=this,f=false;if(c.grid){if(typeof b==="string")b=[b];d=d!="none"?"":"none";var g=d==""?true:false;a(this.p.colModel).each(function(h){if(a.inArray(this.name,
b)!==-1&&this.hidden===g){a("tr",c.grid.hDiv).each(function(){a("th:eq("+h+")",this).css("display",d)});a(c.rows).each(function(j){a("td:eq("+h+")",c.rows[j]).css("display",d)});c.p.footerrow&&a("td:eq("+h+")",c.grid.sDiv).css("display",d);if(d=="none")c.p.tblwidth-=this.width;else c.p.tblwidth+=this.width;this.hidden=!g;f=true}});if(f===true){a("table:first",c.grid.hDiv).width(c.p.tblwidth);a("table:first",c.grid.bDiv).width(c.p.tblwidth);c.grid.hDiv.scrollLeft=c.grid.bDiv.scrollLeft;if(c.p.footerrow){a("table:first",
c.grid.sDiv).width(c.p.tblwidth);c.grid.sDiv.scrollLeft=c.grid.bDiv.scrollLeft}}}})},hideCol:function(b){return this.each(function(){a(this).ShowHideCol(b,"none")})},showCol:function(b){return this.each(function(){a(this).ShowHideCol(b,"")})},setGridWidth:function(b,d){return this.each(function(){var c=this,f,g=0,h=c.p.cellLayout,j,k=0,e,l=false,o=c.p.scrollOffset,m,n=0,q=0,r=c.p.multiselectWidth,t=c.p.subGridWidth,v=c.p.rownumWidth,w=c.p.cellLayout;if(c.grid){if(typeof d!="boolean")d=c.p.shrinkToFit;
if(!isNaN(b))if(b!=c.grid.width){c.grid.width=c.p.width=b;a("#gbox_"+c.p.id).css("width",b+"px");a("#gview_"+c.p.id).css("width",b+"px");a(c.grid.bDiv).css("width",b+"px");a(c.grid.hDiv).css("width",b+"px");c.p.pager&&a(c.p.pager).css("width",b+"px");if(c.p.toolbar[0]===true){a(c.grid.uDiv).css("width",b+"px");c.p.toolbar[1]=="both"&&a(c.grid.ubDiv).css("width",b+"px")}c.p.footerrow&&a(c.grid.sDiv).css("width",b+"px");if(d===false&&c.p.forceFit==true)c.p.forceFit=false;if(d===true){a.each(c.p.colModel,
function(){if(this.hidden===false){g+=parseInt(this.width,10);k++}});if(e=a.browser.safari&&!window.chrome?true:false){h=0;r+=w;t+=w;v+=w}if(c.p.multiselect){q=r;n=r+h;k--}if(c.p.subGrid){q+=t;n+=t+h;k--}if(c.p.rownumbers){q+=v;n+=v+h;k--}c.p.tblwidth=g;m=b-h*k-n;if(!isNaN(c.p.height))if(a(c.grid.bDiv)[0].clientHeight<a(c.grid.bDiv)[0].scrollHeight){l=true;m-=o}g=0;var z=c.grid.cols.length>0;a.each(c.p.colModel,function(B){var p=this.name;if(this.hidden===false&&p!=="cb"&&p!=="subgrid"&&p!=="rn"){this.width=
f=Math.floor(m/(c.p.tblwidth-q)*this.width);g+=f;c.grid.headers[B].width=f;c.grid.headers[B].el.style.width=f+"px";if(c.p.footerrow)c.grid.footers[B].style.width=f+"px";if(z)c.grid.cols[B].style.width=f+"px";j=B}});e=0;if(l&&b-n-(g+h*k)!==o)e=b-n-(g+h*k)-o;else if(Math.abs(b-n-(g+h*k))!==1)e=b-n-(g+h*k);c.p.colModel[j].width+=e;f=c.p.colModel[j].width;c.grid.headers[j].width=f;c.grid.headers[j].el.style.width=f+"px";if(w>0)c.grid.cols[j].style.width=f+"px";c.p.tblwidth=g+q+e;a("table:first",c.grid.bDiv).css("width",
g+q+e+"px");a("table:first",c.grid.hDiv).css("width",g+q+e+"px");c.grid.hDiv.scrollLeft=c.grid.bDiv.scrollLeft;if(c.p.footerrow){c.grid.footers[j].style.width=f+"px";a("table:first",c.grid.sDiv).css("width",g+q+e+"px")}}}}})},setGridHeight:function(b){return this.each(function(){if(this.grid){a(this.grid.bDiv).css({height:b+(isNaN(b)?"":"px")});this.p.height=b}})},setCaption:function(b){return this.each(function(){this.p.caption=b;a("span.ui-jqgrid-title",this.grid.cDiv).html(b);a(this.grid.cDiv).show()})},
setLabel:function(b,d,c,f){return this.each(function(){var g=-1;if(this.grid){if(isNaN(b))a(this.p.colModel).each(function(j){if(this.name==b){g=j;return false}});else g=parseInt(b,10);if(g>=0){var h=a("tr.ui-jqgrid-labels th:eq("+g+")",this.grid.hDiv);if(d){a("div",h).html(d);this.p.colNames[g]=d}if(c)typeof c==="string"?a(h).addClass(c):a(h).css(c);typeof f==="object"&&a(h).attr(f)}}})},setCell:function(b,d,c,f,g){return this.each(function(){var h=-1,j;if(this.grid){if(isNaN(d))a(this.p.colModel).each(function(e){if(this.name==
d){h=e;return false}});else h=parseInt(d,10);if(h>=0)if(j=this.rows.namedItem(b)){var k=a("td:eq("+h+")",j);if(c!==""){j=this.formatter(b,c,h,j,"edit");a(k).html(j).attr("title",a.jgrid.stripHtml(j))}if(f)typeof f==="string"?a(k).addClass(f):a(k).css(f);typeof g==="object"&&a(k).attr(g)}}})},getCell:function(b,d){var c=false;this.each(function(){var f=-1;if(this.grid){if(isNaN(d))a(this.p.colModel).each(function(j){if(this.name===d){f=j;return false}});else f=parseInt(d,10);if(f>=0){var g=this.rows.namedItem(b);
if(g)try{c=a.unformat(a("td:eq("+f+")",g),{colModel:this.p.colModel[f]},f)}catch(h){c=a.jgrid.htmlDecode(a("td:eq("+f+")",g).html())}}}});return c},getCol:function(b,d){var c=[],f;d=d==false?false:true;this.each(function(){var g=-1;if(this.grid){if(isNaN(b))a(this.p.colModel).each(function(k){if(this.name===b){g=k;return false}});else g=parseInt(b,10);if(g>=0){var h=this.rows.length,j=0;if(h&&h>0)for(;j<h;){f=this.rows[j].cells[g].innerHTML;d?c.push({id:this.rows[j].id,value:f}):c[j]=f;j++}}}});return c},
clearGridData:function(b){return this.each(function(){if(this.grid){if(typeof b!="boolean")b=false;a("tbody:first tr",this.grid.bDiv).remove();this.p.footerrow&&b&&a(".ui-jqgrid-ftable td",this.grid.sDiv).html("&nbsp;");this.p.selrow=null;this.p.selarrrow=[];this.p.savedRow=[];this.p.records=0;this.p.page="0";this.p.lastpage="0";this.p.reccount=0;this.updatepager(true)}})},getInd:function(b,d){var c=false,f;this.each(function(){if(f=this.rows.namedItem(b))c=d===true?f:f.rowIndex});return c}})})(jQuery);
var showModal=function(a){a.w.show()},closeModal=function(a){a.w.hide().attr("aria-hidden","true");a.o&&a.o.remove()},createModal=function(a,b,d,c,f,g){var h=document.createElement("div");h.className="ui-widget ui-widget-content ui-corner-all ui-jqdialog";h.id=a.themodal;var j=document.createElement("div");j.className="ui-jqdialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix";j.id=a.modalhead;jQuery(j).append("<span class='ui-jqdialog-title'>"+d.caption+"</span>");var k=jQuery("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all'></a>").hover(function(){k.addClass("ui-state-hover")},
function(){k.removeClass("ui-state-hover")}).append("<span class='ui-icon ui-icon-closethick'></span>");jQuery(j).append(k);var e=document.createElement("div");jQuery(e).addClass("ui-jqdialog-content ui-widget-content").attr("id",a.modalcontent);jQuery(e).append(b);h.appendChild(e);jQuery(h).prepend(j);g===true?jQuery("body").append(h):jQuery(h).insertBefore(c);if(typeof d.jqModal==="undefined")d.jqModal=true;if(jQuery.fn.jqm&&d.jqModal===true)if(d.left==0&&d.top==0){b=[];b=findPos(f);d.left=b[0]+
4;d.top=b[1]+4}jQuery("a.ui-jqdialog-titlebar-close",j).click(function(){var m=jQuery("#"+a.themodal).data("onClose")||d.onClose,n=jQuery("#"+a.themodal).data("gbox")||d.gbox;hideModal("#"+a.themodal,{gb:n,jqm:d.jqModal,onClose:m});return false});if(d.width==0||!d.width)d.width=300;if(d.height==0||!d.height)d.height=200;if(!d.zIndex)d.zIndex=950;jQuery(h).css({top:d.top+"px",left:d.left+"px",width:isNaN(d.width)?"auto":d.width+"px",height:isNaN(d.height)?"auto":d.height+"px",zIndex:d.zIndex,overflow:"hidden"}).attr({tabIndex:"-1",
role:"dialog","aria-labelledby":a.modalhead,"aria-hidden":"true"});if(typeof d.drag=="undefined")d.drag=true;if(typeof d.resize=="undefined")d.resize=true;if(d.drag){jQuery(j).css("cursor","move");if(jQuery.fn.jqDrag)jQuery(h).jqDrag(j);else try{jQuery(h).draggable({handle:jQuery("#"+j.id)})}catch(l){}}if(d.resize)if(jQuery.fn.jqResize){jQuery(h).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>");jQuery("#"+a.themodal).jqResize(".jqResize",
a.scrollelm?"#"+a.scrollelm:false)}else try{jQuery(h).resizable({handles:"se",alsoResize:a.scrollelm?"#"+a.scrollelm:false})}catch(o){}d.closeOnEscape===true&&jQuery(h).keydown(function(m){if(m.which==27){m=jQuery("#"+a.themodal).data("onClose")||d.onClose;hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:m})}})},viewModal=function(a,b){b=jQuery.extend({toTop:true,overlay:10,modal:false,onShow:showModal,onHide:closeModal,gbox:"",jqm:true,jqM:true},b||{});if(jQuery.fn.jqm&&b.jqm==true)b.jqM?jQuery(a).attr("aria-hidden",
"false").jqm(b).jqmShow():jQuery(a).attr("aria-hidden","false").jqmShow();else{if(b.gbox!=""){jQuery(".jqgrid-overlay:first",b.gbox).show();jQuery(a).data("gbox",b.gbox)}jQuery(a).show().attr("aria-hidden","false");try{jQuery(":input:visible",a)[0].focus()}catch(d){}}},hideModal=function(a,b){b=jQuery.extend({jqm:true,gb:""},b||{});if(b.onClose){var d=b.onClose(a);if(typeof d=="boolean"&&!d)return}if(jQuery.fn.jqm&&b.jqm===true)jQuery(a).attr("aria-hidden","true").jqmHide();else{if(b.gb!="")try{jQuery(".jqgrid-overlay:first",
b.gb).hide()}catch(c){}jQuery(a).hide().attr("aria-hidden","true")}};
function info_dialog(a,b,d,c){a={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+a+"</b>",left:250,top:170,jqModal:true,closeOnEscape:true,align:"center",buttonalign:"center"};jQuery.extend(a,c||{});var f=a.jqModal;if(jQuery.fn.jqm&&!f)f=false;c=isNaN(a.dataheight)?a.dataheight:a.dataheight+"px";var g="<div id='info_id'>";g+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+c+";"+("text-align:"+a.align+";")+"'>"+
b+"</div>";g+=d?"<div class='ui-widget-content ui-helper-clearfix' style='text-align:"+a.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default ui-corner-all'>"+d+"</a></div>":"";g+="</div>";try{jQuery("#info_dialog").remove()}catch(h){}createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},g,a,"","",true);jQuery("#closedialog",
"#info_id").click(function(){hideModal("#info_dialog",{jqm:f});return false});jQuery(".fm-button","#info_dialog").hover(function(){jQuery(this).addClass("ui-state-hover")},function(){jQuery(this).removeClass("ui-state-hover")});viewModal("#info_dialog",{onHide:function(j){j.w.hide().remove();j.o&&j.o.remove()},modal:true,jqm:f})}function findPos(a){var b=curtop=0;if(a.offsetParent){do{b+=a.offsetLeft;curtop+=a.offsetTop}while(a=a.offsetParent)}return[b,curtop]}
function isArray(a){return a.constructor.toString().indexOf("Array")==-1?false:true}
function createEl(a,b,d,c){function f(m,n){if(jQuery.isFunction(n.dataInit)){m.id=n.id;n.dataInit(m);delete n.id;delete n.dataInit}if(n.dataEvents){jQuery.each(n.dataEvents,function(){this.data!=null?jQuery(m).bind(this.type,this.data,this.fn):jQuery(m).bind(this.type,this.fn)});delete n.dataEvents}return n}var g="";b.defaultValue&&delete b.defaultValue;switch(a){case "textarea":g=document.createElement("textarea");if(c)b.cols||jQuery(g).css({width:"98%"});else if(!b.cols)b.cols=20;if(!b.rows)b.rows=
2;if(d=="&nbsp;"||d=="&#160;"||d.length==1&&d.charCodeAt(0)==160)d="";g.value=d;b=f(g,b);jQuery(g).attr(b);break;case "checkbox":g=document.createElement("input");g.type="checkbox";if(b.value){a=b.value.split(":");if(d===a[0]){g.checked=true;g.defaultChecked=true}g.value=a[0];jQuery(g).attr("offval",a[1]);try{delete b.value}catch(h){}}else{a=d.toLowerCase();if(a.search(/(false|0|no|off|undefined)/i)<0&&a!==""){g.checked=true;g.defaultChecked=true;g.value=d}else g.value="on";jQuery(g).attr("offval",
"off")}b=f(g,b);jQuery(g).attr(b);break;case "select":g=document.createElement("select");var j=b.multiple===true?true:false;if(b.dataUrl!=null)jQuery.get(b.dataUrl,{_nsd:(new Date).getTime()},function(m){try{delete b.dataUrl;delete b.value}catch(n){}m=jQuery(m).html();jQuery(g).append(m);b=f(g,b);if(typeof b.size==="undefined")b.size=j?3:1;jQuery(g).attr(b);setTimeout(function(){jQuery("option",g).each(function(){if(jQuery(this).text()==d||jQuery(this).html()==d){this.selected="selected";return false}})},
0)},"html");else if(b.value){a=[];if(j){a=d.split(",");a=jQuery.map(a,function(m){return jQuery.trim(m)});if(typeof b.size==="undefined")b.size=3}else b.size=1;if(typeof b.value==="function")b.value=b.value();if(typeof b.value==="string"){var k=b.value.split(";"),e,l;for(c=0;c<k.length;c++){e=k[c].split(":");l=document.createElement("option");l.value=e[0];l.innerHTML=e[1];if(!j&&(e[0]==d||e[1]==d))l.selected="selected";if(j&&(jQuery.inArray(e[1],a)>-1||jQuery.inArray(e[0],a)>-1))l.selected="selected";
g.appendChild(l)}}else if(typeof b.value==="object"){e=b.value;c=0;for(k in e){c++;l=document.createElement("option");l.value=k;l.innerHTML=e[k];if(!j&&(k==d||e[k]==d))l.selected="selected";if(j&&(jQuery.inArray(e[k],a)>-1||jQuery.inArray(k,a)>-1))l.selected="selected";g.appendChild(l)}}b=f(g,b);try{delete b.value}catch(o){}jQuery(g).attr(b)}break;case "text":case "password":case "button":g=document.createElement("input");g.type=a;g.value=jQuery.jgrid.htmlDecode(d);b=f(g,b);if(a!="button")if(c)b.size||
jQuery(g).css({width:"98%"});else if(!b.size)b.size=20;jQuery(g).attr(b);break;case "image":case "file":g=document.createElement("input");g.type=a;b=f(g,b);jQuery(g).attr(b);break}return g}
function checkValues(a,b,d){var c,f,g;if(typeof b=="string"){f=0;for(len=d.p.colModel.length;f<len;f++)if(d.p.colModel[f].name==b){c=d.p.colModel[f].editrules;b=f;try{g=d.p.colModel[f].formoptions.label}catch(h){}break}}else if(b>=0)c=d.p.colModel[b].editrules;if(c){g||(g=d.p.colNames[b]);if(c.required===true)if(a.match(/^s+$/)||a=="")return[false,g+": "+jQuery.jgrid.edit.msg.required,""];f=c.required===false?false:true;if(c.number===true)if(!(f===false&&isEmpty(a)))if(isNaN(a))return[false,g+": "+
jQuery.jgrid.edit.msg.number,""];if(typeof c.minValue!="undefined"&&!isNaN(c.minValue))if(parseFloat(a)<parseFloat(c.minValue))return[false,g+": "+jQuery.jgrid.edit.msg.minValue+" "+c.minValue,""];if(typeof c.maxValue!="undefined"&&!isNaN(c.maxValue))if(parseFloat(a)>parseFloat(c.maxValue))return[false,g+": "+jQuery.jgrid.edit.msg.maxValue+" "+c.maxValue,""];var j;if(c.email===true)if(!(f===false&&isEmpty(a))){j=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;
if(!j.test(a))return[false,g+": "+jQuery.jgrid.edit.msg.email,""]}if(c.integer===true)if(!(f===false&&isEmpty(a))){if(isNaN(a))return[false,g+": "+jQuery.jgrid.edit.msg.integer,""];if(a%1!=0||a.indexOf(".")!=-1)return[false,g+": "+jQuery.jgrid.edit.msg.integer,""]}if(c.date===true)if(!(f===false&&isEmpty(a))){b=d.p.colModel[b].datefmt||"Y-m-d";if(!checkDate(b,a))return[false,g+": "+jQuery.jgrid.edit.msg.date+" - "+b,""]}if(c.time===true)if(!(f===false&&isEmpty(a)))if(!checkTime(a))return[false,g+
": "+jQuery.jgrid.edit.msg.date+" - hh:mm (am/pm)",""];if(c.url===true)if(!(f===false&&isEmpty(a))){j=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!j.test(a))return[false,g+": "+jQuery.jgrid.edit.msg.url,""]}}return[true,"",""]}
function checkDate(a,b){var d={},c;a=a.toLowerCase();c=a.indexOf("/")!=-1?"/":a.indexOf("-")!=-1?"-":a.indexOf(".")!=-1?".":"/";a=a.split(c);b=b.split(c);if(b.length!=3)return false;c=-1;for(var f,g=-1,h=-1,j=0;j<a.length;j++){f=isNaN(b[j])?0:parseInt(b[j],10);d[a[j]]=f;f=a[j];if(f.indexOf("y")!=-1)c=j;if(f.indexOf("m")!=-1)h=j;if(f.indexOf("d")!=-1)g=j}f=a[c]=="y"||a[c]=="yyyy"?4:a[c]=="yy"?2:-1;j=DaysArray(12);var k;if(c===-1)return false;else{k=d[a[c]].toString();if(f==2&&k.length==1)f=1;if(k.length!=
f||d[a[c]]==0)return false}if(h===-1)return false;else{k=d[a[h]].toString();if(k.length<1||d[a[h]]<1||d[a[h]]>12)return false}if(g===-1)return false;else{k=d[a[g]].toString();if(k.length<1||d[a[g]]<1||d[a[g]]>31||d[a[h]]==2&&d[a[g]]>daysInFebruary(d[a[c]])||d[a[g]]>j[d[a[h]]])return false}return true}function daysInFebruary(a){return a%4==0&&(a%100!=0||a%400==0)?29:28}function DaysArray(a){for(var b=1;b<=a;b++){this[b]=31;if(b==4||b==6||b==9||b==11)this[b]=30;if(b==2)this[b]=29}return this}
function isEmpty(a){return a.match(/^s+$/)||a==""?true:false}function checkTime(a){var b=/^(\d{1,2}):(\d{2})([ap]m)?$/;if(!isEmpty(a))if(a=a.match(b)){if(a[3]){if(a[1]<1||a[1]>12)return false}else if(a[1]>23)return false;if(a[2]>59)return false}else return false;return true}
(function(a){var b=null;a.fn.extend({searchGrid:function(d){d=a.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:false,closeOnEscape:false,multipleSearch:false,sopt:null,onClose:null},a.jgrid.search,d||{});return this.each(function(){function c(v){var w=v!==undefined,z=jQuery("#"+j.p.id),B={};if(d.multipleSearch===false){B[d.sField]=v.rules[0].field;
B[d.sValue]=v.rules[0].data;B[d.sOper]=v.rules[0].op}else B[d.sFilter]=v;z[0].p.search=w;a.extend(z[0].p.postData,B);z[0].p.page=1;z.trigger("reloadGrid");d.closeAfterSearch&&g(a("#"+k))}function f(v){v=v!==undefined;var w=jQuery("#"+j.p.id),z=[];w[0].p.search=v;if(d.multipleSearch===false)z[d.sField]=z[d.sValue]=z[d.sOper]="";else z[d.sFilter]="";a.extend(w[0].p.postData,z);w[0].p.page=1;w.trigger("reloadGrid")}function g(v){if(d.onClose){var w=d.onClose(v);if(typeof w=="boolean"&&!w)return}v.hide();
a(".jqgrid-overlay","#gbox_"+j.p.id).hide()}function h(){a("#"+k).show();a(".jqgrid-overlay","#gbox_"+j.p.id).show();try{a(":input:visible","#"+k)[0].focus()}catch(v){}}var j=this;if(j.grid)if(a.fn.searchFilter){var k="fbox_"+j.p.id;d.recreateFilter===true&&a("#"+k).remove();if(a("#"+k).html()!=null){a.isFunction(d.beforeShowSearch)&&d.beforeShowSearch(a("#"+k));h();a.isFunction(d.afterShowSearch)&&d.afterShowSearch(a("#"+k))}else{var e=[],l=jQuery("#"+j.p.id).getGridParam("colNames"),o=jQuery("#"+
j.p.id).getGridParam("colModel"),m=["eq","ne","lt","le","gt","ge","bw","bn","in","ni","ew","en","cn","nc"],n,q,r;a.each(o,function(v,w){var z=typeof w.search==="undefined"?true:w.search,B=w.hidden===true,p=a.extend({},{text:l[v],value:w.index||w.name},this.searchoptions),y=p.searchhidden===true||true;if(typeof p.sopt=="undefined")p.sopt=m;r=0;p.ops=[];for(n=0;n<p.sopt.length;n++)if((q=a.inArray(p.sopt[n],m))!=-1){p.ops[r]={op:p.sopt[n],text:d.odata[q]};r++}if(typeof this.stype==="undefined")this.stype=
"text";if(this.stype=="select")if(p.dataUrl==null)if(this.editoptions){var G=this.editoptions.value;if(G){p.dataValues=[];if(typeof G==="string"){G=G.split(";");var D;for(n=0;n<G.length;n++){D=G[n].split(":");p.dataValues[n]={value:D[0],text:D[1]}}}else if(typeof G==="object"){n=0;for(D in G){p.dataValues[n]={value:D,text:G[D]};n++}}}}if(y&&z||z&&!B)e.push(p)});if(e.length>0){o=jQuery.fn.searchFilter.defaults.operators;if(d.sopt!=null){o=[];for(n=r=0;d.sopt.length<0;n++)if((q=a.inArray(d.sopt[n],
m))!=-1){o[r]={op:d.sopt[n],text:d.odata[q]};r++}}a("<div id='"+k+"' role='dialog' tabindex='-1'></div>").insertBefore("#gview_"+j.p.id);jQuery("#"+k).searchFilter(e,{groupOps:d.groupOps,operators:o,onClose:g,resetText:d.Reset,searchText:d.Find,windowTitle:d.caption,rulesText:d.rulesText,matchText:d.matchText,onSearch:c,onReset:f,stringResult:d.multipleSearch});a(".ui-widget-overlay","#"+k).remove();if(d.drag===true){a("#"+k+" table thead tr:first td:first").css("cursor","move");if(jQuery.fn.jqDrag)jQuery("#"+
k).jqDrag(a("#"+k+" table thead tr:first td:first"));else try{a("#"+k).draggable({handle:jQuery("#"+k+" table thead tr:first td:first")})}catch(t){}}if(d.multipleSearch===false){a(".ui-del, .ui-add, .ui-del, .ui-add-last, .matchText, .rulesText","#"+k).hide();a("select[name='groupOp']","#"+k).hide()}a.isFunction(d.onInitializeSearch)&&d.onInitializeSearch(a("#"+k));a.isFunction(d.beforeShowSearch)&&d.beforeShowSearch(a("#"+k));h();a.isFunction(d.afterShowSearch)&&d.afterShowSearch(a("#"+k));d.closeOnEscape===
true&&jQuery("#"+k).keydown(function(v){v.which==27&&g(a("#"+k))})}}}})},editGridRow:function(d,c){b=c=a.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,url:null,mtype:"POST",closeAfterAdd:false,clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,
editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},onClose:null},a.jgrid.edit,c||{});return this.each(function(){function f(A,H){A==0?a("#pData","#"+r+"_2").addClass("ui-state-disabled"):a("#pData","#"+r+"_2").removeClass("ui-state-disabled");A==H?a("#nData","#"+r+"_2").addClass("ui-state-disabled"):a("#nData","#"+r+"_2").removeClass("ui-state-disabled")}
function g(){var A=a(m).getDataIDs(),H=a("#id_g","#"+r).val();return[a.inArray(H,A),A]}function h(){var A=true;a("#FormError","#"+r).hide();if(b.checkOnUpdate){D={};Q={};j();Y=a.extend({},D,Q);if(aa=o(Y,b._savedData)){a("#"+q).data("disabled",true);a(".confirm","#"+t.themodal).show();A=false}}return A}function j(){a(".FormElement","#"+r).each(function(){switch(a(this).get(0).type){case "checkbox":if(a(this).attr("checked"))D[this.name]=a(this).val();else{var A=a(this).attr("offval");D[this.name]=
A;Q[this.name]=A}break;case "select-one":D[this.name]=a("option:selected",this).val();Q[this.name]=a("option:selected",this).text();break;case "select-multiple":D[this.name]=a(this).val();D[this.name]=D[this.name]?D[this.name].join(","):"";var H=[];a("option:selected",this).each(function(U,R){H[U]=a(R).text()});Q[this.name]=H.join(",");break;case "password":case "text":case "textarea":case "button":D[this.name]=a(this).val();D[this.name]=!m.p.autoencode?D[this.name]:a.jgrid.htmlEncode(D[this.name]);
break}});return true}function k(A,H,U,R){for(var W,O,P,X=0,V,la,da,S=[],M=false,qa,Aa,Ba="",ua=1;ua<=R;ua++)Ba+="<td class='CaptionTD ui-widget-content'>&nbsp;</td><td class='DataTD ui-widget-content' style='white-space:pre'>&nbsp;</td>";if(A!="_empty")M=a(H).getInd(A);a(H.p.colModel).each(function(va){W=this.name;la=(O=this.editrules&&this.editrules.edithidden==true?false:this.hidden===true?true:false)?"style='display:none'":"";if(W!=="cb"&&W!=="subgrid"&&this.editable===true&&W!=="rn"){if(M===false)V=
"";else if(W==H.p.ExpandColumn&&H.p.treeGrid===true)V=a("td:eq("+va+")",H.rows[M]).text();else try{V=a.unformat(a("td:eq("+va+")",H.rows[M]),{colModel:this},va)}catch(ta){V=a("td:eq("+va+")",H.rows[M]).html()}var ja=a.extend({},this.editoptions||{},{id:W,name:W});frmopt=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{});qa=parseInt(frmopt.rowpos)||X+1;Aa=parseInt((parseInt(frmopt.colpos)||1)*2);if(A=="_empty"&&ja.defaultValue)V=a.isFunction(ja.defaultValue)?
ja.defaultValue():ja.defaultValue;if(!this.edittype)this.edittype="text";da=createEl(this.edittype,ja,V);if(V==""&&this.edittype=="checkbox")V=a(da).attr("offval");if(b.checkOnSubmit||b.checkOnUpdate)b._savedData[W]=V;a(da).addClass("FormElement");P=a(U).find("tr[rowpos="+qa+"]");if(frmopt.rowabove){ja=a("<tr><td class='contentinfo' colspan='"+R*2+"'>"+frmopt.rowcontent+"</td></tr>");a(U).append(ja);ja[0].rp=qa}if(P.length==0){P=a("<tr "+la+" rowpos='"+qa+"'></tr>").addClass("FormData").attr("id",
"tr_"+W);a(P).append(Ba);a(U).append(P);P[0].rp=qa}a("td:eq("+(Aa-2)+")",P[0]).html(typeof frmopt.label==="undefined"?H.p.colNames[va]:frmopt.label);a("td:eq("+(Aa-1)+")",P[0]).append(frmopt.elmprefix).append(da).append(frmopt.elmsuffix);S[X]=va;X++}});if(X>0){ua=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(R*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+A+"'/></td></tr>");ua[0].rp=X+999;a(U).append(ua);if(b.checkOnSubmit||
b.checkOnUpdate)b._savedData.id=A}return S}function e(A,H,U){var R,W=0,O,P,X,V,la;if(b.checkOnSubmit||b.checkOnUpdate){b._savedData={};b._savedData.id=A}var da=H.p.colModel;if(A=="_empty"){a(da).each(function(){R=this.name.replace(".","\\.");X=a.extend({},this.editoptions||{});P=a("#"+R,"#"+U);if(P[0]!=null){V="";if(X.defaultValue){V=a.isFunction(X.defaultValue)?X.defaultValue():X.defaultValue;if(P[0].type=="checkbox"){la=V.toLowerCase();if(la.search(/(false|0|no|off|undefined)/i)<0&&la!==""){P[0].checked=
true;P[0].defaultChecked=true;P[0].value=V}else P.attr({checked:"",defaultChecked:""})}else P.val(V)}else if(P[0].type=="checkbox"){P[0].checked=false;P[0].defaultChecked=false;V=a(P).attr("offval")}else if(P[0].type.substr(0,6)=="select")P[0].selectedIndex=0;else P.val(V);if(b.checkOnSubmit===true||b.checkOnUpdate)b._savedData[R]=V}});a("#id_g","#"+U).val("_empty")}else{var S=a(H).getInd(A,true);if(S){a("td",S).each(function(M){R=da[M].name.replace(".","\\.");if(R!=="cb"&&R!=="subgrid"&&da[M].editable===
true){if(R==H.p.ExpandColumn&&H.p.treeGrid===true)O=a(this).text();else try{O=a.unformat(this,{colModel:da[M]},M)}catch(qa){O=a(this).html()}if(b.checkOnSubmit===true||b.checkOnUpdate)b._savedData[R]=O;switch(da[M].edittype){case "password":case "text":case "button":case "image":O=a.jgrid.htmlDecode(O);a("#"+R,"#"+U).val(O);break;case "textarea":if(O=="&nbsp;"||O=="&#160;"||O.length==1&&O.charCodeAt(0)==160)O="";a("#"+R,"#"+U).val(O);break;case "select":a("#"+R+" option","#"+U).each(function(){this.selected=
!da[M].editoptions.multiple&&(O==a(this).text()||O==a(this).val())?true:da[M].editoptions.multiple?a.inArray(a(this).text(),O.split(","))>-1||a.inArray(a(this).val(),O.split(","))>-1?true:false:false});break;case "checkbox":O=O.toLowerCase();if(O.search(/(false|0|no|off|undefined)/i)<0&&O!==""){a("#"+R,"#"+U).attr("checked",true);a("#"+R,"#"+U).attr("defaultChecked",true)}else{a("#"+R,"#"+U).attr("checked",false);a("#"+R,"#"+U).attr("defaultChecked","")}break}W++}});W>0&&a("#id_g","#"+r).val(A)}}}
function l(){var A,H=[true,"",""],U={};for(var R in D){H=checkValues(D[R],R,m);if(H[0]==false)break}if(H[0]){if(a.isFunction(b.onclickSubmit))U=b.onclickSubmit(b,D)||{};if(a.isFunction(b.beforeSubmit))H=b.beforeSubmit(D,a("#"+q))}G=b.url?b.url:m.p.editurl;if(H[0])if(!G){H[0]=false;H[1]+=" "+a.jgrid.errors.nourl}if(H[0]===false){a("#FormError>td","#"+r).html(H[1]);a("#FormError","#"+r).show()}else if(!c.processing){c.processing=true;a("#sData","#"+r+"_2").addClass("ui-state-active");D.oper=D.id=="_empty"?
"add":"edit";D=a.extend(D,b.editData,U);a.ajax({url:G,type:b.mtype,data:D,complete:function(W,O){if(O!="success"){H[0]=false;H[1]=a.isFunction(b.errorTextFormat)?b.errorTextFormat(W):O+" Status: '"+W.statusText+"'. Error code: "+W.status}else if(a.isFunction(b.afterSubmit))H=b.afterSubmit(W,D);if(H[0]===false){a("#FormError>td","#"+r).html(H[1]);a("#FormError","#"+r).show()}else{D=a.extend(D,Q);if(D.id=="_empty"){H[2]||(H[2]=parseInt(m.p.records)+1);D.id=H[2];if(b.closeAfterAdd){if(b.reloadAfterSubmit)a(m).trigger("reloadGrid");
else{a(m).addRowData(H[2],D,c.addedrow);a(m).setSelection(H[2])}hideModal("#"+t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,onClose:b.onClose})}else if(b.clearAfterAdd){b.reloadAfterSubmit?a(m).trigger("reloadGrid"):a(m).addRowData(H[2],D,c.addedrow);e("_empty",m,q)}else b.reloadAfterSubmit?a(m).trigger("reloadGrid"):a(m).addRowData(H[2],D,c.addedrow)}else{if(b.reloadAfterSubmit){a(m).trigger("reloadGrid");b.closeAfterEdit||setTimeout(function(){a(m).setSelection(D.id)},1E3)}else m.p.treeGrid===true?a(m).setTreeRow(D.id,
D):a(m).setRowData(D.id,D);b.closeAfterEdit&&hideModal("#"+t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,onClose:b.onClose})}if(a.isFunction(b.afterComplete)){A=W;setTimeout(function(){b.afterComplete(A,D,a("#"+q));A=null},500)}}c.processing=false;if(b.checkOnSubmit||b.checkOnUpdate){a("#"+q).data("disabled",false);if(b._savedData.id!="_empty")b._savedData=D}a("#sData","#"+r+"_2").removeClass("ui-state-active");try{a(":input:visible","#"+q)[0].focus()}catch(P){}},error:function(W,O,P){a("#FormError>td",
"#"+r).html(O+" : "+P);a("#FormError","#"+r).show();c.processing=false;a("#"+q).data("disabled",false);a("#sData","#"+r+"_2").removeClass("ui-state-active")}})}}function o(A,H){var U=false,R;for(R in A)if(A[R]!=H[R]){U=true;break}return U}var m=this;if(m.grid&&d){var n=m.p.id,q="FrmGrid_"+n,r="TblGrid_"+n,t={themodal:"editmod"+n,modalhead:"edithd"+n,modalcontent:"editcnt"+n,scrollelm:q},v=a.isFunction(b.beforeShowForm)?b.beforeShowForm:false,w=a.isFunction(b.afterShowForm)?b.afterShowForm:false,z=
a.isFunction(b.beforeInitData)?b.beforeInitData:false,B=a.isFunction(b.onInitializeForm)?b.onInitializeForm:false,p=1,y=0,G,D,Q,Y,aa;if(d=="new"){d="_empty";c.caption=c.addCaption}else c.caption=c.editCaption;c.recreateForm===true&&a("#"+t.themodal).html()!=null&&a("#"+t.themodal).remove();var Z=true;if(c.checkOnUpdate&&c.jqModal&&!c.modal)Z=false;if(a("#"+t.themodal).html()!=null){a(".ui-jqdialog-title","#"+t.modalhead).html(c.caption);a("#FormError","#"+r).hide();z&&z(a("#"+q));e(d,m,q);d=="_empty"?
a("#pData, #nData","#"+r+"_2").hide():a("#pData, #nData","#"+r+"_2").show();if(c.processing===true){c.processing=false;a("#sData","#"+r).removeClass("ui-state-active")}if(a("#"+q).data("disabled")===true){a(".confirm","#"+t.themodal).hide();a("#"+q).data("disabled",false)}v&&v(a("#"+q));a("#"+t.themodal).data("onClose",b.onClose);viewModal("#"+t.themodal,{gbox:"#gbox_"+n,jqm:c.jqModal,jqM:false,closeoverlay:Z,modal:c.modal});Z||a(".jqmOverlay").click(function(){if(!h())return false;hideModal("#"+
t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,onClose:b.onClose});return false});w&&w(a("#"+q))}else{a(m.p.colModel).each(function(){var A=this.formoptions;p=Math.max(p,A?A.colpos||0:0);y=Math.max(y,A?A.rowpos||0:0)});var fa=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px",ha;fa=a("<form name='FormPost' id='"+q+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+fa+";'></form>").data("disabled",false);var ia=a("<table id='"+r+"' class='EditTable' cellspacing='0' cellpading='0' border='0'><tbody></tbody></table>");
a(fa).append(ia);ha=a("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+p*2+"'></td></tr>");ha[0].rp=0;a(ia).append(ha);if(b.topinfo){ha=a("<tr><td class='topinfo' colspan='"+p*2+"'>"+b.topinfo+"</td></tr>");ha[0].rp=0;a(ia).append(ha)}z&&z(a("#"+q));k(d,m,ia,p);z="<a href='javascript:void(0)' id='nData' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div>";ha="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default ui-corner-all'>"+
c.bSubmit+"</a>";var pa="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bCancel+"</a>";z="<table border='0' class='EditTable' id='"+r+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content'><a href='javascript:void(0)' id='pData' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div>"+z+"</td><td class='EditButton ui-widget-content'>"+ha+"&nbsp;"+pa+"</td></tr>";if(b.bottominfo)z+="<tr><td class='bottominfo' colspan='2'>"+
b.bottominfo+"</td></tr>";z+="</tbody></table>";if(y>0){var sa=[];a.each(a(ia)[0].rows,function(A,H){sa[A]=H});sa.sort(function(A,H){if(A.rp>H.rp)return 1;if(A.rp<H.rp)return-1;return 0});a.each(sa,function(A,H){a("tbody",ia).append(H)})}c.gbox="#gbox_"+n;var ya=false;if(c.closeOnEscape===true){c.closeOnEscape=false;ya=true}fa=a("<span></span>").append(fa).append(z);createModal(t,fa,c,"#gview_"+m.p.id,a("#gview_"+m.p.id)[0]);z=fa=null;jQuery("#"+t.themodal).keydown(function(A){if(a("#"+q).data("disabled")===
true)return false;if(b.savekey[0]===true&&A.which==b.savekey[1]){a("#sData","#"+r+"_2").trigger("click");return false}if(A.which===27){if(!h())return false;ya&&hideModal(this,{gb:c.gbox,jqm:c.jqModal,onClose:b.onClose});return false}if(b.navkeys[0]===true){if(a("#id_g","#"+r).val()=="_empty")return true;if(A.which==b.navkeys[1]){a("#pData","#"+r+"_2").trigger("click");return false}if(A.which==b.navkeys[2]){a("#nData","#"+r+"_2").trigger("click");return false}}});if(c.checkOnUpdate){a("a.ui-jqdialog-titlebar-close span",
"#"+t.themodal).removeClass("jqmClose");a("a.ui-jqdialog-titlebar-close","#"+t.themodal).unbind("click").click(function(){if(!h())return false;hideModal("#"+t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,onClose:b.onClose});return false})}c.saveicon=a.extend([true,"left","ui-icon-disk"],c.saveicon);c.closeicon=a.extend([true,"left","ui-icon-close"],c.closeicon);if(c.saveicon[0]==true)a("#sData","#"+r+"_2").addClass(c.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+
c.saveicon[2]+"'></span>");if(c.closeicon[0]==true)a("#cData","#"+r+"_2").addClass(c.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.closeicon[2]+"'></span>");if(b.checkOnSubmit||b.checkOnUpdate){ha="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bYes+"</a>";z="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bNo+"</a>";
pa="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default ui-corner-all' style='z-index:1002'>"+c.bExit+"</a>";fa=c.zIndex||999;fa++;a("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+fa+";display:none;'>&nbsp;"+(a.browser.msie&&a.browser.version==6?'<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>':"")+"</div><div class='confirm ui-widget-content ui-jqconfirm' style='z-index:"+(fa+1)+
"'>"+c.saveData+"<br/><br/>"+ha+z+pa+"</div>").insertAfter("#"+q);a("#sNew","#"+t.themodal).click(function(){l([true,"",""]);a("#"+q).data("disabled",false);a(".confirm","#"+t.themodal).hide();return false});a("#nNew","#"+t.themodal).click(function(){a(".confirm","#"+t.themodal).hide();a("#"+q).data("disabled",false);setTimeout(function(){a(":input","#"+q)[0].focus()},0);return false});a("#cNew","#"+t.themodal).click(function(){a(".confirm","#"+t.themodal).hide();a("#"+q).data("disabled",false);hideModal("#"+
t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,onClose:b.onClose});return false})}B&&B(a("#"+q));d=="_empty"?a("#pData,#nData","#"+r+"_2").hide():a("#pData,#nData","#"+r+"_2").show();v&&v(a("#"+q));a("#"+t.themodal).data("onClose",b.onClose);viewModal("#"+t.themodal,{gbox:"#gbox_"+n,jqm:c.jqModal,closeoverlay:Z,modal:c.modal});Z||a(".jqmOverlay").click(function(){if(!h())return false;hideModal("#"+t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,onClose:b.onClose});return false});w&&w(a("#"+q));a(".fm-button","#"+
t.themodal).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});a("#sData","#"+r+"_2").click(function(){D={};Q={};a("#FormError","#"+r).hide();j();if(D.id=="_empty")l();else if(c.checkOnSubmit===true){Y=a.extend({},D,Q);if(aa=o(Y,b._savedData)){a("#"+q).data("disabled",true);a(".confirm","#"+t.themodal).show()}else l()}else l();return false});a("#cData","#"+r+"_2").click(function(){if(!h())return false;hideModal("#"+t.themodal,{gb:"#gbox_"+n,jqm:c.jqModal,
onClose:b.onClose});return false});a("#nData","#"+r+"_2").click(function(){if(!h())return false;a("#FormError","#"+r).hide();var A=g();A[0]=parseInt(A[0]);if(A[0]!=-1&&A[1][A[0]+1]){a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("next",a("#"+q),A[1][A[0]]);e(A[1][A[0]+1],m,q);a(m).setSelection(A[1][A[0]+1]);a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("next",a("#"+q),A[1][A[0]+1]);f(A[0]+1,A[1].length-1)}return false});a("#pData","#"+r+"_2").click(function(){if(!h())return false;
a("#FormError","#"+r).hide();var A=g();if(A[0]!=-1&&A[1][A[0]-1]){a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("prev",a("#"+q),A[1][A[0]]);e(A[1][A[0]-1],m,q);a(m).setSelection(A[1][A[0]-1]);a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("prev",a("#"+q),A[1][A[0]-1]);f(A[0]-1,A[1].length-1)}return false})}v=g();f(v[0],v[1].length-1)}})},viewGridRow:function(d,c){c=a.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,jqModal:true,closeOnEscape:false,
labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null},a.jgrid.view,c||{});return this.each(function(){function f(){if(c.closeOnEscape===true||c.navkeys[0]===true)setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+n.modalhead).focus()},0)}function g(p,y){p==0?a("#pData","#"+m+"_2").addClass("ui-state-disabled"):a("#pData","#"+m+"_2").removeClass("ui-state-disabled");p==y?a("#nData","#"+m+"_2").addClass("ui-state-disabled"):a("#nData","#"+m+"_2").removeClass("ui-state-disabled")}
function h(){var p=a(e).getDataIDs(),y=a("#id_g","#"+m).val();return[a.inArray(y,p),p]}function j(p,y,G,D){for(var Q,Y,aa,Z=0,fa,ha,ia=[],pa=false,sa="<td class='CaptionTD ui-widget-content' width='"+c.labelswidth+"'>&nbsp;</td><td class='DataTD ui-helper-reset ui-widget-content' style='white-space:pre;'>&nbsp;</td>",ya="",A=["integer","number","currency"],H=0,U=0,R,W,O=1;O<=D;O++)ya+=O==1?sa:"<td class='CaptionTD ui-widget-content'>&nbsp;</td><td class='DataTD ui-widget-content' style='white-space:pre;'>&nbsp;</td>";
a(y.p.colModel).each(function(){Y=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false;if(!Y&&this.align==="right")if(this.formatter&&a.inArray(this.formatter,A)!==-1)H=Math.max(H,parseInt(this.width,10));else U=Math.max(U,parseInt(this.width,10))});R=H!==0?H:U!==0?U:0;pa=a(y).getInd(p);a(y.p.colModel).each(function(P){Q=this.name;W=false;ha=(Y=this.editrules&&this.editrules.edithidden===true?false:this.hidden===true?true:false)?"style='display:none'":"";if(Q!=="cb"&&
Q!=="subgrid"&&this.editable===true){fa=pa===false?"":Q==y.p.ExpandColumn&&y.p.treeGrid===true?a("td:eq("+P+")",y.rows[pa]).text():a("td:eq("+P+")",y.rows[pa]).html();W=this.align==="right"&&R!==0?true:false;a.extend({},this.editoptions||{},{id:Q,name:Q});var X=a.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),V=parseInt(X.rowpos)||Z+1,la=parseInt((parseInt(X.colpos)||1)*2);if(X.rowabove){var da=a("<tr><td class='contentinfo' colspan='"+D*2+"'>"+X.rowcontent+"</td></tr>");a(G).append(da);
da[0].rp=V}aa=a(G).find("tr[rowpos="+V+"]");if(aa.length==0){aa=a("<tr "+ha+" rowpos='"+V+"'></tr>").addClass("FormData").attr("id","trv_"+Q);a(aa).append(ya);a(G).append(aa);aa[0].rp=V}a("td:eq("+(la-2)+")",aa[0]).html("<b>"+(typeof X.label==="undefined"?y.p.colNames[P]:X.label)+"</b>");a("td:eq("+(la-1)+")",aa[0]).append("<span>"+fa+"</span>").attr("id","v_"+Q);W&&a("td:eq("+(la-1)+") span",aa[0]).css({"text-align":"right",width:R+"px"});ia[Z]=P;Z++}});if(Z>0){p=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+
(D*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+p+"'/></td></tr>");p[0].rp=Z+99;a(G).append(p)}return ia}function k(p,y){var G,D,Q=0,Y,aa;if(aa=a(y).getInd(p,true)){a("td",aa).each(function(Z){G=y.p.colModel[Z].name.replace(".","\\.");D=y.p.colModel[Z].editrules&&y.p.colModel[Z].editrules.edithidden===true?false:y.p.colModel[Z].hidden===true?true:false;if(G!=="cb"&&G!=="subgrid"&&y.p.colModel[Z].editable===true){Y=G==y.p.ExpandColumn&&y.p.treeGrid===true?
a(this).text():a(this).html();a.extend({},y.p.colModel[Z].editoptions||{});G="v_"+G;a("#"+G+" span","#"+m).html(Y);D&&a("#"+G,"#"+m).parents("tr:first").hide();Q++}});Q>0&&a("#id_g","#"+m).val(p)}}var e=this;if(e.grid&&d){if(!c.imgpath)c.imgpath=e.p.imgpath;var l=e.p.id,o="ViewGrid_"+l,m="ViewTbl_"+l,n={themodal:"viewmod"+l,modalhead:"viewhd"+l,modalcontent:"viewcnt"+l,scrollelm:o},q=1,r=0;if(a("#"+n.themodal).html()!=null){a(".ui-jqdialog-title","#"+n.modalhead).html(c.caption);a("#FormError","#"+
m).hide();k(d,e);viewModal("#"+n.themodal,{gbox:"#gbox_"+l,jqm:c.jqModal,jqM:false,modal:c.modal});f()}else{a(e.p.colModel).each(function(){var p=this.formoptions;q=Math.max(q,p?p.colpos||0:0);r=Math.max(r,p?p.rowpos||0:0)});var t=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px";t=a("<form name='FormPost' id='"+o+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+t+";'></form>");var v=a("<table id='"+m+"' class='EditTable' cellspacing='1' cellpading='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");
a(t).append(v);j(d,e,v,q);var w="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default ui-corner-all'>"+c.bClose+"</a>";if(r>0){var z=[];a.each(a(v)[0].rows,function(p,y){z[p]=y});z.sort(function(p,y){if(p.rp>y.rp)return 1;if(p.rp<y.rp)return-1;return 0});a.each(z,function(p,y){a("tbody",v).append(y)})}c.gbox="#gbox_"+l;var B=false;if(c.closeOnEscape===true){c.closeOnEscape=false;B=true}t=a("<span></span>").append(t).append("<table border='0' class='EditTable' id='"+m+"_2'><tbody><tr id='Act_Buttons'><td class='navButton ui-widget-content' width='"+
c.labelswidth+"'><a href='javascript:void(0)' id='pData' class='fm-button ui-state-default ui-corner-left'><span class='ui-icon ui-icon-triangle-1-w'></span></div><a href='javascript:void(0)' id='nData' class='fm-button ui-state-default ui-corner-right'><span class='ui-icon ui-icon-triangle-1-e'></span></div></td><td class='EditButton ui-widget-content'>"+w+"</td></tr></tbody></table>");createModal(n,t,c,"#gview_"+e.p.id,a("#gview_"+e.p.id)[0]);t=null;jQuery("#"+n.themodal).keydown(function(p){if(p.which===
27){B&&hideModal(this,{gb:c.gbox,jqm:c.jqModal,onClose:c.onClose});return false}if(c.navkeys[0]===true){if(p.which===c.navkeys[1]){a("#pData","#"+m+"_2").trigger("click");return false}if(p.which===c.navkeys[2]){a("#nData","#"+m+"_2").trigger("click");return false}}});c.closeicon=a.extend([true,"left","ui-icon-close"],c.closeicon);if(c.closeicon[0]==true)a("#cData","#"+m+"_2").addClass(c.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.closeicon[2]+
"'></span>");viewModal("#"+n.themodal,{gbox:"#gbox_"+l,jqm:c.jqModal,modal:c.modal});a(".fm-button:not(.ui-state-disabled)","#"+m+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});f();a("#cData","#"+m+"_2").click(function(){hideModal("#"+n.themodal,{gb:"#gbox_"+l,jqm:c.jqModal,onClose:c.onClose});return false});a("#nData","#"+m+"_2").click(function(){a("#FormError","#"+m).hide();var p=h();p[0]=parseInt(p[0]);if(p[0]!=-1&&p[1][p[0]+1]){a.isFunction(c.onclickPgButtons)&&
c.onclickPgButtons("next",a("#"+o),p[1][p[0]]);k(p[1][p[0]+1],e);a(e).setSelection(p[1][p[0]+1]);a.isFunction(c.afterclickPgButtons)&&c.afterclickPgButtons("next",a("#"+o),p[1][p[0]+1]);g(p[0]+1,p[1].length-1)}f();return false});a("#pData","#"+m+"_2").click(function(){a("#FormError","#"+m).hide();var p=h();if(p[0]!=-1&&p[1][p[0]-1]){a.isFunction(c.onclickPgButtons)&&c.onclickPgButtons("prev",a("#"+o),p[1][p[0]]);k(p[1][p[0]-1],e);a(e).setSelection(p[1][p[0]-1]);a.isFunction(c.afterclickPgButtons)&&
c.afterclickPgButtons("prev",a("#"+o),p[1][p[0]-1]);g(p[0]-1,p[1].length-1)}f();return false})}t=h();g(t[0],t[1].length-1)}})},delGridRow:function(d,c){b=c=a.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null},a.jgrid.del,c||{});return this.each(function(){var f=
this;if(f.grid)if(d){var g=typeof c.beforeShowForm==="function"?true:false,h=typeof c.afterShowForm==="function"?true:false,j=f.p.id,k={},e="DelTbl_"+j,l={themodal:"delmod"+j,modalhead:"delhd"+j,modalcontent:"delcnt"+j,scrollelm:e};if(isArray(d))d=d.join();if(a("#"+l.themodal).html()!=null){a("#DelData>td","#"+e).text(d);a("#DelError","#"+e).hide();if(c.processing===true){c.processing=false;a("#dData","#"+e).removeClass("ui-state-active")}g&&c.beforeShowForm(a("#"+e));viewModal("#"+l.themodal,{gbox:"#gbox_"+
j,jqm:c.jqModal,jqM:false,modal:c.modal})}else{var o=isNaN(c.dataheight)?c.dataheight:c.dataheight+"px";o="<div id='"+e+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+o+";'>";o+="<table class='DelTable'><tbody>";o+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";o+="<tr id='DelData' style='display:none'><td >"+d+"</td></tr>";o+='<tr><td class="delmsg" style="white-space:pre;">'+c.msg+"</td></tr><tr><td >&nbsp;</td></tr>";o+="</tbody></table></div>";
o+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+e+"_2'><tbody><tr><td class='DataTD ui-widget-content'></td></tr><tr style='display:block;height:3px;'><td></td></tr><tr><td class='DelButton EditButton'>"+("<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+c.bSubmit+"</a>")+"&nbsp;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+c.bCancel+"</a>")+"</td></tr></tbody></table>";c.gbox=
"#gbox_"+j;createModal(l,o,c,"#gview_"+f.p.id,a("#gview_"+f.p.id)[0]);a(".fm-button","#"+e+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});c.delicon=a.extend([true,"left","ui-icon-scissors"],c.delicon);c.cancelicon=a.extend([true,"left","ui-icon-cancel"],c.cancelicon);if(c.delicon[0]==true)a("#dData","#"+e+"_2").addClass(c.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.delicon[2]+"'></span>");
if(c.cancelicon[0]==true)a("#eData","#"+e+"_2").addClass(c.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+c.cancelicon[2]+"'></span>");a("#dData","#"+e+"_2").click(function(){var m=[true,""];k={};var n=a("#DelData>td","#"+e).text();if(typeof c.onclickSubmit==="function")k=c.onclickSubmit(b)||{};if(typeof c.beforeSubmit==="function")m=c.beforeSubmit(n);var q=b.url?b.url:f.p.editurl;if(!q){m[0]=false;m[1]+=" "+a.jgrid.errors.nourl}if(m[0]===false){a("#DelError>td",
"#"+e).html(m[1]);a("#DelError","#"+e).show()}else if(!c.processing){c.processing=true;a(this).addClass("ui-state-active");var r=a.extend({oper:"del",id:n},c.delData,k);a.ajax({url:q,type:c.mtype,data:r,complete:function(t,v){if(v!="success"){m[0]=false;m[1]=a.isFunction(b.errorTextFormat)?b.errorTextFormat(t):v+" Status: '"+t.statusText+"'. Error code: "+t.status}else if(typeof b.afterSubmit==="function")m=b.afterSubmit(t,n);if(m[0]===false){a("#DelError>td","#"+e).html(m[1]);a("#DelError","#"+e).show()}else{if(b.reloadAfterSubmit){f.p.treeGrid&&
a(f).setGridParam({treeANode:0,datatype:f.p.treedatatype});a(f).trigger("reloadGrid")}else{var w=[];w=n.split(",");if(f.p.treeGrid===true)try{a(f).delTreeNode(w[0])}catch(z){}else for(var B=0;B<w.length;B++)a(f).delRowData(w[B]);f.p.selrow=null;f.p.selarrrow=[]}a.isFunction(b.afterComplete)&&setTimeout(function(){b.afterComplete(t,n)},500)}c.processing=false;a("#dData","#"+e+"_2").removeClass("ui-state-active");m[0]&&hideModal("#"+l.themodal,{gb:"#gbox_"+j,jqm:c.jqModal,onClose:b.onClose})},error:function(t,
v,w){a("#DelError>td","#"+e).html(v+" : "+w);a("#DelError","#"+e).show();c.processing=false;a("#dData","#"+e+"_2").removeClass("ui-state-active")}})}return false});a("#eData","#"+e+"_2").click(function(){hideModal("#"+l.themodal,{gb:"#gbox_"+j,jqm:c.jqModal,onClose:b.onClose});return false});g&&c.beforeShowForm(a("#"+e));viewModal("#"+l.themodal,{gbox:"#gbox_"+j,jqm:c.jqModal,modal:c.modal})}h&&c.afterShowForm(a("#"+e));c.closeOnEscape===true&&setTimeout(function(){a(".ui-jqdialog-titlebar-close",
"#"+l.modalhead).focus()},0)}})},navGrid:function(d,c,f,g,h,j,k){c=a.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,afterRefresh:null},a.jgrid.nav,c||{});return this.each(function(){var e={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},l=this,
o,m,n;if(l.grid){if(a("#"+e.themodal).html()==null){if(typeof window.innerWidth!="undefined"){o=window.innerWidth;m=window.innerHeight}else if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){o=document.documentElement.clientWidth;m=document.documentElement.clientHeight}else{o=1024;m=768}createModal(e,"<div>"+c.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+
l.p.id,jqModal:true,drag:true,resize:true,caption:c.alertcap,top:m/2-25,left:o/2-100,width:200,height:"auto",closeOnEscape:c.closeOnEscape},"","",true)}o=a("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>");m=a(l.p.pager).attr("id")||"pager";if(c.add){g=g||{};n=a("<td class='ui-pg-button ui-corner-all'></td>");a(n).append("<div class='ui-pg-div'><span class='ui-icon "+c.addicon+"'></span>"+c.addtext+
"</div>");a("tr",o).append(n);a(n,o).attr({title:c.addtitle||"",id:g.id||"add_"+l.p.id}).click(function(){typeof c.addfunc=="function"?c.addfunc():a(l).editGridRow("new",g);return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});n=null}if(c.edit){n=a("<td class='ui-pg-button ui-corner-all'></td>");f=f||{};a(n).append("<div class='ui-pg-div'><span class='ui-icon "+c.editicon+"'></span>"+c.edittext+"</div>");a("tr",o).append(n);a(n,o).attr({title:c.edittitle||
"",id:f.id||"edit_"+l.p.id}).click(function(){var q=l.p.selrow;if(q)typeof c.editfunc=="function"?c.editfunc(q):a(l).editGridRow(q,f);else{viewModal("#"+e.themodal,{gbox:"#gbox_"+l.p.id,jqm:true});a("#jqg_alrt").focus()}return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});n=null}if(c.view){n=a("<td class='ui-pg-button ui-corner-all'></td>");k=k||{};a(n).append("<div class='ui-pg-div'><span class='ui-icon "+c.viewicon+"'></span>"+c.viewtext+
"</div>");a("tr",o).append(n);a(n,o).attr({title:c.viewtitle||"",id:k.id||"view_"+l.p.id}).click(function(){var q=l.p.selrow;if(q)a(l).viewGridRow(q,k);else{viewModal("#"+e.themodal,{gbox:"#gbox_"+l.p.id,jqm:true});a("#jqg_alrt").focus()}return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});n=null}if(c.del){n=a("<td class='ui-pg-button ui-corner-all'></td>");h=h||{};a(n).append("<div class='ui-pg-div'><span class='ui-icon "+c.delicon+
"'></span>"+c.deltext+"</div>");a("tr",o).append(n);a(n,o).attr({title:c.deltitle||"",id:h.id||"del_"+l.p.id}).click(function(){var q;if(l.p.multiselect){q=l.p.selarrrow;if(q.length==0)q=null}else q=l.p.selrow;if(q)a(l).delGridRow(q,h);else{viewModal("#"+e.themodal,{gbox:"#gbox_"+l.p.id,jqm:true});a("#jqg_alrt").focus()}return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});n=null}if(c.add||c.edit||c.del||c.view)a("tr",o).append("<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>");
if(c.search){n=a("<td class='ui-pg-button ui-corner-all'></td>");j=j||{};a(n).append("<div class='ui-pg-div'><span class='ui-icon "+c.searchicon+"'></span>"+c.searchtext+"</div>");a("tr",o).append(n);a(n,o).attr({title:c.searchtitle||"",id:j.id||"search_"+l.p.id}).click(function(){a(l).searchGrid(j);return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});n=null}if(c.refresh){n=a("<td class='ui-pg-button ui-corner-all'></td>");a(n).append("<div class='ui-pg-div'><span class='ui-icon "+
c.refreshicon+"'></span>"+c.refreshtext+"</div>");a("tr",o).append(n);a(n,o).attr({title:c.refreshtitle||"",id:"refresh_"+l.p.id}).click(function(){l.p.search=false;try{a("#fbox_"+l.p.id).searchFilter().reset()}catch(q){}switch(c.refreshstate){case "firstpage":l.p.page=1;a(l).trigger("reloadGrid");break;case "current":var r=l.p.multiselect===true?l.p.selarrrow:l.p.selrow;a(l).trigger("reloadGrid");setTimeout(function(){if(l.p.multiselect===true){if(r.length>0)for(var t=0;t<r.length;t++)a(l).setSelection(r[t],
false)}else r&&a(l).setSelection(r,false)},1E3);break}a.isFunction(c.afterRefresh)&&c.afterRefresh();return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});n=null}n=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid ui-widget ui-widget-content' style='font-size:"+n+";visibility:hidden;' ></div>");n=a(o).clone().appendTo("#testpg2").width();a("#testpg2").remove();a("#"+m+"_"+c.position,"#"+m).append(o);
if(l.p._nvtd){if(n>l.p._nvtd[0]){a("#"+m+"_"+c.position,"#"+m).width(n);l.p._nvtd[0]=n}l.p._nvtd[1]=n}}})},navButtonAdd:function(d,c){c=a.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},c||{});return this.each(function(){if(this.grid){if(d.indexOf("#")!=0)d="#"+d;var f=a(".navtable",d)[0];if(f){var g=a("<td></td>");a(g).addClass("ui-pg-button ui-corner-all").append("<div class='ui-pg-div'>"+c.caption+"</div>");c.id&&a(g).attr("id",
c.id);if(c.position=="first")f.rows[0].cells.length===0?a("tr",f).append(g):a("tr td:eq(0)",f).before(g);else a("tr",f).append(g);a(g,f).attr("title",c.title||"").click(function(){a.isFunction(c.onClickButton)&&c.onClickButton();return false}).hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).css("cursor",c.cursor?c.cursor:"normal")}}})},navSeparatorAdd:function(d,c){c=a.extend({sepclass:"ui-separator",sepcontent:""},c||{});return this.each(function(){if(this.grid){if(d.indexOf("#")!=
0)d="#"+d;var f=a(".navtable",d)[0];if(f){var g="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+c.sepclass+"'></span>"+c.sepcontent+"</td>";a("tr",f).append(g)}}})},GridToForm:function(d,c){return this.each(function(){if(this.grid){var f=a(this).getRowData(d);if(f)for(var g in f)a("[name="+g+"]",c).is("input:radio")||a("[name="+g+"]",c).is("input:checkbox")?a("[name="+g+"]",c).each(function(){a(this).val()==f[g]?a(this).attr("checked","checked"):a(this).attr("checked",
"")}):a("[name="+g+"]",c).val(f[g])}})},FormToGrid:function(d,c,f,g){return this.each(function(){if(this.grid){f||(f="set");g||(g="first");var h=a(c).serializeArray(),j={};a.each(h,function(k,e){j[e.name]=e.value});if(f=="add")a(this).addRowData(d,j,g);else f=="set"&&a(this).setRowData(d,j)}})}})})(jQuery);
(function(a){a.fn.extend({editRow:function(b,d,c,f,g,h,j,k,e){return this.each(function(){var l=this,o,m,n=0,q=null,r={},t,v;if(l.grid){t=a(l).getInd(b,true);if(t!=false)if((a(t).attr("editable")||"0")=="0"){v=l.p.colModel;a("td",t).each(function(w){o=v[w].name;var z=l.p.treeGrid===true&&o==l.p.ExpandColumn;if(z)m=a("span:first",this).html();else try{m=a.unformat(this,{colModel:v[w]},w)}catch(B){m=a(this).html()}if(o!="cb"&&o!="subgrid"&&o!="rn"){r[o]=m;if(v[w].editable===true){if(q===null)q=w;z?
a("span:first",this).html(""):a(this).html("");var p=a.extend({},v[w].editoptions||{},{id:b+"_"+o,name:o});if(!v[w].edittype)v[w].edittype="text";p=createEl(v[w].edittype,p,m,true);a(p).addClass("editable");z?a("span:first",this).append(p):a(this).append(p);v[w].edittype=="select"&&v[w].editoptions.multiple===true&&a.browser.msie&&a(p).width(a(p).width());n++}}});if(n>0){r.id=b;l.p.savedRow.push(r);a(t).attr("editable","1");a("td:eq("+q+") input",t).focus();d===true&&a(t).bind("keydown",function(w){w.keyCode===
27&&a(l).restoreRow(b,e);if(w.keyCode===13){a(l).saveRow(b,f,g,h,j,k,e);return false}w.stopPropagation()});a.isFunction(c)&&c(b)}}}})},saveRow:function(b,d,c,f,g,h,j){return this.each(function(){var k=this,e,l={},o={},m,n,q,r;if(k.grid){r=a(k).getInd(b,true);if(r!=false){m=a(r).attr("editable");c=c?c:k.p.editurl;if(m==="1"&&c){var t;a("td",r).each(function(z){t=k.p.colModel[z];e=t.name;if(e!="cb"&&e!="subgrid"&&t.editable===true&&e!="rn"){switch(t.edittype){case "checkbox":var B=["Yes","No"];if(t.editoptions)B=
t.editoptions.value.split(":");l[e]=a("input",this).attr("checked")?B[0]:B[1];break;case "text":case "password":case "textarea":case "button":l[e]=!k.p.autoencode?a("input, textarea",this).val():a.jgrid.htmlEncode(a("input, textarea",this).val());break;case "select":if(t.editoptions.multiple){B=a("select",this);var p=[];l[e]=a(B).val();l[e]=l[e]?l[e].join(","):"";a("select > option:selected",this).each(function(y,G){p[y]=a(G).text()});o[e]=p.join(",")}else{l[e]=a("select>option:selected",this).val();
o[e]=a("select>option:selected",this).text()}if(t.formatter&&t.formatter=="select")o={};break}q=checkValues(l[e],z,k);if(q[0]===false){q[1]=l[e]+" "+q[1];return false}}});if(q[0]===false)try{info_dialog(a.jgrid.errors.errcap,q[1],a.jgrid.edit.bClose)}catch(v){alert(q[1])}else{if(l){l.id=b;if(f)l=a.extend({},l,f)}if(!k.grid.hDiv.loading){k.grid.hDiv.loading=true;a("div.loading",k.grid.hDiv).fadeIn("fast");if(c=="clientArray"){l=a.extend({},l,o);m=a(k).setRowData(b,l);a(r).attr("editable","0");for(var w=
0;w<k.p.savedRow.length;w++)if(k.p.savedRow[w].id==b){n=w;break}n>=0&&k.p.savedRow.splice(n,1);a.isFunction(g)&&g(b,m)}else a.ajax({url:c,data:l,type:"POST",complete:function(z,B){if(B==="success")if((a.isFunction(d)?d(z):true)===true){l=a.extend({},l,o);a(k).setRowData(b,l);a(r).attr("editable","0");for(var p=0;p<k.p.savedRow.length;p++)if(k.p.savedRow[p].id==b){n=p;break}n>=0&&k.p.savedRow.splice(n,1);a.isFunction(g)&&g(b,z.responseText)}else a(k).restoreRow(b,j)},error:function(z,B){a.isFunction(h)?
h(b,z,B):alert("Error Row: "+b+" Result: "+z.status+":"+z.statusText+" Status: "+B)}});k.grid.hDiv.loading=false;a("div.loading",k.grid.hDiv).fadeOut("fast");a(r).unbind("keydown")}}}}}})},restoreRow:function(b,d){return this.each(function(){var c,f;if(this.grid){f=a(this).getInd(b,true);if(f!=false){for(var g=0;g<this.p.savedRow.length;g++)if(this.p.savedRow[g].id==b){c=g;break}if(c>=0){a(this).setRowData(b,this.p.savedRow[c]);a(f).attr("editable","0");this.p.savedRow.splice(c,1)}a.isFunction(d)&&
d(b)}}})}})})(jQuery);
(function(a){a.fn.extend({editCell:function(b,d,c){return this.each(function(){var f=this,g,h,j;if(!(!f.grid||f.p.cellEdit!==true)){d=parseInt(d,10);f.p.selrow=f.rows[b].id;if(f.p.savedRow.length>0){if(c===true)if(b==f.p.iRow&&d==f.p.iCol)return;g=a("td:eq("+f.p.savedRow[0].ic+")>#"+f.p.savedRow[0].id+"_"+f.p.savedRow[0].name.replace(".","\\."),f.rows[f.p.savedRow[0].id]).val();f.p.savedRow[0].v!=g?a(f).saveCell(f.p.savedRow[0].id,f.p.savedRow[0].ic):a(f).restoreCell(f.p.savedRow[0].id,f.p.savedRow[0].ic)}else window.setTimeout(function(){a("#"+
f.p.knv).attr("tabindex","-1").focus()},0);g=f.p.colModel[d].name;if(!(g=="subgrid"||g=="cb"||g=="rn")){if(f.p.colModel[d].editable===true&&c===true){j=a("td:eq("+d+")",f.rows[b]);if(parseInt(f.p.iCol)>=0&&parseInt(f.p.iRow)>=0){a("td:eq("+f.p.iCol+")",f.rows[f.p.iRow]).removeClass("edit-cell ui-state-highlight");a(f.rows[f.p.iRow]).removeClass("selected-row ui-state-hover")}a(j).addClass("edit-cell ui-state-highlight");a(f.rows[b]).addClass("selected-row ui-state-hover");try{h=a.unformat(j,{colModel:f.p.colModel[d]},
d)}catch(k){h=a(j).html()}if(!f.p.colModel[d].edittype)f.p.colModel[d].edittype="text";f.p.savedRow.push({id:b,ic:d,name:g,v:h});if(a.isFunction(f.p.formatCell)){var e=f.p.formatCell(f.rows[b].id,g,h,b,d);if(e)h=e}e=a.extend({},f.p.colModel[d].editoptions||{},{id:b+"_"+g,name:g});var l=createEl(f.p.colModel[d].edittype,e,h,true);a.isFunction(f.p.beforeEditCell)&&f.p.beforeEditCell(f.rows[b].id,g,h,b,d);a(j).html("").append(l).attr("tabindex","0");window.setTimeout(function(){a(l).focus()},0);a("input, select, textarea",
j).bind("keydown",function(o){o.keyCode===27&&a(f).restoreCell(b,d);o.keyCode===13&&a(f).saveCell(b,d);if(o.keyCode==9)o.shiftKey?a(f).prevCell(b,d):a(f).nextCell(b,d);o.stopPropagation()});a.isFunction(f.p.afterEditCell)&&f.p.afterEditCell(f.rows[b].id,g,h,b,d)}else{if(parseInt(f.p.iCol)>=0&&parseInt(f.p.iRow)>=0){a("td:eq("+f.p.iCol+")",f.rows[f.p.iRow]).removeClass("edit-cell ui-state-highlight");a(f.rows[f.p.iRow]).removeClass("selected-row ui-state-hover")}a("td:eq("+d+")",f.rows[b]).addClass("edit-cell ui-state-highlight");
a(f.rows[b]).addClass("selected-row ui-state-hover");if(a.isFunction(f.p.onSelectCell)){h=a("td:eq("+d+")",f.rows[b]).html().replace(/\&nbsp\;/ig,"");f.p.onSelectCell(f.rows[b].id,g,h,b,d)}}f.p.iCol=d;f.p.iRow=b}}})},saveCell:function(b,d){return this.each(function(){var c=this,f;if(!(!c.grid||c.p.cellEdit!==true)){f=c.p.savedRow.length>=1?0:null;if(f!=null){var g=a("td:eq("+d+")",c.rows[b]),h,j,k=c.p.colModel[d].name.replace(".","\\.");switch(c.p.colModel[d].edittype){case "select":if(c.p.colModel[d].editoptions.multiple){var e=
a("#"+b+"_"+k,c.rows[b]),l=[];if(h=a(e).val())h.join(",");else h="";a("option:selected",e).each(function(r,t){l[r]=a(t).text()});j=l.join(",")}else{h=a("#"+b+"_"+k+">option:selected",c.rows[b]).val();j=a("#"+b+"_"+k+">option:selected",c.rows[b]).text()}if(c.p.colModel[d].formatter)j=h;break;case "checkbox":e=["Yes","No"];if(c.p.colModel[d].editoptions)e=c.p.colModel[d].editoptions.value.split(":");j=h=a("#"+b+"_"+k.replace(".","\\."),c.rows[b]).attr("checked")?e[0]:e[1];break;case "password":case "text":case "textarea":case "button":j=
h=!c.p.autoencode?a("#"+b+"_"+k.replace(".","\\."),c.rows[b]).val():a.jgrid.htmlEncode(a("#"+b+"_"+k.replace(".","\\."),c.rows[b]).val());break}if(j!=c.p.savedRow[f].v){if(a.isFunction(c.p.beforeSaveCell))if(f=c.p.beforeSaveCell(c.rows[b].id,k,h,b,d))h=f;var o=checkValues(h,d,c);if(o[0]===true){f={};if(a.isFunction(c.p.beforeSubmitCell))(f=c.p.beforeSubmitCell(c.rows[b].id,k,h,b,d))||(f={});if(j=="")j=" ";if(c.p.cellsubmit=="remote")if(c.p.cellurl){var m={};m[k]=h;m.id=c.rows[b].id;m=a.extend(f,m);
a.ajax({url:c.p.cellurl,data:m,type:"POST",complete:function(r,t){if(t=="success")if(a.isFunction(c.p.afterSubmitCell)){var v=c.p.afterSubmitCell(r,m.id,k,h,b,d);if(v[0]===true){a(g).empty();a(c).setCell(c.rows[b].id,d,j);a(g).addClass("dirty-cell");a(c.rows[b]).addClass("edited");a.isFunction(c.p.afterSaveCell)&&c.p.afterSaveCell(c.rows[b].id,k,h,b,d);c.p.savedRow.splice(0,1)}else{info_dialog(a.jgrid.errors.errcap,v[1],a.jgrid.edit.bClose);a(c).restoreCell(b,d)}}else{a(g).empty();a(c).setCell(c.rows[b].id,
d,j);a(g).addClass("dirty-cell");a(c.rows[b]).addClass("edited");a.isFunction(c.p.afterSaveCell)&&c.p.afterSaveCell(c.rows[b].id,k,h,b,d);c.p.savedRow.splice(0,1)}},error:function(r,t){a.isFunction(c.p.errorCell)?c.p.errorCell(r,t):info_dialog(a.jgrid.errors.errcap,r.status+" : "+r.statusText+"<br/>"+t,a.jgrid.edit.bClose);a(c).restoreCell(b,d)}})}else try{info_dialog(a.jgrid.errors.errcap,a.jgrid.errors.nourl,a.jgrid.edit.bClose);a(c).restoreCell(b,d)}catch(n){}if(c.p.cellsubmit=="clientArray"){a(g).empty();
a(c).setCell(c.rows[b].id,d,j);a(g).addClass("dirty-cell");a(c.rows[b]).addClass("edited");a.isFunction(c.p.afterSaveCell)&&c.p.afterSaveCell(c.rows[b].id,k,h,b,d);c.p.savedRow.splice(0,1)}}else try{window.setTimeout(function(){info_dialog(a.jgrid.errors.errcap,h+" "+o[1],a.jgrid.edit.bClose)},100);a(c).restoreCell(b,d)}catch(q){}}else a(c).restoreCell(b,d)}a.browser.opera?a("#"+c.p.knv).attr("tabindex","-1").focus():window.setTimeout(function(){a("#"+c.p.knv).attr("tabindex","-1").focus()},0)}})},
restoreCell:function(b,d){return this.each(function(){var c=this,f;if(!(!c.grid||c.p.cellEdit!==true)){f=c.p.savedRow.length>=1?0:null;if(f!=null){var g=a("td:eq("+d+")",c.rows[b]);if(a.isFunction(a.fn.datepicker))try{a.datepicker("hide")}catch(h){try{a.datepicker.hideDatepicker()}catch(j){}}a(g).empty().attr("tabindex","-1");a(c).setCell(c.rows[b].id,d,c.p.savedRow[f].v);c.p.savedRow.splice(0,1)}window.setTimeout(function(){a("#"+c.p.knv).attr("tabindex","-1").focus()},0)}})},nextCell:function(b,
d){return this.each(function(){var c=false;if(!(!this.grid||this.p.cellEdit!==true)){for(var f=d+1;f<this.p.colModel.length;f++)if(this.p.colModel[f].editable===true){c=f;break}if(c!==false)a(this).editCell(b,c,true);else this.p.savedRow.length>0&&a(this).saveCell(b,d)}})},prevCell:function(b,d){return this.each(function(){var c=false;if(!(!this.grid||this.p.cellEdit!==true)){for(var f=d-1;f>=0;f--)if(this.p.colModel[f].editable===true){c=f;break}if(c!==false)a(this).editCell(b,c,true);else this.p.savedRow.length>
0&&a(this).saveCell(b,d)}})},GridNav:function(){return this.each(function(){function b(h,j,k){if(k.substr(0,1)=="v"){var e=a(c.grid.bDiv)[0].clientHeight,l=a(c.grid.bDiv)[0].scrollTop,o=c.rows[h].offsetTop+c.rows[h].clientHeight,m=c.rows[h].offsetTop;if(k=="vd")if(o>=e)a(c.grid.bDiv)[0].scrollTop=a(c.grid.bDiv)[0].scrollTop+c.rows[h].clientHeight;if(k=="vu")if(m<l)a(c.grid.bDiv)[0].scrollTop=a(c.grid.bDiv)[0].scrollTop-c.rows[h].clientHeight}if(k=="h"){k=a(c.grid.bDiv)[0].clientWidth;e=a(c.grid.bDiv)[0].scrollLeft;
l=c.rows[h].cells[j].offsetLeft;if(c.rows[h].cells[j].offsetLeft+c.rows[h].cells[j].clientWidth>=k+parseInt(e))a(c.grid.bDiv)[0].scrollLeft=a(c.grid.bDiv)[0].scrollLeft+c.rows[h].cells[j].clientWidth;else if(l<e)a(c.grid.bDiv)[0].scrollLeft=a(c.grid.bDiv)[0].scrollLeft-c.rows[h].cells[j].clientWidth}}function d(h,j){var k,e;if(j=="lft"){k=h+1;for(e=h;e>=0;e--)if(c.p.colModel[e].hidden!==true){k=e;break}}if(j=="rgt"){k=h-1;for(e=h;e<c.p.colModel.length;e++)if(c.p.colModel[e].hidden!==true){k=e;break}}return k}
var c=this;if(!(!c.grid||c.p.cellEdit!==true)){c.p.knv=a("table:first",c.grid.bDiv).attr("id")+"_kn";var f=a("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+c.p.knv+"'></span></span>"),g;a(f).insertBefore(c.grid.cDiv);a("#"+c.p.knv).focus();a("#"+c.p.knv).keydown(function(h){switch(h.keyCode){case 38:if(c.p.iRow-1>=0){b(c.p.iRow-1,c.p.iCol,"vu");a(c).editCell(c.p.iRow-1,c.p.iCol,false)}break;case 40:if(c.p.iRow+
1<=c.rows.length-1){b(c.p.iRow+1,c.p.iCol,"vd");a(c).editCell(c.p.iRow+1,c.p.iCol,false)}break;case 37:if(c.p.iCol-1>=0){g=d(c.p.iCol-1,"lft");b(c.p.iRow,g,"h");a(c).editCell(c.p.iRow,g,false)}break;case 39:if(c.p.iCol+1<=c.p.colModel.length-1){g=d(c.p.iCol+1,"rgt");b(c.p.iRow,g,"h");a(c).editCell(c.p.iRow,g,false)}break;case 13:parseInt(c.p.iCol,10)>=0&&parseInt(c.p.iRow,10)>=0&&a(c).editCell(c.p.iRow,c.p.iCol,true);break}return false})}})},getChangedCells:function(b){var d=[];b||(b="all");this.each(function(){var c=
this,f;!c.grid||c.p.cellEdit!==true||a(c.rows).each(function(){var g={};if(a(this).hasClass("edited")){a("td",this).each(function(h){f=c.p.colModel[h].name;if(f!=="cb"&&f!=="subgrid")if(b=="dirty"){if(a(this).hasClass("dirty-cell"))g[f]=a.jgrid.htmlDecode(a(this).html())}else g[f]=a.jgrid.htmlDecode(a(this).html())});g.id=this.id;d.push(g)}})});return d}})})(jQuery);
(function(a){a.fn.extend({setSubGrid:function(){return this.each(function(){var b;this.p.colNames.unshift("");this.p.colModel.unshift({name:"subgrid",width:a.browser.safari?this.p.subGridWidth+this.p.cellLayout:this.p.subGridWidth,sortable:false,resizable:false,hidedlg:true,search:false});b=this.p.subGridModel;if(b[0]){b[0].align=a.extend([],b[0].align||[]);for(i=0;i<b[0].name.length;i++)b[0].align[i]=b[0].align[i]||"left"}})},addSubGridCell:function(b,d){var c="",f;this.each(function(){c=this.formatCol(b,
d);f=this.p.gridview});return f===false?"<td role='grid' class='ui-sgcollapsed sgcollapsed' "+c+"><a href='javascript:void(0);'><span class='ui-icon ui-icon-plus'></span></a></td>":"<td role='grid' "+c+"></td>"},addSubGrid:function(b,d){return this.each(function(){var c=this;if(c.grid){var f,g,h,j,k,e,l;a("td:eq("+d+")",b).click(function(){if(a(this).hasClass("sgcollapsed")){h=c.p.id;f=a(this).parent();j=d>=1?"<td colspan='"+d+"'>&nbsp;</td>":"";g=a(f).attr("id");l=true;if(a.isFunction(c.p.subGridBeforeExpand))l=
c.p.subGridBeforeExpand(h+"_"+g,g);if(l===false)return false;k=0;a.each(c.p.colModel,function(){if(this.hidden===true||this.name=="rn"||this.name=="cb")k++});e="<tr role='row' class='ui-subgrid'>"+j+"<td><span class='ui-icon ui-icon-carat-1-sw'/></td><td colspan='"+parseInt(c.p.colNames.length-1-k)+"' class='ui-widget-content subgrid-data'><div id="+h+"_"+g+" class='tablediv'>";a(this).parent().after(e+"</div></td></tr>");a.isFunction(c.p.subGridRowExpanded)?c.p.subGridRowExpanded(h+"_"+g,g):o(f);
a(this).html("<a href='javascript:void(0);'><span class='ui-icon ui-icon-minus'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded")}else if(a(this).hasClass("sgexpanded")){l=true;if(a.isFunction(c.p.subGridRowColapsed)){f=a(this).parent();g=a(f).attr("id");l=c.p.subGridRowColapsed(h+"_"+g,g)}if(l===false)return false;a(this).parent().next().remove(".ui-subgrid");a(this).html("<a href='javascript:void(0);'><span class='ui-icon ui-icon-plus'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}return false});
var o=function(r){var t,v,w,z;t=a(r).attr("id");v={id:t,nd_:(new Date).getTime()};if(!c.p.subGridModel[0])return false;if(c.p.subGridModel[0].params)for(z=0;z<c.p.subGridModel[0].params.length;z++)for(w=0;w<c.p.colModel.length;w++)if(c.p.colModel[w].name==c.p.subGridModel[0].params[z])v[c.p.colModel[w].name]=a("td:eq("+w+")",r).text().replace(/\&nbsp\;/ig,"");if(!c.grid.hDiv.loading){c.grid.hDiv.loading=true;a("#load_"+c.p.id).show();if(!c.p.subgridtype)c.p.subgridtype=c.p.datatype;a.isFunction(c.p.subgridtype)&&
c.p.subgridtype(v);switch(c.p.subgridtype){case "xml":a.ajax({type:c.p.mtype,url:c.p.subGridUrl,dataType:"xml",data:v,complete:function(B){n(B.responseXML,t)}});break;case "json":a.ajax({type:c.p.mtype,url:c.p.subGridUrl,dataType:"text",data:v,complete:function(B){q(a.jgrid.parse(B.responseText),t)}});break}}return false},m=function(r,t,v){t=a("<td align='"+c.p.subGridModel[0].align[v]+"'></td>").html(t);a(r).append(t)},n=function(r,t){var v,w,z,B=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),
p=a("<tr></tr>");for(w=0;w<c.p.subGridModel[0].name.length;w++){v=a("<th class='ui-state-default ui-th-column'></th>");a(v).html(c.p.subGridModel[0].name[w]);a(v).width(c.p.subGridModel[0].width[w]);a(p).append(v)}a(B).append(p);if(r){z=c.p.xmlReader.subgrid;a(z.root+" "+z.row,r).each(function(){p=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(z.repeatitems===true)a(z.cell,this).each(function(G){m(p,a(this).text()||"&nbsp;",G)});else{var y=c.p.subGridModel[0].mapping||c.p.subGridModel[0].name;
if(y)for(w=0;w<y.length;w++)m(p,a(y[w],this).text()||"&nbsp;",w)}a(B).append(p)})}v=a("table:first",c.grid.bDiv).attr("id")+"_";a("#"+v+t).append(B);c.grid.hDiv.loading=false;a("#load_"+c.p.id).hide();return false},q=function(r,t){var v,w,z,B,p=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),y=a("<tr></tr>");for(w=0;w<c.p.subGridModel[0].name.length;w++){v=a("<th class='ui-state-default ui-th-column'></th>");a(v).html(c.p.subGridModel[0].name[w]);a(v).width(c.p.subGridModel[0].width[w]);
a(y).append(v)}a(p).append(y);if(r){B=c.p.jsonReader.subgrid;v=r[B.root];if(typeof v!=="undefined")for(w=0;w<v.length;w++){z=v[w];y=a("<tr class='ui-widget-content ui-subtblcell'></tr>");if(B.repeatitems===true){if(B.cell)z=z[B.cell];for(var G=0;G<z.length;G++)m(y,z[G]||"&nbsp;",G)}else{var D=c.p.subGridModel[0].mapping||c.p.subGridModel[0].name;if(D.length)for(G=0;G<D.length;G++)m(y,z[D[G]]||"&nbsp;",G)}a(p).append(y)}}w=a("table:first",c.grid.bDiv).attr("id")+"_";a("#"+w+t).append(p);c.grid.hDiv.loading=
false;a("#load_"+c.p.id).hide();return false};c.subGridXml=function(r,t){n(r,t)};c.subGridJson=function(r,t){q(r,t)}}})},expandSubGridRow:function(b){return this.each(function(){if(this.grid||b)if(this.p.subGrid===true){var d=a(this).getInd(b,true);if(d)(d=a("td.sgcollapsed",d)[0])&&a(d).trigger("click")}})},collapseSubGridRow:function(b){return this.each(function(){if(this.grid||b)if(this.p.subGrid===true){var d=a(this).getInd(b,true);if(d)(d=a("td.sgexpanded",d)[0])&&a(d).trigger("click")}})},toggleSubGridRow:function(b){return this.each(function(){if(this.grid||
b)if(this.p.subGrid===true){var d=a(this).getInd(b,true);if(d){var c=a("td.sgcollapsed",d)[0];if(c)a(c).trigger("click");else(c=a("td.sgexpanded",d)[0])&&a(c).trigger("click")}}})}})})(jQuery);
(function(a){a.fn.extend({setTreeNode:function(b,d){return this.each(function(){var c=this;if(c.grid&&c.p.treeGrid){var f=c.p.expColInd,g=c.p.treeReader.expanded_field,h=c.p.treeReader.leaf_field,j=c.p.treeReader.level_field;d.level=b[j];if(c.p.treeGridModel=="nested"){d.lft=b[c.p.treeReader.left_field];d.rgt=b[c.p.treeReader.right_field];b[h]||(b[h]=parseInt(d.rgt,10)===parseInt(d.lft,10)+1?"true":"false")}else d.parent_id=b[c.p.treeReader.parent_id_field];var k=parseInt(d.level,10),e;if(c.p.tree_root_level===
0){e=k+1;k=k}else{e=k;k=k-1}e="<div class='tree-wrap' style='width:"+e*18+"px;'>";e+="<div style='left:"+k*18+"px;' class='ui-icon ";if(b[h]=="true"||b[h]==true){e+=c.p.treeIcons.leaf+" tree-leaf'";d.isLeaf=true}else{if(b[g]=="true"||b[g]==true){e+=c.p.treeIcons.minus+" tree-minus treeclick'";d.expanded=true}else{e+=c.p.treeIcons.plus+" tree-plus treeclick'";d.expanded=false}d.isLeaf=false}e+="</div></div>";if(parseInt(b[j],10)!==parseInt(c.p.tree_root_level,10))a(c).isVisibleNode(d)||a(d).css("display",
"none");a("td:eq("+f+")",d).wrapInner("<span></span>").prepend(e);a(".treeclick",d).bind("click",function(l){l=a(l.target||l.srcElement,c.rows).parents("tr.jqgrow")[0].rowIndex;if(!c.rows[l].isLeaf)if(c.rows[l].expanded){a(c).collapseRow(c.rows[l]);a(c).collapseNode(c.rows[l])}else{a(c).expandRow(c.rows[l]);a(c).expandNode(c.rows[l])}return false});c.p.ExpandColClick===true&&a("span",d).css("cursor","pointer").bind("click",function(l){l=a(l.target||l.srcElement,c.rows).parents("tr.jqgrow")[0].rowIndex;
if(!c.rows[l].isLeaf)if(c.rows[l].expanded){a(c).collapseRow(c.rows[l]);a(c).collapseNode(c.rows[l])}else{a(c).expandRow(c.rows[l]);a(c).expandNode(c.rows[l])}a(c).setSelection(c.rows[l].id);return false})}})},setTreeGrid:function(){return this.each(function(){var b=this,d=0;if(b.p.treeGrid){b.p.treedatatype||a.extend(b.p,{treedatatype:b.p.datatype});b.p.subGrid=false;b.p.altRows=false;b.p.pgbuttons=false;b.p.pginput=false;b.p.multiselect=false;b.p.rowList=[];b.p.treeIcons=a.extend({plus:"ui-icon-triangle-1-e",
minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},b.p.treeIcons||{});if(b.p.treeGridModel=="nested")b.p.treeReader=a.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded"},b.p.treeReader);else if(b.p.treeGridModel=="adjacency")b.p.treeReader=a.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded"},b.p.treeReader);for(var c in b.p.colModel){if(b.p.colModel[c].name==b.p.ExpandColumn){b.p.expColInd=
d;break}d++}if(!b.p.expColInd)b.p.expColInd=0;a.each(b.p.treeReader,function(f,g){if(g){b.p.colNames.push(g);b.p.colModel.push({name:g,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})}})},expandRow:function(b){this.each(function(){var d=this;if(d.grid&&d.p.treeGrid){var c=a(d).getNodeChildren(b);a(c).each(function(){a(this).css("display","");this.expanded&&a(d).expandRow(this)})}})},collapseRow:function(b){this.each(function(){var d=this;if(d.grid&&d.p.treeGrid){var c=
a(d).getNodeChildren(b);a(c).each(function(){a(this).css("display","none");a(d).collapseRow(this)})}})},getRootNodes:function(){var b=[];this.each(function(){var d=this;if(d.grid&&d.p.treeGrid)switch(d.p.treeGridModel){case "nested":var c=d.p.treeReader.level_field;a(d.rows).each(function(){parseInt(this[c],10)===parseInt(d.p.tree_root_level,10)&&b.push(this)});break;case "adjacency":a(d.rows).each(function(){if(this.parent_id==null||this.parent_id.toLowerCase()=="null")b.push(this)});break}});return b},
getNodeDepth:function(b){var d=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":d=parseInt(b.level,10)-parseInt(this.p.tree_root_level,10);break;case "adjacency":d=a(this).getNodeAncestors(b).length;break}});return d},getNodeParent:function(b){var d=null;this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var c=parseInt(b.lft,10),f=parseInt(b.rgt,10),g=parseInt(b.level,10);a(this.rows).each(function(){if(parseInt(this.level,
10)===g-1&&parseInt(this.lft)<c&&parseInt(this.rgt)>f){d=this;return false}});break;case "adjacency":a(this.rows).each(function(){if(this.id==b.parent_id){d=this;return false}});break}});return d},getNodeChildren:function(b){var d=[];this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var c=parseInt(b.lft,10),f=parseInt(b.rgt,10),g=parseInt(b.level,10);a(this.rows).each(function(){parseInt(this.level,10)===g+1&&parseInt(this.lft,10)>c&&parseInt(this.rgt,10)<
f&&d.push(this)});break;case "adjacency":a(this.rows).each(function(){this.parent_id==b.id&&d.push(this)});break}});return d},getFullTreeNode:function(b){var d=[];this.each(function(){if(this.grid&&this.p.treeGrid)switch(this.p.treeGridModel){case "nested":var c=parseInt(b.lft,10),f=parseInt(b.rgt,10),g=parseInt(b.level,10);a(this.rows).each(function(){parseInt(this.level,10)>=g&&parseInt(this.lft,10)>=c&&parseInt(this.lft,10)<=f&&d.push(this)});break;case "adjacency":d.push(b);a(this.rows).each(function(h){len=
d.length;for(h=0;h<len;h++)if(d[h].id==this.parent_id){d.push(this);break}});break}});return d},getNodeAncestors:function(b){var d=[];this.each(function(){if(this.grid&&this.p.treeGrid)for(var c=a(this).getNodeParent(b);c;){d.push(c);c=a(this).getNodeParent(c)}});return d},isVisibleNode:function(b){var d=true;this.each(function(){if(this.grid&&this.p.treeGrid){var c=a(this).getNodeAncestors(b);a(c).each(function(){d=d&&this.expanded;if(!d)return false})}});return d},isNodeLoaded:function(b){var d;
this.each(function(){if(this.grid&&this.p.treeGrid)d=b.loaded!==undefined?b.loaded:b.isLeaf||a(this).getNodeChildren(b).length>0?true:false});return d},expandNode:function(b){return this.each(function(){if(this.grid&&this.p.treeGrid)if(!b.expanded)if(a(this).isNodeLoaded(b)){b.expanded=true;a("div.treeclick",b).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")}else{b.expanded=true;a("div.treeclick",b).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+
" tree-minus");this.p.treeANode=b.rowIndex;this.p.datatype=this.p.treedatatype;this.p.treeGridModel=="nested"?a(this).setGridParam({postData:{nodeid:b.id,n_left:b.lft,n_right:b.rgt,n_level:b.level}}):a(this).setGridParam({postData:{nodeid:b.id,parentid:b.parent_id,n_level:b.level}});a(this).trigger("reloadGrid");this.p.treeGridModel=="nested"?a(this).setGridParam({postData:{nodeid:"",n_left:"",n_right:"",n_level:""}}):a(this).setGridParam({postData:{nodeid:"",parentid:"",n_level:""}})}})},collapseNode:function(b){return this.each(function(){if(this.grid&&
this.p.treeGrid)if(b.expanded){b.expanded=false;a("div.treeclick",b).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(b){return this.each(function(){if(this.grid&&this.p.treeGrid){var d,c,f,g=[],h=this,j=a(this).getRootNodes();j.sort(function(k,e){if(k.sortKey<e.sortKey)return-b;if(k.sortKey>e.sortKey)return b;return 0});if(j[0]){a("td",j[0]).each(function(k){a(this).css("width",h.grid.headers[k].width+"px")});h.grid.cols=j[0].cells}d=
0;for(c=j.length;d<c;d++){f=j[d];g.push(f);a(this).collectChildrenSortTree(g,f,b)}a.each(g,function(k,e){a("tbody",h.grid.bDiv).append(e);e.sortKey=null})}})},collectChildrenSortTree:function(b,d,c){return this.each(function(){if(this.grid&&this.p.treeGrid){var f,g,h,j=a(this).getNodeChildren(d);j.sort(function(k,e){if(k.sortKey<e.sortKey)return-c;if(k.sortKey>e.sortKey)return c;return 0});f=0;for(g=j.length;f<g;f++){h=j[f];b.push(h);a(this).collectChildrenSortTree(b,h,c)}}})},setTreeRow:function(b,
d){var c=false;this.each(function(){if(this.grid&&this.p.treeGrid)c=a(this).setRowData(b,d)});return c},delTreeNode:function(b){return this.each(function(){if(this.grid&&this.p.treeGrid){var d=a(this).getInd(b,true);if(d){var c=a(this).getNodeChildren(d);if(c.length>0)for(var f=0;f<c.length;f++)a(this).delRowData(c[f].id);a(this).delRowData(d.id)}}})}})})(jQuery);
(function(a){a.fn.extend({getColProp:function(b){var d={},c=this[0];if(c.grid){c=c.p.colModel;for(var f=0;f<c.length;f++)if(c[f].name==b){d=c[f];break}return d}},setColProp:function(b,d){return this.each(function(){if(this.grid)if(d)for(var c=this.p.colModel,f=0;f<c.length;f++)if(c[f].name==b){a.extend(this.p.colModel[f],d);break}})},sortGrid:function(b,d){return this.each(function(){var c=-1;if(this.grid){if(!b)b=this.p.sortname;for(var f=0;f<this.p.colModel.length;f++)if(this.p.colModel[f].index==
b||this.p.colModel[f].name==b){c=f;break}if(c!=-1){f=this.p.colModel[c].sortable;if(typeof f!=="boolean")f=true;if(typeof d!=="boolean")d=false;f&&this.sortData("jqgh_"+b,c,d)}}})},GridDestroy:function(){return this.each(function(){if(this.grid){this.p.pager&&a(this.p.pager).remove();var b=this.id;try{a("#gbox_"+b).remove()}catch(d){}}})},GridUnload:function(){return this.each(function(){if(this.grid){var b={id:a(this).attr("id"),cl:a(this).attr("class")};this.p.pager&&a(this.p.pager).empty().removeClass("ui-state-default ui-jqgrid-pager corner-bottom");
var d=document.createElement("table");a(d).attr({id:b.id});d.className=b.cl;b=this.id;a(d).removeClass("ui-jqgrid-btable");if(a(this.p.pager).parents("#gbox_"+b).length===1){a(d).insertBefore("#gbox_"+b).show();a(this.p.pager).insertBefore("#gbox_"+b)}else a(d).insertBefore("#gbox_"+b).show();a("#gbox_"+b).remove()}})},setGridState:function(b){return this.each(function(){if(this.grid){$t=this;if(b=="hidden"){a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+$t.p.id).slideUp("fast");$t.p.pager&&a($t.p.pager).slideUp("fast");
if($t.p.toolbar[0]===true){$t.p.toolbar[1]=="both"&&a($t.grid.ubDiv).slideUp("fast");a($t.grid.uDiv).slideUp("fast")}$t.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+$s.p.id).slideUp("fast");a(".ui-jqgrid-titlebar-close span",$t.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");$t.p.gridstate="hidden"}else if(b=="visible"){a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+$t.p.id).slideDown("fast");$t.p.pager&&a($t.p.pager).slideDown("fast");if($t.p.toolbar[0]===true){$t.p.toolbar[1]==
"both"&&a($t.grid.ubDiv).slideDown("fast");a($t.grid.uDiv).slideDown("fast")}$t.p.footerrow&&a(".ui-jqgrid-sdiv","#gbox_"+$t.p.id).slideDown("fast");a(".ui-jqgrid-titlebar-close span",$t.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");$t.p.gridstate="visible"}}})},updateGridRows:function(b,d,c){var f,g=false;this.each(function(){var h=this,j,k,e,l;if(!h.grid)return false;d||(d="id");b&&b.length>0&&a(b).each(function(){e=this;if(k=h.rows.namedItem(e[d])){l=
e[d];if(c===true)if(h.p.jsonReader.repeatitems===true){if(h.p.jsonReader.cell)e=e[h.p.jsonReader.cell];for(var o=0;o<e.length;o++){j=h.formatter(l,e[o],o,e,"edit");h.p.treeGrid===true&&f==h.p.ExpandColumn?a("td:eq("+o+") > span:first",k).html(j).attr("title",a.jgrid.stripHtml(j)):a("td:eq("+o+")",k).html(j).attr("title",a.jgrid.stripHtml(j))}return g=true}a(h.p.colModel).each(function(m){f=c===true?this.jsonmap||this.name:this.name;if(e[f]!=undefined){j=h.formatter(l,e[f],m,e,"edit");h.p.treeGrid===
true&&f==h.p.ExpandColumn?a("td:eq("+m+") > span:first",k).html(j).attr("title",a.jgrid.stripHtml(j)):a("td:eq("+m+")",k).html(j).attr("title",a.jgrid.stripHtml(j));g=true}})}})});return g},filterGrid:function(b,d){d=a.extend({gridModel:false,gridNames:false,gridToolbar:false,filterModel:[],formtype:"horizontal",autosearch:true,formclass:"filterform",tableclass:"filtertable",buttonclass:"filterbutton",searchButton:"Search",clearButton:"Clear",enableSearch:false,enableClear:false,beforeSearch:null,
afterSearch:null,beforeClear:null,afterClear:null,url:"",marksearched:true},d||{});return this.each(function(){var c=this;this.p=d;if(this.p.filterModel.length==0&&this.p.gridModel===false)alert("No filter is set");else if(b){this.p.gridid=b.indexOf("#")!=-1?b:"#"+b;var f=a(this.p.gridid).getGridParam("colModel");if(f){if(this.p.gridModel===true){var g=a(this.p.gridid)[0],h;a.each(f,function(o){var m=[];this.search=this.search===false?false:true;h=this.editrules&&this.editrules.searchhidden===true?
true:this.hidden===true?false:true;if(this.search===true&&h===true){m.label=c.p.gridNames===true?g.p.colNames[o]:"";m.name=this.name;m.index=this.index||this.name;m.stype=this.edittype||"text";if(m.stype!="select")m.stype="text";m.defval=this.defval||"";m.surl=this.surl||"";m.sopt=this.editoptions||{};m.width=this.width;c.p.filterModel.push(m)}})}else a.each(c.p.filterModel,function(){for(var o=0;o<f.length;o++)if(this.name==f[o].name){this.index=f[o].index||this.name;break}if(!this.index)this.index=
this.name});var j=function(){var o={},m=0,n,q=a(c.p.gridid)[0],r;q.p.searchdata={};a.isFunction(c.p.beforeSearch)&&c.p.beforeSearch();a.each(c.p.filterModel,function(){r=this.index;switch(this.stype){case "select":if(n=a("select[name="+r+"]",c).val()){o[r]=n;c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).addClass("dirty-cell");m++}else{c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).removeClass("dirty-cell");try{delete q.p.postData[this.index]}catch(w){}}break;default:if(n=a("input[name="+
r+"]",c).val()){o[r]=n;c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).addClass("dirty-cell");m++}else{c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).removeClass("dirty-cell");try{delete q.p.postData[this.index]}catch(z){}}}});var t=m>0?true:false;a.extend(q.p.postData,o);var v;if(c.p.url){v=a(q).getGridParam("url");a(q).setGridParam({url:c.p.url})}a(q).setGridParam({search:t,page:1}).trigger("reloadGrid");v&&a(q).setGridParam({url:v});a.isFunction(c.p.afterSearch)&&c.p.afterSearch()},k=
function(){var o={},m,n=0,q=a(c.p.gridid)[0],r;a.isFunction(c.p.beforeClear)&&c.p.beforeClear();a.each(c.p.filterModel,function(){r=this.index;m=this.defval?this.defval:"";switch(this.stype){case "select":var w;a("select[name="+r+"] option",c).each(function(p){if(p==0)this.selected=true;if(a(this).text()==m){this.selected=true;w=a(this).val();return false}});if(w){o[r]=w;c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).addClass("dirty-cell");n++}else{c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).removeClass("dirty-cell");
try{delete q.p.postData[this.index]}catch(z){}}break;case "text":a("input[name="+r+"]",c).val(m);if(m){o[r]=m;c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).addClass("dirty-cell");n++}else{c.p.marksearched&&a("#jqgh_"+this.name,q.grid.hDiv).removeClass("dirty-cell");try{delete q.p.postData[this.index]}catch(B){}}break}});var t=n>0?true:false;a.extend(q.p.postData,o);var v;if(c.p.url){v=a(q).getGridParam("url");a(q).setGridParam({url:c.p.url})}a(q).setGridParam({search:t,page:1}).trigger("reloadGrid");
v&&a(q).setGridParam({url:v});a.isFunction(c.p.afterClear)&&c.p.afterClear()},e=a("<form name='SearchForm' style=display:inline;' class='"+this.p.formclass+"'></form>"),l=a("<table class='"+this.p.tableclass+"' cellspacing='0' cellpading='0' border='0'><tbody></tbody></table>");a(e).append(l);(function(){var o=document.createElement("tr"),m,n,q,r;c.p.formtype=="horizontal"&&a(l).append(o);a.each(c.p.filterModel,function(t){q=document.createElement("td");a(q).append("<label for='"+this.name+"'>"+this.label+
"</label>");r=document.createElement("td");var v=this;if(!this.stype)this.stype="text";switch(this.stype){case "select":if(this.surl)a(r).load(this.surl,function(){v.defval&&a("select",this).val(v.defval);a("select",this).attr({name:v.index||v.name,id:"sg_"+v.name});v.sopt&&a("select",this).attr(v.sopt);c.p.gridToolbar===true&&v.width&&a("select",this).width(v.width);c.p.autosearch===true&&a("select",this).change(function(){j();return false})});else if(v.sopt.value){var w=v.sopt.value,z=document.createElement("select");
a(z).attr({name:v.index||v.name,id:"sg_"+v.name}).attr(v.sopt);if(typeof w==="string"){t=w.split(";");for(var B,p=0;p<t.length;p++){w=t[p].split(":");B=document.createElement("option");B.value=w[0];B.innerHTML=w[1];if(w[1]==v.defval)B.selected="selected";z.appendChild(B)}}else if(typeof w==="object")for(p in w){t++;B=document.createElement("option");B.value=p;B.innerHTML=w[p];if(w[p]==v.defval)B.selected="selected";z.appendChild(B)}c.p.gridToolbar===true&&v.width&&a(z).width(v.width);a(r).append(z);
c.p.autosearch===true&&a(z).change(function(){j();return false})}break;case "text":z=this.defval?this.defval:"";a(r).append("<input type='text' name='"+(this.index||this.name)+"' id='sg_"+this.name+"' value='"+z+"'/>");v.sopt&&a("input",r).attr(v.sopt);if(c.p.gridToolbar===true&&v.width)a.browser.msie?a("input",r).width(v.width-4):a("input",r).width(v.width-2);c.p.autosearch===true&&a("input",r).keypress(function(y){if((y.charCode?y.charCode:y.keyCode?y.keyCode:0)==13){j();return false}return this});
break}if(c.p.formtype=="horizontal"){c.p.gridToolbar===true&&c.p.gridNames===false?a(o).append(r):a(o).append(q).append(r);a(o).append(r)}else{m=document.createElement("tr");a(m).append(q).append(r);a(l).append(m)}});r=document.createElement("td");if(c.p.enableSearch===true){n="<input type='button' id='sButton' class='"+c.p.buttonclass+"' value='"+c.p.searchButton+"'/>";a(r).append(n);a("input#sButton",r).click(function(){j();return false})}if(c.p.enableClear===true){n="<input type='button' id='cButton' class='"+
c.p.buttonclass+"' value='"+c.p.clearButton+"'/>";a(r).append(n);a("input#cButton",r).click(function(){k();return false})}if(c.p.enableClear===true||c.p.enableSearch===true)if(c.p.formtype=="horizontal")a(o).append(r);else{m=document.createElement("tr");a(m).append("<td>&nbsp;</td>").append(r);a(l).append(m)}})();a(this).append(e);this.triggerSearch=function(){j()};this.clearSearch=function(){k()}}else alert("Could not get grid colModel")}else alert("No target grid is set!")})},filterToolbar:function(b){b=
a.extend({autosearch:true,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:""},b||{});return this.each(function(){function d(l,o){var m=a(l);m[0]!=null&&jQuery.each(o,function(){this.data!=null?m.bind(this.type,this.data,this.fn):m.bind(this.type,this.fn)})}var c=this,f=function(){var l={},o=0,m,n;c.p.searchdata={};a.isFunction(b.beforeSearch)&&b.beforeSearch();a.each(c.p.colModel,function(){n=this.index||this.name;switch(this.stype){case "select":if(m=a("select[name="+
n+"]",c.grid.hDiv).val()){l[n]=m;o++}else try{delete c.p.postData[n]}catch(t){}break;case "text":if(m=a("input[name="+n+"]",c.grid.hDiv).val()){l[n]=m;o++}else try{delete c.p.postData[n]}catch(v){}break}});var q=o>0?true:false;a.extend(c.p.postData,l);var r;if(c.p.searchurl){r=c.p.url;a(c).setGridParam({url:c.p.searchurl})}a(c).setGridParam({search:q,page:1}).trigger("reloadGrid");r&&a(c).setGridParam({url:r});a.isFunction(b.afterSearch)&&b.afterSearch()},g=function(){var l={},o,m=0,n;a.isFunction(b.beforeClear)&&
b.beforeClear();a.each(c.p.colModel,function(){o=this.searchoptions&&this.searchoptions.defaultValue?this.searchoptions.defaultValue:"";n=this.index||this.name;switch(this.stype){case "select":var t;a("select[name="+n+"] option",c.grid.hDiv).each(function(z){if(z==0)this.selected=true;if(a(this).text()==o){this.selected=true;t=a(this).val();return false}});if(t){l[n]=t;m++}else try{delete c.p.postData[n]}catch(v){}break;case "text":a("input[name="+n+"]",c.grid.hDiv).val(o);if(o){l[n]=o;m++}else try{delete c.p.postData[n]}catch(w){}break}});
var q=m>0?true:false;a.extend(c.p.postData,l);var r;if(c.p.searchurl){r=c.p.url;a(c).setGridParam({url:c.p.searchurl})}a(c).setGridParam({search:q,page:1}).trigger("reloadGrid");r&&a(c).setGridParam({url:r});a.isFunction(b.afterClear)&&b.afterClear()},h=a("<tr class='ui-search-toolbar' role='rowheader'></tr>"),j,k,e;a.each(c.p.colModel,function(l){var o=this;j=a("<th role='columnheader' class='ui-state-default ui-th-column'></th>");k=a("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");
this.hidden===true&&a(j).css("display","none");this.search=this.search===false?false:true;if(typeof this.stype=="undefined")this.stype="text";e=a.extend({},this.searchoptions||{});if(this.search)switch(this.stype){case "select":if(this.surl)a(k).load(this.surl,{_nsd:(new Date).getTime()},function(){e.defaultValue&&a("select",this).val(e.defaultValue);a("select",this).attr({name:o.index||o.name,id:"gs_"+o.name});e.attr&&a("select",this).attr(e.attr);a("select",this).css({width:"100%"});e.dataInit!=
null&&e.dataInit(a("select",this)[0]);e.dataEvents!=null&&d(a("select",this)[0],e.dataEvents);b.autosearch===true&&a("select",this).change(function(){f();return false})});else if(o.editoptions&&o.editoptions.value){var m=o.editoptions.value,n=document.createElement("select");n.style.width="100%";a(n).attr({name:o.index||o.name,id:"gs_"+o.name});if(typeof m==="string"){l=m.split(";");for(var q,r=0;r<l.length;r++){m=l[r].split(":");q=document.createElement("option");q.value=m[0];q.innerHTML=m[1];n.appendChild(q)}}else if(typeof m===
"object")for(r in m){l++;q=document.createElement("option");q.value=r;q.innerHTML=m[r];n.appendChild(q)}e.defaultValue&&a(n).val(e.defaultValue);e.attr&&a(n).attr(e.attr);e.dataInit!=null&&e.dataInit(n);e.dataEvents!=null&&d(n,e.dataEvents);a(k).append(n);b.autosearch===true&&a(n).change(function(){f();return false})}break;case "text":n=e.defaultValue?e.defaultValue:"";a(k).append("<input type='text' style='width:95%;padding:0px;' name='"+(o.index||o.name)+"' id='gs_"+o.name+"' value='"+n+"'/>");
e.attr&&a("input",k).attr(e.attr);e.dataInit!=null&&e.dataInit(a("input",k)[0]);e.dataEvents!=null&&d(a("input",k)[0],e.dataEvents);b.autosearch===true&&a("input",k).keypress(function(t){if((t.charCode?t.charCode:t.keyCode?t.keyCode:0)==13){f();return false}return this});break}a(j).append(k);a(h).append(j)});a("table thead",c.grid.hDiv).append(h);this.triggerToolbar=function(){f()};this.clearToolbar=function(){g()};this.toggleToolbar=function(){var l=a("tr.ui-search-toolbar",c.grid.hDiv);l.css("display")==
"none"?l.show():l.hide()}})}})})(jQuery);
(function(a){a.fn.extend({getPostData:function(){var b=this[0];if(b.grid)return b.p.postData},setPostData:function(b){var d=this[0];if(d.grid)if(typeof b==="object")d.p.postData=b;else alert("Error: cannot add a non-object postData value. postData unchanged.")},appendPostData:function(b){var d=this[0];if(d.grid)typeof b==="object"?a.extend(d.p.postData,b):alert("Error: cannot append a non-object postData value. postData unchanged.")},setPostDataItem:function(b,d){var c=this[0];if(c.grid)c.p.postData[b]=
d},getPostDataItem:function(b){var d=this[0];if(d.grid)return d.p.postData[b]},removePostDataItem:function(b){var d=this[0];d.grid&&delete d.p.postData[b]},getUserData:function(){var b=this[0];if(b.grid)return b.p.userData},getUserDataItem:function(b){var d=this[0];if(d.grid)return d.p.userData[b]}})})(jQuery);
function tableToGrid(a,b){$(a).each(function(){if(!this.grid){$(this).width("99%");var d=$(this).width(),c=$("input[type=checkbox]:first",$(this)),f=$("input[type=radio]:first",$(this)),g=c.length>0,h=!g&&f.length>0,j=g||h;c.attr("name")||f.attr("name");var k=[],e=[];$("th",$(this)).each(function(){if(k.length==0&&j){k.push({name:"__selection__",index:"__selection__",width:0,hidden:true});e.push("__selection__")}else{k.push({name:$(this).attr("id")||$(this).html(),index:$(this).attr("id")||$(this).html(),
width:$(this).width()||150});e.push($(this).html())}});var l=[],o=[],m=[];$("tbody > tr",$(this)).each(function(){var n={},q=0;$("td",$(this)).each(function(){if(q==0&&j){var r=$("input",$(this)),t=r.attr("value");o.push(t||l.length);r.attr("checked")&&m.push(t);n[k[q].name]=r.attr("value")}else n[k[q].name]=$(this).html();q++});q>0&&l.push(n)});$(this).empty();$(this).addClass("scroll");$(this).jqGrid($.extend({datatype:"local",width:d,colNames:e,colModel:k,multiselect:g},b||{}));for(d=0;d<l.length;d++){c=
null;if(o.length>0)if((c=o[d])&&c.replace)c=encodeURIComponent(c).replace(/[.\-%]/g,"_");if(c==null)c=d+1;$(this).addRowData(c,l[d])}for(d=0;d<m.length;d++)$(this).setSelection(m[d])}})}
(function(a){a.fn.extend({setColumns:function(b){b=a.extend({top:0,left:0,width:200,height:"auto",dataheight:"auto",modal:false,drag:true,beforeShowForm:null,afterShowForm:null,afterSubmitForm:null,closeOnEscape:true,ShrinkToFit:false,jqModal:false,saveicon:[true,"left","ui-icon-disk"],closeicon:[true,"left","ui-icon-close"],onClose:null,colnameview:true,closeAfterSubmit:true,updateAfterCheck:false},a.jgrid.col,b||{});return this.each(function(){var d=this;if(d.grid){var c=typeof b.beforeShowForm===
"function"?true:false,f=typeof b.afterShowForm==="function"?true:false,g=typeof b.afterSubmitForm==="function"?true:false;if(!b.imgpath)b.imgpath=d.p.imgpath;var h=d.p.id,j="ColTbl_"+h,k={themodal:"colmod"+h,modalhead:"colhd"+h,modalcontent:"colcnt"+h,scrollelm:j};if(a("#"+k.themodal).html()!=null){c&&b.beforeShowForm(a("#"+j));viewModal("#"+k.themodal,{gbox:"#gbox_"+h,jqm:b.jqModal,jqM:false,modal:b.modal})}else{var e=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px";e="<div id='"+j+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+
e+";'>";e+="<table class='ColTable' cellspacing='1' cellpading='2' border='0'><tbody>";for(i=0;i<this.p.colNames.length;i++)d.p.colModel[i].hidedlg||(e+="<tr><td style='white-space: pre;'><input type='checkbox' style='margin-right:5px;' id='col_"+this.p.colModel[i].name+"' class='cbox' value='T' "+(this.p.colModel[i].hidden===false?"checked":"")+"/><label for='col_"+this.p.colModel[i].name+"'>"+this.p.colNames[i]+(b.colnameview?" ("+this.p.colModel[i].name+")":"")+"</label></td></tr>");e+="</tbody></table></div>";
e+="<table border='0' class='EditTable' id='"+j+"_2'><tbody><tr style='display:block;height:3px;'><td></td></tr><tr><td class='DataTD ui-widget-content'></td></tr><tr><td class='ColButton EditButton'>"+(!b.updateAfterCheck?"<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default ui-corner-all'>"+b.bSubmit+"</a>":"")+"&nbsp;"+("<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default ui-corner-all'>"+b.bCancel+"</a>")+"</td></tr></tbody></table>";b.gbox="#gbox_"+
h;createModal(k,e,b,"#gview_"+d.p.id,a("#gview_"+d.p.id)[0]);if(b.saveicon[0]==true)a("#dData","#"+j+"_2").addClass(b.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.saveicon[2]+"'></span>");if(b.closeicon[0]==true)a("#eData","#"+j+"_2").addClass(b.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+b.closeicon[2]+"'></span>");b.updateAfterCheck?a(":input","#"+j).click(function(){var l=this.id.substr(4);
if(l){this.checked?a(d).showCol(l):a(d).hideCol(l);b.ShrinkToFit===true&&a(d).setGridWidth(d.grid.width-0.0010,true)}return this}):a("#dData","#"+j+"_2").click(function(){for(i=0;i<d.p.colModel.length;i++)if(!d.p.colModel[i].hidedlg){var l=d.p.colModel[i].name.replace(".","\\.");if(a("#col_"+l,"#"+j).attr("checked")){a(d).showCol(d.p.colModel[i].name);a("#col_"+l,"#"+j).attr("defaultChecked",true)}else{a(d).hideCol(d.p.colModel[i].name);a("#col_"+l,"#"+j).attr("defaultChecked","")}}b.ShrinkToFit===
true&&a(d).setGridWidth(d.grid.width-0.0010,true);b.closeAfterSubmit&&hideModal("#"+k.themodal,{gb:"#gbox_"+h,jqm:b.jqModal,onClose:b.onClose});g&&b.afterSubmitForm(a("#"+j));return false});a("#eData","#"+j+"_2").click(function(){hideModal("#"+k.themodal,{gb:"#gbox_"+h,jqm:b.jqModal,onClose:b.onClose});return false});a("#dData, #eData","#"+j+"_2").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});c&&b.beforeShowForm(a("#"+j));viewModal("#"+k.themodal,
{gbox:"#gbox_"+h,jqm:b.jqModal,jqM:true,modal:b.modal})}f&&b.afterShowForm(a("#"+j))}})}})})(jQuery);
(function(a){a.fn.extend({jqGridImport:function(b){b=a.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"}},b||{});return this.each(function(){var d=this,c=function(h,j){var k=a(j.xmlGrid.config,h)[0],e=a(j.xmlGrid.data,h)[0];if(xmlJsonClass.xml2json&&a.jgrid.parse){k=xmlJsonClass.xml2json(k," ");k=a.jgrid.parse(k);for(var l in k)var o=k[l];if(e){e=k.grid.datatype;k.grid.datatype="xmlstring";k.grid.datastr=
h;a(d).jqGrid(o).setGridParam({datatype:e})}else a(d).jqGrid(o)}else alert("xml2json or parse are not present")},f=function(h,j){if(h&&typeof h=="string"){var k=a.jgrid.parse(h),e=k[j.jsonGrid.config];if(k=k[j.jsonGrid.data]){var l=e.datatype;e.datatype="jsonstring";e.datastr=k;a(d).jqGrid(e).setGridParam({datatype:l})}else a(d).jqGrid(e)}};switch(b.imptype){case "xml":a.ajax({url:b.impurl,type:b.mtype,data:b.impData,dataType:"xml",complete:function(h,j){if(j=="success"){c(h.responseXML,b);a.isFunction(b.importComplete)&&
b.importComplete(h)}}});break;case "xmlstring":if(b.impstring&&typeof b.impstring=="string"){var g=a.jgrid.stringToDoc(b.impstring);if(g){c(g,b);a.isFunction(b.importComplete)&&b.importComplete(g);b.impstring=null}g=null}break;case "json":a.ajax({url:b.impurl,type:b.mtype,data:b.impData,dataType:"json",complete:function(h,j){if(j=="success"){f(h.responseText,b);a.isFunction(b.importComplete)&&b.importComplete(h)}}});break;case "jsonstring":if(b.impstring&&typeof b.impstring=="string"){f(b.impstring,
b);a.isFunction(b.importComplete)&&b.importComplete(b.impstring);b.impstring=null}break}})},jqGridExport:function(b){b=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},b||{});var d=null;this.each(function(){if(this.grid){var c=a(this).getGridParam();if(c.rownumbers){c.colNames.splice(0);c.colModel.splice(0)}if(c.multiselect){c.colNames.splice(0);c.colModel.splice(0)}if(c.subgrid){c.colNames.splice(0);c.colModel.splice(0)}if(c.treeGrid)for(var f in c.treeReader){c.colNames.splice(c.colNames.length-
1);c.colModel.splice(c.colModel.length-1)}switch(b.exptype){case "xmlstring":d="<"+b.root+">"+xmlJsonClass.json2xml(c,b.ident)+"</"+b.root+">";break;case "jsonstring":d="{"+xmlJsonClass.toJson(c,b.root,b.ident)+"}";break}}});return d}})})(jQuery);
(function(a){a.fmatter={};a.fn.fmatter=function(b,d,c,f,g){c=a.extend({},a.jgrid.formatter,c);b=b;c=c;b=b.toLowerCase();f=d;if(a.fn.fmatter[b])f=a.fn.fmatter[b](d,c,g);return f};a.fmatter.util={NumberFormat:function(b,d){isNumber(b)||(b*=1);if(isNumber(b)){var c=b<0,f=b+"",g=d.decimalSeparator?d.decimalSeparator:".",h;if(isNumber(d.decimalPlaces)){var j=d.decimalPlaces;f=Math.pow(10,j);f=Math.round(b*f)/f+"";h=f.lastIndexOf(".");if(j>0){if(h<0){f+=g;h=f.length-1}else if(g!==".")f=f.replace(".",g);
for(;f.length-1-h<j;)f+="0"}}if(d.thousandsSeparator){j=d.thousandsSeparator;h=f.lastIndexOf(g);h=h>-1?h:f.length;g=f.substring(h);for(var k=-1,e=h;e>0;e--){k++;if(k%3===0&&e!==h&&(!c||e>1))g=j+g;g=f.charAt(e-1)+g}f=g}f=d.prefix?d.prefix+f:f;return f=d.suffix?f+d.suffix:f}else return b},DateFormat:function(b,d,c,f){var g=function(w,z){w=String(w);for(z=parseInt(z)||2;w.length<z;)w="0"+w;return w},h={m:1,d:1,y:1970,h:0,i:0,s:0},j=0,k,e,l=["i18n"];l.i18n={dayNames:f.dayNames,monthNames:f.monthNames};
if(b in f.masks)b=f.masks[b];d=d.split(/[\\\/:_;.\t\T\s-]/);b=b.split(/[\\\/:_;.\t\T\s-]/);k=0;for(e=b.length;k<e;k++){if(b[k]=="M"){j=a.inArray(d[k],l.i18n.monthNames);if(j!==-1&&j<12)d[k]=j+1}if(b[k]=="F"){j=a.inArray(d[k],l.i18n.monthNames);if(j!==-1&&j>11)d[k]=j+1-12}h[b[k].toLowerCase()]=parseInt(d[k],10)}h.m=parseInt(h.m)-1;j=h.y;if(j>=70&&j<=99)h.y=1900+h.y;else if(j>=0&&j<=69)h.y=2E3+h.y;j=new Date(h.y,h.m,h.d,h.h,h.i,h.s,0);if(c in f.masks)c=f.masks[c];else c||(c="Y-m-d");h=j.getHours();
b=j.getMinutes();d=j.getDate();k=j.getMonth()+1;e=j.getTimezoneOffset();var o=j.getSeconds(),m=j.getMilliseconds(),n=j.getDay(),q=j.getFullYear(),r=(n+6)%7+1,t=(new Date(q,k-1,d)-new Date(q,0,1))/864E5,v={d:g(d),D:l.i18n.dayNames[n],j:d,l:l.i18n.dayNames[n+7],N:r,S:f.S(d),w:n,z:t,W:r<5?Math.floor((t+r-1)/7)+1:Math.floor((t+r-1)/7)||(((new Date(q-1,0,1)).getDay()+6)%7<4?53:52),F:l.i18n.monthNames[k-1+12],m:g(k),M:l.i18n.monthNames[k-1],n:k,t:"?",L:"?",o:"?",Y:q,y:String(q).substring(2),a:h<12?f.AmPm[0]:
f.AmPm[1],A:h<12?f.AmPm[2]:f.AmPm[3],B:"?",g:h%12||12,G:h,h:g(h%12||12),H:g(h),i:g(b),s:g(o),u:m,e:"?",I:"?",O:(e>0?"-":"+")+g(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4),P:"?",T:(String(j).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),Z:"?",c:"?",r:"?",U:Math.floor(j/1E3)};return c.replace(/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,function(w){return w in
v?v[w]:w.substring(1)})}};a.fn.fmatter.defaultFormat=function(b,d){return isValue(b)&&b!==""?b:d.defaultValue?d.defaultValue:"&#160;"};a.fn.fmatter.email=function(b,d){return isEmpty(b)?a.fn.fmatter.defaultFormat(b,d):'<a href="mailto:'+b+'">'+b+"</a>"};a.fn.fmatter.checkbox=function(b,d){var c=a.extend({},d.checkbox);isUndefined(d.colModel.formatoptions)||(c=a.extend({},c,d.colModel.formatoptions));c=c.disabled===true?"disabled":"";b+="";b=b.toLowerCase();return'<input type="checkbox" '+(b.search(/(false|0|no|off)/i)<
0?" checked='checked' ":"")+' value="'+b+'" offval="no" '+c+"/>"};a.fn.fmatter.link=function(b,d){var c={target:d.target},f="";isUndefined(d.colModel.formatoptions)||(c=a.extend({},c,d.colModel.formatoptions));if(c.target)f="target="+c.target;return isEmpty(b)?a.fn.fmatter.defaultFormat(b,d):"<a "+f+' href="'+b+'">'+b+"</a>"};a.fn.fmatter.showlink=function(b,d){var c={baseLinkUrl:d.baseLinkUrl,showAction:d.showAction,addParam:d.addParam||"",target:d.target,idName:d.idName},f="";isUndefined(d.colModel.formatoptions)||
(c=a.extend({},c,d.colModel.formatoptions));if(c.target)f="target="+c.target;idUrl=c.baseLinkUrl+c.showAction+"?"+c.idName+"="+d.rowId+c.addParam;return isString(b)?"<a "+f+' href="'+idUrl+'">'+b+"</a>":a.fn.fmatter.defaultFormat(b,d)};a.fn.fmatter.integer=function(b,d){var c=a.extend({},d.integer);isUndefined(d.colModel.formatoptions)||(c=a.extend({},c,d.colModel.formatoptions));if(isEmpty(b))return c.defaultValue;return a.fmatter.util.NumberFormat(b,c)};a.fn.fmatter.number=function(b,d){var c=a.extend({},
d.number);isUndefined(d.colModel.formatoptions)||(c=a.extend({},c,d.colModel.formatoptions));if(isEmpty(b))return c.defaultValue;return a.fmatter.util.NumberFormat(b,c)};a.fn.fmatter.currency=function(b,d){var c=a.extend({},d.currency);isUndefined(d.colModel.formatoptions)||(c=a.extend({},c,d.colModel.formatoptions));if(isEmpty(b))return c.defaultValue;return a.fmatter.util.NumberFormat(b,c)};a.fn.fmatter.date=function(b,d,c){var f=a.extend({},d.date);isUndefined(d.colModel.formatoptions)||(f=a.extend({},
f,d.colModel.formatoptions));return!f.reformatAfterEdit&&c=="edit"?a.fn.fmatter.defaultFormat(b,d):isEmpty(b)?a.fn.fmatter.defaultFormat(b,d):a.fmatter.util.DateFormat(f.srcformat,b,f.newformat,f)};a.fn.fmatter.select=function(b,d){b||(b="");var c=false;if(!isUndefined(d.colModel.editoptions))c=d.colModel.editoptions.value;if(c){var f=[],g=d.colModel.editoptions.multiple===true?true:false,h=[],j;if(g){h=b.split(",");h=a.map(h,function(o){return a.trim(o)})}if(isString(c))for(var k=c.split(";"),e=
0,l=0;l<k.length;l++){j=k[l].split(":");if(g){if(jQuery.inArray(j[0],h)>-1){f[e]=j[1];e++}}else if(a.trim(j[0])==a.trim(b)){f[0]=j[1];break}}else if(isObject(c))if(g)f=jQuery.map(h,function(o){return c[o]});else f[0]=c[b]||"";return f.join(", ")}};a.unformat=function(b,d,c,f){var g,h=d.colModel.formatter,j=d.colModel.formatoptions||{},k=/([\.\*\_\'\(\)\{\}\+\?\\])/g;unformatFunc=d.colModel.unformat||a.fn.fmatter[h]&&a.fn.fmatter[h].unformat;if(typeof unformatFunc!=="undefined"&&isFunction(unformatFunc))g=
unformatFunc(a(b).text(),d);else if(typeof h!=="undefined"&&isString(h)){g=a.jgrid.formatter||{};switch(h){case "integer":j=a.extend({},g.integer,j);d=j.thousandsSeparator.replace(k,"\\$1");d=RegExp(d,"g");g=a(b).text().replace(d,"");break;case "number":j=a.extend({},g.number,j);d=j.thousandsSeparator.replace(k,"\\$1");d=RegExp(d,"g");g=a(b).text().replace(j.decimalSeparator,".").replace(d,"");break;case "currency":j=a.extend({},g.currency,j);d=j.thousandsSeparator.replace(k,"\\$1");d=RegExp(d,"g");
g=a(b).text().replace(j.decimalSeparator,".").replace(j.prefix,"").replace(j.suffix,"").replace(d,"");break;case "checkbox":j=d.colModel.editoptions?d.colModel.editoptions.value.split(":"):["Yes","No"];g=a("input",b).attr("checked")?j[0]:j[1];break;case "select":g=a.unformat.select(b,d,c,f);break;default:g=a(b).text();break}}return g?g:f===true?a(b).text():a.jgrid.htmlDecode(a(b).html())};a.unformat.select=function(b,d,c,f){c=[];b=a(b).text();if(f==true)return b;d=a.extend({},d.colModel.editoptions);
if(d.value){var g=d.value;d=d.multiple===true?true:false;f=[];var h;if(d){f=b.split(",");f=a.map(f,function(l){return a.trim(l)})}if(isString(g))for(var j=g.split(";"),k=0,e=0;e<j.length;e++){h=j[e].split(":");if(d){if(jQuery.inArray(h[1],f)>-1){c[k]=h[0];k++}}else if(a.trim(h[1])==a.trim(b)){c[0]=h[0];break}}else if(isObject(g)){d||(f[0]=b);c=jQuery.map(f,function(l){var o;a.each(g,function(m,n){if(n==l){o=m;return false}});if(o)return o})}return c.join(", ")}else return b||""};isValue=function(b){return isObject(b)||
isString(b)||isNumber(b)||isBoolean(b)};isBoolean=function(b){return typeof b==="boolean"};isNull=function(b){return b===null};isNumber=function(b){return typeof b==="number"&&isFinite(b)};isString=function(b){return typeof b==="string"};isEmpty=function(b){if(!isString(b)&&isValue(b))return false;else if(!isValue(b))return true;b=a.trim(b).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return b===""};isUndefined=function(b){return typeof b==="undefined"};isObject=function(b){return b&&(typeof b===
"object"||isFunction(b))||false};isFunction=function(b){return typeof b==="function"}})(jQuery);
var xmlJsonClass={xml2json:function(a,b){if(a.nodeType===9)a=a.documentElement;var d=this.toJson(this.toObj(this.removeWhite(a)),a.nodeName,"\t");return"{\n"+b+(b?d.replace(/\t/g,b):d.replace(/\t|\n/g,""))+"\n}"},json2xml:function(a,b){var d=function(g,h,j){var k="",e,l;if(g instanceof Array)if(g.length===0)k+=j+"<"+h+">__EMPTY_ARRAY_</"+h+">\n";else{e=0;for(l=g.length;e<l;e+=1){var o=j+d(g[e],h,j+"\t")+"\n";k+=o}}else if(typeof g==="object"){e=false;k+=j+"<"+h;for(l in g)if(g.hasOwnProperty(l))if(l.charAt(0)===
"@")k+=" "+l.substr(1)+'="'+g[l].toString()+'"';else e=true;k+=e?">":"/>";if(e){for(l in g)if(g.hasOwnProperty(l))if(l==="#text")k+=g[l];else if(l==="#cdata")k+="<![CDATA["+g[l]+"]]\>";else if(l.charAt(0)!=="@")k+=d(g[l],l,j+"\t");k+=(k.charAt(k.length-1)==="\n"?j:"")+"</"+h+">"}}else k+=typeof g==="function"?j+"<"+h+"><![CDATA["+g+"]]\></"+h+">":g.toString()==='""'||g.toString().length===0?j+"<"+h+">__EMPTY_STRING_</"+h+">":j+"<"+h+">"+g.toString()+"</"+h+">";return k},c="",f;for(f in a)if(a.hasOwnProperty(f))c+=
d(a[f],f,"");return b?c.replace(/\t/g,b):c.replace(/\t|\n/g,"")},toObj:function(a){var b={},d=/function/i;if(a.nodeType===1){if(a.attributes.length){var c;for(c=0;c<a.attributes.length;c+=1)b["@"+a.attributes[c].nodeName]=(a.attributes[c].nodeValue||"").toString()}if(a.firstChild){var f=c=0,g=false,h;for(h=a.firstChild;h;h=h.nextSibling)if(h.nodeType===1)g=true;else if(h.nodeType===3&&h.nodeValue.match(/[^ \f\n\r\t\v]/))c+=1;else if(h.nodeType===4)f+=1;if(g)if(c<2&&f<2){this.removeWhite(a);for(h=
a.firstChild;h;h=h.nextSibling)if(h.nodeType===3)b["#text"]=this.escape(h.nodeValue);else if(h.nodeType===4)if(d.test(h.nodeValue))b[h.nodeName]=[b[h.nodeName],h.nodeValue];else b["#cdata"]=this.escape(h.nodeValue);else if(b[h.nodeName])if(b[h.nodeName]instanceof Array)b[h.nodeName][b[h.nodeName].length]=this.toObj(h);else b[h.nodeName]=[b[h.nodeName],this.toObj(h)];else b[h.nodeName]=this.toObj(h)}else if(a.attributes.length)b["#text"]=this.escape(this.innerXml(a));else b=this.escape(this.innerXml(a));
else if(c)if(a.attributes.length)b["#text"]=this.escape(this.innerXml(a));else{b=this.escape(this.innerXml(a));if(b==="__EMPTY_ARRAY_")b="[]";else if(b==="__EMPTY_STRING_")b=""}else if(f)if(f>1)b=this.escape(this.innerXml(a));else for(h=a.firstChild;h;h=h.nextSibling)if(d.test(a.firstChild.nodeValue)){b=a.firstChild.nodeValue;break}else b["#cdata"]=this.escape(h.nodeValue)}if(!a.attributes.length&&!a.firstChild)b=null}else if(a.nodeType===9)b=this.toObj(a.documentElement);else alert("unhandled node type: "+
a.nodeType);return b},toJson:function(a,b,d){var c=b?'"'+b+'"':"";if(a==="[]")c+=b?":[]":"[]";else if(a instanceof Array){var f,g;g=0;for(f=a.length;g<f;g+=1)a[g]=this.toJson(a[g],"",d+"\t");c+=(b?":[":"[")+(a.length>1?"\n"+d+"\t"+a.join(",\n"+d+"\t")+"\n"+d:a.join(""))+"]"}else if(a===null)c+=(b&&":")+"null";else if(typeof a==="object"){f=[];for(g in a)if(a.hasOwnProperty(g))f[f.length]=this.toJson(a[g],g,d+"\t");c+=(b?":{":"{")+(f.length>1?"\n"+d+"\t"+f.join(",\n"+d+"\t")+"\n"+d:f.join(""))+"}"}else if(typeof a===
"string"){d=/function/i;a=a.toString();c+=/(^-?\d+\.?\d*$)/.test(a)||d.test(a)||a==="false"||a==="true"?(b&&":")+a:(b&&":")+'"'+a+'"'}else c+=(b&&":")+a.toString();return c},innerXml:function(a){var b="";if("innerHTML"in a)b=a.innerHTML;else{var d=function(c){var f="",g;if(c.nodeType===1){f+="<"+c.nodeName;for(g=0;g<c.attributes.length;g+=1)f+=" "+c.attributes[g].nodeName+'="'+(c.attributes[g].nodeValue||"").toString()+'"';if(c.firstChild){f+=">";for(g=c.firstChild;g;g=g.nextSibling)f+=d(g);f+="</"+
c.nodeName+">"}else f+="/>"}else if(c.nodeType===3)f+=c.nodeValue;else if(c.nodeType===4)f+="<![CDATA["+c.nodeValue+"]]\>";return f};for(a=a.firstChild;a;a=a.nextSibling)b+=d(a)}return b},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(a){a.normalize();var b;for(b=a.firstChild;b;)if(b.nodeType===3)if(b.nodeValue.match(/[^ \f\n\r\t\v]/))b=b.nextSibling;else{var d=b.nextSibling;a.removeChild(b);b=d}else{b.nodeType===
1&&this.removeWhite(b);b=b.nextSibling}return a}};
jQuery.fn.searchFilter=function(a,b){return new (function(d,c,f){this.$=d;this.add=function(p){p==null?d.find(".ui-add-last").click():d.find(".sf:eq("+p+") .ui-add").click();return this};this.del=function(p){p==null?d.find(".sf:last .ui-del").click():d.find(".sf:eq("+p+") .ui-del").click();return this};this.search=function(){d.find(".ui-search").click();return this};this.reset=function(){d.find(".ui-reset").click();return this};this.close=function(){d.find(".ui-closer").click();return this};if(c!=
null){var g=function(){jQuery(this).toggleClass("ui-state-hover");return false},h=function(p){jQuery(this).toggleClass("ui-state-active",p.type=="mousedown");return false},j=function(p,y){return"<option value='"+p+"'>"+y+"</option>"},k=function(p,y,G){return"<select class='"+p+"'"+(G?" style='display:none;'":"")+">"+y+"</select>"},e=function(p,y){var G=d.find("tr.sf td.data "+p);G[0]!=null&&y(G)},l=function(p,y){var G=d.find("tr.sf td.data "+p);G[0]!=null&&jQuery.each(y,function(){this.data!=null?
G.bind(this.type,this.data,this.fn):G.bind(this.type,this.fn)})},o=jQuery.extend({},jQuery.fn.searchFilter.defaults,f),m=-1,n="";jQuery.each(o.groupOps,function(){n+=j(this.op,this.text)});n="<select name='groupOp'>"+n+"</select>";d.html("").addClass("ui-searchFilter").append("<div class='ui-widget-overlay' style='z-index: -1'>&nbsp;</div><table class='ui-widget-content ui-corner-all'><thead><tr><td colspan='5' class='ui-widget-header ui-corner-all' style='line-height: 18px;'><div class='ui-closer ui-state-default ui-corner-all ui-helper-clearfix' style='float: right;'><span class='ui-icon ui-icon-close'></span></div>"+
o.windowTitle+"</td></tr></thead><tbody><tr class='sf'><td class='fields'></td><td class='ops'></td><td class='data'></td><td><div class='ui-del ui-state-default ui-corner-all'><span class='ui-icon ui-icon-minus'></span></div></td><td><div class='ui-add ui-state-default ui-corner-all'><span class='ui-icon ui-icon-plus'></span></div></td></tr><tr><td colspan='5' class='divider'><div>&nbsp;</div></td></tr></tbody><tfoot><tr><td colspan='3'><span class='ui-reset ui-state-default ui-corner-all' style='display: inline-block; float: left;'><span class='ui-icon ui-icon-arrowreturnthick-1-w' style='float: left;'></span><span style='line-height: 18px; padding: 0 7px 0 3px;'>"+
o.resetText+"</span></span><span class='ui-search ui-state-default ui-corner-all' style='display: inline-block; float: right;'><span class='ui-icon ui-icon-search' style='float: left;'></span><span style='line-height: 18px; padding: 0 7px 0 3px;'>"+o.searchText+"</span></span><span class='matchText'>"+o.matchText+"</span> "+n+" <span class='rulesText'>"+o.rulesText+"</span></td><td>&nbsp;</td><td><div class='ui-add-last ui-state-default ui-corner-all'><span class='ui-icon ui-icon-plusthick'></span></div></td></tr></tfoot></table>");
f=d.find("tr.sf");var q=f.find("td.fields"),r=f.find("td.ops"),t=f.find("td.data"),v="";jQuery.each(o.operators,function(){v+=j(this.op,this.text)});v=k("default",v,true);r.append(v);t.append("<input type='text' class='default' style='display:none;' />");var w="",z=false,B=false;jQuery.each(c,function(p){w+=j(this.value,this.text);if(this.ops!=null){z=true;var y="";jQuery.each(this.ops,function(){y+=j(this.op,this.text)});y=k("field"+p,y,true);r.append(y)}if(this.dataUrl!=null){if(p>m)m=p;B=true;
var G=this.dataEvents,D=this.dataInit;jQuery.get(this.dataUrl,function(Y){Y=jQuery("<div />").append(Y);Y.find("select").addClass("field"+p).hide();t.append(Y.html());D&&e(".field"+p,D);G&&l(".field"+p,G);p==m&&d.find("tr.sf td.fields select[name='field']").change()})}else if(this.dataValues!=null){B=true;var Q="";jQuery.each(this.dataValues,function(){Q+=j(this.value,this.text)});Q=k("field"+p,Q,true);t.append(Q)}else if(this.dataEvents!=null||this.dataInit!=null){B=true;Q="<input type='text' class='field"+
p+"' />";t.append(Q)}this.dataInit!=null&&p!=m&&e(".field"+p,this.dataInit);this.dataEvents!=null&&p!=m&&l(".field"+p,this.dataEvents)});w="<select name='field'>"+w+"</select>";q.append(w);c=q.find("select[name='field']");z?c.change(function(p){var y=p.target.selectedIndex;p=jQuery(p.target).parents("tr.sf").find("td.ops");p.find("select").removeAttr("name").hide();y=p.find(".field"+y);if(y[0]==null)y=p.find(".default");y.attr("name","op").show()}):r.find(".default").attr("name","op").show();B?c.change(function(p){var y=
p.target.selectedIndex;p=jQuery(p.target).parents("tr.sf").find("td.data");p.find("select,input").removeAttr("name").hide();y=p.find(".field"+y);if(y[0]==null)y=p.find(".default");y.attr("name","data").show()}):t.find(".default").attr("name","data").show();if(z||B)c.change();d.find(".ui-state-default").hover(g,g).mousedown(h).mouseup(h);d.find(".ui-closer").click(function(){o.onClose(jQuery(d.selector));return false});d.find(".ui-del").click(function(p){p=jQuery(p.target).parents(".sf");if(p.siblings(".sf").length>
0){o.datepickerFix===true&&jQuery.fn.datepicker!==undefined&&p.find(".hasDatepicker").datepicker("destroy");p.remove()}else{p.find("select[name='field']")[0].selectedIndex=0;p.find("select[name='op']")[0].selectedIndex=0;p.find(".data input").val("");p.find(".data select").each(function(){this.selectedIndex=0});p.find("select[name='field']").change()}return false});d.find(".ui-add").click(function(p){p=jQuery(p.target).parents(".sf");var y=p.clone(true).insertAfter(p);y.find(".ui-state-default").removeClass("ui-state-hover ui-state-active");
if(o.clone){y.find("select[name='field']")[0].selectedIndex=p.find("select[name='field']")[0].selectedIndex;if(y.find("select[name='op']")[0]!=null)y.find("select[name='op']").focus()[0].selectedIndex=p.find("select[name='op']")[0].selectedIndex;var G=y.find("select[name='data']");if(G[0]!=null)G[0].selectedIndex=p.find("select[name='data']")[0].selectedIndex}else{y.find(".data input").val("");y.find("select[name='field']").focus()}o.datepickerFix===true&&jQuery.fn.datepicker!==undefined&&p.find(".hasDatepicker").each(function(){var D=
jQuery.data(this,"datepicker").settings;y.find("#"+this.id).unbind().removeAttr("id").removeClass("hasDatepicker").datepicker(D)});y.find("select[name='field']").change();return false});d.find(".ui-search").click(function(){var p=jQuery(d.selector),y,G=p.find("select[name='groupOp'] :selected").val();y=o.stringResult?'{"groupOp":"'+G+'","rules":[':{groupOp:G,rules:[]};p.find(".sf").each(function(D){var Q=jQuery(this).find("select[name='field'] :selected").val(),Y=jQuery(this).find("select[name='op'] :selected").val(),
aa=jQuery(this).find("input[name='data'],select[name='data'] :selected").val();if(o.stringResult){if(D>0)y+=",";y+='{"field":"'+Q+'",';y+='"op":"'+Y+'",';y+='"data":"'+aa+'"}'}else y.rules.push({field:Q,op:Y,data:aa})});if(o.stringResult)y+="]}";o.onSearch(y);return false});d.find(".ui-reset").click(function(){var p=jQuery(d.selector);p.find(".ui-del").click();p.find("select[name='groupOp']")[0].selectedIndex=0;o.onReset();return false});d.find(".ui-add-last").click(function(){var p=jQuery(d.selector+
" .sf:last"),y=p.clone(true).insertAfter(p);y.find(".ui-state-default").removeClass("ui-state-hover ui-state-active");y.find(".data input").val("");y.find("select[name='field']").focus();o.datepickerFix===true&&jQuery.fn.datepicker!==undefined&&p.find(".hasDatepicker").each(function(){var G=jQuery.data(this,"datepicker").settings;y.find("#"+this.id).unbind().removeAttr("id").removeClass("hasDatepicker").datepicker(G)});y.find("select[name='field']").change();return false})}})(this,a,b)};
jQuery.fn.searchFilter.version="1.2.9";
jQuery.fn.searchFilter.defaults={clone:true,datepickerFix:true,onReset:function(a){alert("Reset Clicked. Data Returned: "+a)},onSearch:function(a){alert("Search Clicked. Data Returned: "+a)},onClose:function(a){a.hide()},groupOps:[{op:"AND",text:"all"},{op:"OR",text:"any"}],operators:[{op:"eq",text:"is equal to"},{op:"ne",text:"is not equal to"},{op:"lt",text:"is less than"},{op:"le",text:"is less or equal to"},{op:"gt",text:"is greater than"},{op:"ge",text:"is greater or equal to"},{op:"in",text:"is in"},
{op:"ni",text:"is not in"},{op:"bw",text:"begins with"},{op:"bn",text:"does not begin with"},{op:"ew",text:"ends with"},{op:"en",text:"does not end with"},{op:"cn",text:"contains"},{op:"nc",text:"does not contain"}],matchText:"match",rulesText:"rules",resetText:"Reset",searchText:"Search",stringResult:true,windowTitle:"Search Rules"};
(function(){var a=false,b=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(d){function c(){!a&&this.init&&this.init.apply(this,arguments)}var f=this.prototype;a=true;var g=new this;a=false;for(var h in d)g[h]=typeof d[h]=="function"&&typeof f[h]=="function"&&b.test(d[h])?function(j,k){return function(){var e=this._super;this._super=f[j];var l=k.apply(this,arguments);this._super=e;return l}}(h,d[h]):d[h];c.prototype=g;c.constructor=c;c.extend=arguments.callee;
return c}})();
(function(a){function b(c){var f;if(c&&c.constructor==Array&&c.length==3)return c;if(f=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return[parseInt(f[1]),parseInt(f[2]),parseInt(f[3])];if(f=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return[parseFloat(f[1])*2.55,parseFloat(f[2])*2.55,parseFloat(f[3])*2.55];if(f=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return[parseInt(f[1],16),parseInt(f[2],
16),parseInt(f[3],16)];if(f=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)];return d[a.trim(c).toLowerCase()]}a.each(["backgroundColor","borderColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(c,f){a.fx.step[f]=function(g){if(g.state==0){var h;h=g.elem;var j=f,k;do{k=a.curCSS(h,j);if(k!=""&&k!="transparent"||a.nodeName(h,"body"))break;j="backgroundColor"}while(h=
h.parentNode);h=b(k);g.start=h;g.end=b(g.end)}g.elem.style[f]="rgb("+[Math.max(Math.min(parseInt(g.pos*(g.end[0]-g.start[0])+g.start[0]),255),0),Math.max(Math.min(parseInt(g.pos*(g.end[1]-g.start[1])+g.start[1]),255),0),Math.max(Math.min(parseInt(g.pos*(g.end[2]-g.start[2])+g.start[2]),255),0)].join(",")+")"}});var d={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],
darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,
0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,d,c,f){return jQuery.easing[jQuery.easing.def](a,b,d,c,f)},easeInQuad:function(a,b,d,c,f){return c*(b/=f)*b+d},easeOutQuad:function(a,b,d,c,f){return-c*(b/=f)*(b-2)+d},easeInOutQuad:function(a,b,d,c,f){if((b/=f/2)<1)return c/2*b*b+d;return-c/2*(--b*(b-2)-1)+d},easeInCubic:function(a,b,d,c,f){return c*(b/=f)*b*b+d},easeOutCubic:function(a,b,d,c,f){return c*((b=b/f-1)*b*b+1)+d},easeInOutCubic:function(a,b,d,c,f){if((b/=f/2)<1)return c/
2*b*b*b+d;return c/2*((b-=2)*b*b+2)+d},easeInQuart:function(a,b,d,c,f){return c*(b/=f)*b*b*b+d},easeOutQuart:function(a,b,d,c,f){return-c*((b=b/f-1)*b*b*b-1)+d},easeInOutQuart:function(a,b,d,c,f){if((b/=f/2)<1)return c/2*b*b*b*b+d;return-c/2*((b-=2)*b*b*b-2)+d},easeInQuint:function(a,b,d,c,f){return c*(b/=f)*b*b*b*b+d},easeOutQuint:function(a,b,d,c,f){return c*((b=b/f-1)*b*b*b*b+1)+d},easeInOutQuint:function(a,b,d,c,f){if((b/=f/2)<1)return c/2*b*b*b*b*b+d;return c/2*((b-=2)*b*b*b*b+2)+d},easeInSine:function(a,
b,d,c,f){return-c*Math.cos(b/f*(Math.PI/2))+c+d},easeOutSine:function(a,b,d,c,f){return c*Math.sin(b/f*(Math.PI/2))+d},easeInOutSine:function(a,b,d,c,f){return-c/2*(Math.cos(Math.PI*b/f)-1)+d},easeInExpo:function(a,b,d,c,f){return b==0?d:c*Math.pow(2,10*(b/f-1))+d},easeOutExpo:function(a,b,d,c,f){return b==f?d+c:c*(-Math.pow(2,-10*b/f)+1)+d},easeInOutExpo:function(a,b,d,c,f){if(b==0)return d;if(b==f)return d+c;if((b/=f/2)<1)return c/2*Math.pow(2,10*(b-1))+d;return c/2*(-Math.pow(2,-10*--b)+2)+d},
easeInCirc:function(a,b,d,c,f){return-c*(Math.sqrt(1-(b/=f)*b)-1)+d},easeOutCirc:function(a,b,d,c,f){return c*Math.sqrt(1-(b=b/f-1)*b)+d},easeInOutCirc:function(a,b,d,c,f){if((b/=f/2)<1)return-c/2*(Math.sqrt(1-b*b)-1)+d;return c/2*(Math.sqrt(1-(b-=2)*b)+1)+d},easeInElastic:function(a,b,d,c,f){a=1.70158;var g=0,h=c;if(b==0)return d;if((b/=f)==1)return d+c;g||(g=f*0.3);if(h<Math.abs(c)){h=c;a=g/4}else a=g/(2*Math.PI)*Math.asin(c/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin((b*f-a)*2*Math.PI/g))+d},easeOutElastic:function(a,
b,d,c,f){a=1.70158;var g=0,h=c;if(b==0)return d;if((b/=f)==1)return d+c;g||(g=f*0.3);if(h<Math.abs(c)){h=c;a=g/4}else a=g/(2*Math.PI)*Math.asin(c/h);return h*Math.pow(2,-10*b)*Math.sin((b*f-a)*2*Math.PI/g)+c+d},easeInOutElastic:function(a,b,d,c,f){a=1.70158;var g=0,h=c;if(b==0)return d;if((b/=f/2)==2)return d+c;g||(g=f*0.3*1.5);if(h<Math.abs(c)){h=c;a=g/4}else a=g/(2*Math.PI)*Math.asin(c/h);if(b<1)return-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*f-a)*2*Math.PI/g)+d;return h*Math.pow(2,-10*(b-=1))*Math.sin((b*
f-a)*2*Math.PI/g)*0.5+c+d},easeInBack:function(a,b,d,c,f,g){if(g==undefined)g=1.70158;return c*(b/=f)*b*((g+1)*b-g)+d},easeOutBack:function(a,b,d,c,f,g){if(g==undefined)g=1.70158;return c*((b=b/f-1)*b*((g+1)*b+g)+1)+d},easeInOutBack:function(a,b,d,c,f,g){if(g==undefined)g=1.70158;if((b/=f/2)<1)return c/2*b*b*(((g*=1.525)+1)*b-g)+d;return c/2*((b-=2)*b*(((g*=1.525)+1)*b+g)+2)+d},easeInBounce:function(a,b,d,c,f){return c-jQuery.easing.easeOutBounce(a,f-b,0,c,f)+d},easeOutBounce:function(a,b,d,c,f){return(b/=
f)<1/2.75?c*7.5625*b*b+d:b<2/2.75?c*(7.5625*(b-=1.5/2.75)*b+0.75)+d:b<2.5/2.75?c*(7.5625*(b-=2.25/2.75)*b+0.9375)+d:c*(7.5625*(b-=2.625/2.75)*b+0.984375)+d},easeInOutBounce:function(a,b,d,c,f){if(b<f/2)return jQuery.easing.easeInBounce(a,b*2,0,c,f)*0.5+d;return jQuery.easing.easeOutBounce(a,b*2-f,0,c,f)*0.5+c*0.5+d}});
function equaliseHeight(a){if($(".content_filter",a).length!=0){$(".ui-jqgrid",a).height("auto");var b=$(".content_filter",a).height(),d=$(".ui-jqgrid",a).height();b>d&&$(".ui-jqgrid",a).height(b)}}function getFilterByField(a){if(a==undefined)return $.trim($("#filterBy").html());return $.trim($("#filterBy",a).html())}function setFilterByField(a,b){b==undefined&&$("#filterBy").html(a);$("#filterBy",b).html(a)}
function getMatchingFilterButton(a,b){if(b==="")return $(a).find("div:first");var d="div[fid='"+b+"']";d=$(a).find(d);if(d.length!==1)d=$(a).find("div:first");return d}function init_jqgrids(a){$("#jqgh_total,#jqgh_subtotal,#jqgh_costPrice,#jqgh_groupprice").addClass("ar");$("#jqgh_status,#jqgh_supplierInStock,#jqgh_orderDate,#jqgh_favTotal,#jqgh_hits,#jqgh_invtotal").addClass("ac");equaliseHeight(a)}
function sideSelector_render(a,b,d,c,f,g,h){if(h){$("#sideSelected",b).children().length==0&&$("#sideSelected",b).append("<h4>selected</h4>");if($("#sideSelected > .entry[alt="+g+"]",b).length==0){d="<div class='entry' alt='"+g+"'><span class='thm'><img src='"+d+"'/></span><span class='title' title='"+f+"'>"+c+"</span><span class='icon'><span class='delIcon'></span></span></div>";$("#sideSelected",b).append(d);$("#sideSelected",b).slideDown()}}else{d=$("#sideSelected .entry[alt="+g+"]",b);if(d.length!=
0){$(a,b).find("tr[id="+g+"]").removeClass("selected");$(d).fadeOut("fast",function(){$(this).remove();$("#sideSelected",b).children().length==1&&$("#sideSelected",b).slideUp()})}}}function sideSelector_delete(a,b){$("#sideSelected .entry[alt='"+a+"']",b).slideUp("fast",function(){$(this).remove();$("#sideSelected",b).children().length==1&&$("#sideSelected",b).slideUp()})}
function sideSelector_bindDelete(a){$("#sideSelected .delIcon").live("click",function(){var b=$(this).parents(".entry").attr("alt");$(this).parents(".entry").fadeOut("fast",function(){$(this).remove();$(a).find("tr[id="+b+"] input:checkbox").attr("checked",false);$(a).find("tr[id="+b+"]").removeClass("selected-row");$("#sideSelected").children().length==1&&$("#sideSelected").slideUp()})})}function getContactTypeFilter(){return $.trim($("#filterByType").html())}
function setContactTypeFilter(a){$("#filterByType").html(a)}function reloadContactsGrid(){$("#contactsGridView").setGridParam({url:"/dashboard/contacts/grid",postData:{cat:$("#ContactFilterBy").val(),type:$("#ContactFilterByType").val(),letter:$("#ContactFilterByLetter").val(),term:$("#ContactsSearchBox").val()}});$("#contactsGridView").trigger("reloadGrid")}
function contactBindToGrid(){var a=function(b){b.toggleClass("selected-row")};$("#contactsGridView").jqGrid({afterInsertRow:function(b,d){var c=d.firstName.split(","),f=c[0],g="";if(c[1]!=undefined)g=c[1];f=f+'<span class="orgtype">'+g+"</span>";$("#contactsGridView").setRowData(b,{sel:'<input class="ml4" type="checkbox"/>',firstName:f});$("#"+b,"#contactsGridView").find("td:eq(3)").attr("title",c[0])},altRows:true,autowidth:true,cellEdit:false,cellSubmit:"remote",cellurl:"/dashboard/contacts/update",
colNames:["","","","Main Contact","Organization","Phone No.","Email",""],colModel:[{name:"pid",hidden:true},{name:"sel",width:20,sortable:false,editable:false},{name:"thumbnail",classes:"jqgrid_thumb",index:"thumbnail",width:50,align:"center",sortable:false},{name:"firstName",index:"firstName",width:130,align:"left"},{name:"name",index:"organisation1.name",width:250,align:"left"},{name:"phone",index:"phoneNumber",width:120,align:"left",editable:true},{name:"email",index:"email",width:150,align:"left",
editable:true},{name:"act",width:50,align:"center",padding:4,sortable:false}],datatype:"json",height:"100%",hoverrows:false,imgpath:"/Content/images",loadComplete:function(){$("#gview_contactsGridView").find(".ui-jqgrid-htable tr > th:eq(1)").html('<input id="cbAll" type="checkbox"/>');$("#cbAll","#gview_contactsGridView").bind("click",function(){$(this).is(":checked")?$("#contactsGridView input:checkbox").attr("checked",true):$("#contactsGridView input:checkbox").attr("checked",false);$.each($("#contactsGridView input:checkbox"),
function(){var b=$(this).parents("tr");a(b)})});$("#contactsGridView input:checkbox").bind("click",function(){var b=$(this).parents("tr");a(b)})},mtype:"POST",onPaging:function(){$.scrollTo("#container",800)},onSelectRow:function(b){b=$("#"+b);var d=b.find("input:checkbox");d.is(":checked")?d.attr("checked",false):d.attr("checked",true);a(b)},onSortCol:function(b,d){$("#gview_contactsGridView").find(".ui-jqgrid-htable tr > th").removeClass("jqgrid_sorted");$("#gview_contactsGridView").find(".ui-jqgrid-htable tr > th:eq("+
d+")").addClass("jqgrid_sorted")},pager:$("#contactNavigation"),rowNum:10,rowList:[10,50,100,1E3],rownumbers:false,shrinkToFit:true,sortname:"firstName",sortorder:"asc",url:"/dashboard/contacts/grid",viewrecords:true,viewsortcols:true}).navGrid("#contactNavigation",{search:false,refresh:false,edit:false,add:false,del:false})}function reloadCouponsGrid(a){a="/dashboard/coupons/list?cat="+a;$("#couponsGridView").setGridParam({url:a});$("#couponsGridView").trigger("reloadGrid")}
function searchCoupons(a){a="/dashboard/coupons/search?term="+a;$("#couponsGridView").setGridParam({url:a});$("#couponsGridView").trigger("reloadGrid")}
function couponsBindToGrid(){$("#couponsGridView").jqGrid({afterInsertRow:function(a,b){var d=['<span class="jqview" >',b.code,"</span>"];$("#couponsGridView").setRowData(a,{code:d.join("")})},altRows:true,autowidth:true,colNames:["","Coupon Code","Discount","Description","Start Date","Expiry Date","Impressions","Status"],colModel:[{name:"id",hidden:true},{name:"code",index:"code",width:80,align:"center"},{name:"discount",index:"discount",width:70,align:"left",sortable:false},{name:"description",
width:325,align:"left",sortable:false},{name:"startDate",index:"startDate",width:70,align:"left",sorttype:"date"},{name:"expiryDate",index:"expiryDate",width:70,align:"left",sorttype:"date"},{name:"impressions",index:"impressions",width:62,align:"center"},{name:"status",index:"status",width:62,align:"center",sortable:false}],datatype:"json",loadComplete:function(){$(".jqview","#couponsGridView").click(function(){var a=$(this).parents("tr").find("td:first").text();dialogBox_open("/dashboard/coupons/edit/"+
a,600);return false});init_jqgrids("#marketing_coupons")},height:"100%",hoverrows:false,imgpath:"/Content/images",mtype:"POST",onPaging:function(){$.scrollTo("#container",800)},onSortCol:function(a,b){$("#gview_couponsGridView").find(".ui-jqgrid-htable tr > th").removeClass("jqgrid_sorted");$("#gview_couponsGridView").find(".ui-jqgrid-htable tr > th:eq("+b+")").addClass("jqgrid_sorted")},pager:"couponsGridNavigation",rowNum:10,rowList:[10,50,100,1E3],rownumbers:false,shrinkToFit:true,sortname:"id",
sortorder:"desc",url:"/dashboard/coupons/list",viewrecords:true,viewsortcols:true}).navGrid("couponsGridNavigation",{refresh:false,search:false,edit:false,add:false,del:false})}
function reloadTransactionsGrid(a){var b=$("#typesList .selected",a).attr("fid"),d=$("#timeLine .selected",a).attr("fid"),c=$("#statusList .selected",a).attr("fid");a=$("#searchInput",a).val();if(a.indexOf("search")!=-1)a="";b="/dashboard/transactions/list?type="+b+"&interval="+d+"&term="+a+"&status="+c;$("#transactionsGridView").setGridParam({url:b});$("#transactionsGridView").trigger("reloadGrid")}
function transactionsBindToGrid(){$("#transactionsGridView").jqGrid({altRows:true,autowidth:false,colNames:["Invoice/Order #","Details","Total","Status"],colModel:[{name:"orderNumber",index:"orderNumber",width:130,align:"left"},{name:"details",width:452,align:"left",sortable:false},{name:"total",width:130,align:"right"},{name:"status",index:"status",width:100,align:"center"}],datatype:"json",loadComplete:function(){init_jqgrids("#transactions_all")},height:"100%",hoverrows:false,imgpath:"/Content/images",
mtype:"POST",onPaging:function(){$.scrollTo("#container",800)},onSortCol:function(a,b){$("#gview_transactionsGridView").find(".ui-jqgrid-htable tr > th").removeClass("jqgrid_sorted");$("#gview_transactionsGridView").find(".ui-jqgrid-htable tr > th:eq("+b+")").addClass("jqgrid_sorted")},pager:"transactionsGridNavigation",rowNum:10,rowList:[10,50,100,1E3],rownumbers:false,shrinkToFit:true,sortname:"id",sortorder:"desc",url:"/dashboard/transactions/list",viewrecords:true,viewsortcols:true}).navGrid("transactionsGridNavigation",
{refresh:false,search:false,edit:false,add:false,del:false})}function reloadGroupPricingGrid(a){if(a==""||a==undefined)a="All";a="/dashboard/group/pricinglist?cat="+a;$("#groupPricingGridView").setGridParam({url:a});$("#groupPricingGridView").trigger("reloadGrid")}
function groupPricingBindToGrid(){var a=function(b){b.toggleClass("selected-row")};$("#groupPricingGridView").jqGrid({afterInsertRow:function(b){$("#groupPricingGridView").setRowData(b,{sel:'<input class="ml4" type="checkbox"/>',act:'<span class="jqedit" >edit</span>'})},afterSubmitCell:function(b){b=$.evalJSON(b.responseText);var d=[];if(b.success){d.push(true);d.push("")}else{d.push(false);d.push(b.message)}return d},afterSaveCell:function(){},altRows:true,autowidth:true,cellEdit:false,cellSubmit:"remote",
cellurl:"/dashboard/group/pricingupdate",colNames:["","","","Product","Inventory","Group Price"],colModel:[{name:"pid",hidden:true},{name:"sel",width:20,sortable:false,editable:false},{name:"thumbnail",classes:"jqgrid_thumb",index:"thumbnail",width:50,align:"center",sortable:false},{name:"title",index:"title",width:260,align:"left",sortable:true},{name:"variants",width:383,align:"left",sortable:false},{name:"groupprice",index:"price",width:100,align:"right",sortable:true}],datatype:"json",height:"100%",
imgpath:"/Content/images",loadComplete:function(){$(".jqedit","#groupPricingGridView").click(function(){var b=$(this).parents("tr").attr("id");alert("edit "+b);return false});$("#gview_groupPricingGridView").find(".ui-jqgrid-htable tr > th:eq(1)").html('<input id="cbAll" type="checkbox"/>');$("#cbAll","#gview_groupPricingGridView").bind("click",function(){$(this).is(":checked")?$("#groupPricingGridView input:checkbox").attr("checked",true):$("#groupPricingGridView input:checkbox").attr("checked",
false);$.each($("#groupPricingGridView input:checkbox"),function(){var b=$(this).parents("tr");a(b)})});$("#groupPricingGridView input:checkbox").bind("click",function(){var b=$(this).parents("tr");a(b)});init_jqgrids("#group_pricing")},mtype:"POST",onPaging:function(){$.scrollTo("#container",800)},onSelectRow:function(b){b=$("#"+b);var d=b.find("input:checkbox");d.is(":checked")?d.attr("checked",false):d.attr("checked",true);a(b)},onSortCol:function(b,d){$("#gview_groupPricingGridView").find(".ui-jqgrid-htable tr > th").removeClass("jqgrid_sorted");
$("#gview_groupPricingGridView").find(".ui-jqgrid-htable tr > th:eq("+d+")").addClass("jqgrid_sorted")},pager:"groupPricingGridNavigation",rowNum:10,rowList:[10,50,100,1E3],rownumbers:false,shrinkToFit:true,sortname:"id",sortclass:"jqgrid_sorted",sortorder:"desc",url:"/dashboard/group/pricinglist",viewrecords:true,viewsortcols:true}).navGrid("groupPricingGridNavigation",{refresh:false,search:false,edit:false,add:false,del:false})}
function reloadProductGrid(a){$("#productGridView").setGridParam({url:"/dashboard/product/list",postData:{cat:a,location:$("#locationFilter").html(),flag:$("#statusFilter").html(),collection:$("#collectionsFilter").html(),term:$("#searchInput","#inventory_mine").val()}});$("#productGridView").trigger("reloadGrid")}
function formatStockTotals(a){var b=$("#"+a,"#productGridView").find("td:eq(5) > .bold");a=$("#"+a,"#productGridView").find("td:eq(6)");parseInt(b.text(),10)<=parseInt(a.text(),10)?$(b).css("color","red"):$(b).css("color","black");$(b).addClass("number_inv")}
function productBindToGrid(){var a="/dashboard/product/list";if(querySt("alarm")==1)a+="?alarm=1";var b=function(d){d.toggleClass("selected-row")};$("#productGridView").jqGrid({afterInsertRow:function(d){$("#productGridView").setRowData(d,{sel:'<input class="ml4" type="checkbox"/>'})},afterSubmitCell:function(d){d=$.evalJSON(d.responseText);var c=[];if(d.success){c.push(true);c.push("")}else{c.push(false);c.push(d.message)}return c},afterSaveCell:function(d){formatStockTotals(d)},altRows:true,autowidth:false,
cellEdit:false,cellSubmit:"remote",cellurl:"/dashboard/product/update",colNames:["","","","Product","Inventory","Total","Views"],colModel:[{name:"pid",hidden:true},{name:"sel",width:20,sortable:false,editable:false},{name:"thumbnail",classes:"jqgrid_thumb",index:"thumbnail",width:50,align:"center",sortable:false},{name:"title",index:"title",width:248,align:"left",sortable:true},{name:"variants",width:354,align:"left",sortable:false},{name:"invtotal",width:70,align:"center",editable:true,sortable:false},
{name:"hits",index:"hits",width:70,align:"center",sortable:true}],datatype:"json",height:"100%",imgpath:"/Content/images",loadComplete:function(){$("#gview_productGridView").find(".ui-jqgrid-htable tr > th:eq(1)").html('<input id="cbAll" type="checkbox"/>');$("#cbAll","#gview_productGridView").bind("click",function(){$(this).is(":checked")?$("#productGridView input:checkbox").attr("checked",true):$("#productGridView input:checkbox").attr("checked",false);$.each($("#productGridView input:checkbox"),
function(){var d=$(this).parents("tr");b(d)})});$("#productGridView input:checkbox").bind("click",function(){var d=$(this).parents("tr");b(d)});init_jqgrids("#inventory_mine")},mtype:"POST",onPaging:function(){$.scrollTo("#container",800)},onSelectRow:function(d){d=$("#"+d);var c=d.find("input:checkbox");c.is(":checked")?c.attr("checked",false):c.attr("checked",true);b(d)},onSortCol:function(d,c){$("#gview_productGridView").find(".ui-jqgrid-htable tr > th").removeClass("jqgrid_sorted");$("#gview_productGridView").find(".ui-jqgrid-htable tr > th:eq("+
c+")").addClass("jqgrid_sorted")},pager:"productGridNavigation",rowNum:10,rowList:[10,50,100,1E3],rownumbers:false,shrinkToFit:true,sortname:"id",sortclass:"jqgrid_sorted",sortorder:"desc",url:a,viewrecords:true,viewsortcols:true}).navGrid("productGridNavigation",{refresh:false,search:false,edit:false,add:false,del:false})}tradelr.webdb={};tradelr.webdb.version="1";tradelr.webdb.flags={};tradelr.webdb.flags.NONE=0;tradelr.webdb.flags.UPDATE=1;tradelr.webdb.flags.DELETE=2;
tradelr.webdb.flags.CREATE=3;tradelr.webdb.flags.CLEAR=4;tradelr.webdb.flags.NOTLINKED=5;tradelr.webdb.db=null;tradelr.webdb.createTables=function(a){for(var b=0;b<tradelr.webdb.tables.length;b++){var d=tradelr.webdb.tables[b];a.executeSql("CREATE TABLE IF NOT EXISTS "+d.name+tradelr.webdb.getCreateString(d.name)+";")}};
tradelr.webdb.getCreateString=function(a){a=tradelr.webdb.getTableEntry(a);for(var b=[],d=0;d<a.columns.length;d++)b.push(a.columns[d].name+" "+a.columns[d].type);return"("+b.join(",")+")"};
tradelr.webdb.getDirtyEntries=function(a,b){if(tradelr.webdb.db==null){tradelr.error("failed to open db");return false}var d="";switch(a){case "category":d="SELECT pc.serverid AS parentid, c.* FROM category AS c  LEFT OUTER JOIN category AS pc ON pc.id = c.parentid  WHERE c.cflag != 0 OR c.serverid = (SELECT MAX(serverid) FROM category)";break;case "inventorylocitem":d="SELECT loc.serverid AS locationid, p.serverid AS productid, iloc.* FROM inventorylocitem AS iloc LEFT OUTER JOIN inventoryloc AS loc ON loc.id = iloc.locationid LEFT OUTER JOIN products AS p ON p.id = iloc.productid  WHERE iloc.cflag != 0 OR iloc.serverid = (SELECT MAX(serverid) FROM inventorylocitem)";
break;case "photos":d="SELECT p.serverid AS contextid, ph.* FROM photos AS ph  LEFT OUTER JOIN products AS p ON p.id = ph.contextid WHERE (ph.cflag != 0 AND ph.cflag != 5 AND ph.type = 'PRODUCT') OR ph.serverid = (SELECT MAX(serverid) FROM photos WHERE cflag != 5)";break;case "products":d="SELECT c.serverid AS categoryid, ph.serverid AS thumbnailid, p.* FROM products AS p LEFT OUTER JOIN category AS c ON c.id = p.categoryid LEFT OUTER JOIN photos AS ph ON ph.id = p.thumbnailid LEFT OUTER JOIN stockunit AS s ON s.id = p.stockunitid  WHERE p.cflag != 0 OR p.serverid = (SELECT MAX(serverid) FROM products)";
break;default:d="SELECT * FROM "+a+" WHERE cflag != 0 OR serverid = (SELECT MAX(serverid) FROM "+a+")";break}tradelr.webdb.db.readTransaction(function(c){c.executeSql(d,[],function(f,g){for(var h=[],j=0;j<g.rows.length;j++)h.push(g.rows.item(j));h={type:a,data:$.toJSON(h)};tradelr.hideLoader=true;$.ajax({type:"POST",url:"/sync",data:h,complete:function(){tradelr.hideLoader=false},success:function(k){k&&k.success&&tradelr.sync.handleResponse(k.data,a);b()},dataType:"json"})},tradelr.webdb.onDbError)})};
tradelr.webdb.getOfflineID=function(a,b,d,c){for(var f=[],g=[],h=[],j=0;j<b.length;j++){var k=b[j];if(k!=null){h.push("a"+j+".id AS a"+j+"id");f.push("a"+j+".serverid="+k);g.push(a[j]+" AS a"+j)}}if(f.length>0){j="SELECT "+h.join(",")+" FROM "+g.join(",")+" WHERE "+f.join(" AND ");DEBUG&&tradelr.log(j);tradelr.webdb.sqlGetValue(j,[],null,function(e){var l=[];if(e!=null)for(var o=0;o<b.length;o++)b[o]!=null?l.push(e["a"+o+"id"]):l.push(null);c(d,l)})}else{a=[];for(j=0;j<b.length;j++)a.push(null);c(d,
a)}};tradelr.webdb.getTableEntry=function(a){for(var b=0;b<tradelr.webdb.tables.length;b++){var d=tradelr.webdb.tables[b];if(d.name==a)return d}return null};
tradelr.webdb.init=function(){if(!$("html").attr("manifest"))return false;if(!tradelr.webdb.open()){tradelr.error("failed to open db");return false}tradelr.webdb.db.version!=tradelr.webdb.version?tradelr.webdb.db.changeVersion(tradelr.webdb.db.version,tradelr.webdb.version,tradelr.webdb.createTables,tradelr.webdb.onDbError,function(){tradelr.webdb.start()}):tradelr.webdb.db.transaction(tradelr.webdb.createTables,tradelr.webdb.onDbError,function(){tradelr.webdb.start()})};tradelr.webdb.loadData=function(){tradelr.sync.init()};
tradelr.webdb.onDbError=function(a,b){tradelr.error(b.message)};tradelr.webdb.open=function(){if(typeof window.openDatabase=="undefined")return false;try{tradelr.webdb.db=openDatabase("tradelr","","tradelr Local DB",52428800)}catch(a){tradelr.error(a.message);return false}return true};tradelr.webdb.start=function(){tradelr.webdb.loadData()};
tradelr.webdb.tables=[{name:"category",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"name",type:" TEXT"},{name:"parentid",type:" INTEGER",link:"category"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},{name:"serverid",type:" INTEGER UNIQUE"}]},{name:"inventoryloc",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"name",type:" TEXT"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},
{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},{name:"serverid",type:" INTEGER UNIQUE"}]},{name:"inventorylocitem",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"locationid",type:" INTEGER",link:"inventoryloc"},{name:"productid",type:" INTEGER",link:"products"},{name:"inventoryLevel",type:" INTEGER"},{name:"onOrder",type:" INTEGER"},{name:"alarmLevel",type:" INTEGER"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},
{name:"serverid",type:" INTEGER UNIQUE"}]},{name:"photos",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"url",type:" TEXT"},{name:"contextid",type:" INTEGER"},{name:"type",type:" TEXT"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},{name:"serverid",type:" INTEGER UNIQUE"}]},{name:"stockunit",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"name",type:" TEXT"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},
{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},{name:"serverid",type:" INTEGER UNIQUE"}]},{name:"products",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"categoryid",type:" INTEGER",link:"category"},{name:"thumbnailid",type:" INTEGER",link:"photos"},{name:"SKU",type:" TEXT"},{name:"title",type:" TEXT"},{name:"details",type:" TEXT"},{name:"sellingPrice",type:" TEXT"},{name:"costPrice",type:" TEXT"},{name:"notes",type:" TEXT"},{name:"paymentterms",type:" TEXT"},{name:"shippingterms",
type:" TEXT"},{name:"stockunitid",type:" INTEGER",link:"stockunit"},{name:"flags",type:" INTEGER"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},{name:"serverid",type:" INTEGER UNIQUE"}]},{name:"settings",columns:[{name:"id",type:" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"currency",type:" TEXT"},{name:"flags",type:" INTEGER"},{name:"ccount",type:" INTEGER NOT NULL DEFAULT 0"},{name:"cflag",type:" INTEGER NOT NULL DEFAULT 0"},{name:"serverid",
type:" INTEGER UNIQUE"}]}];tradelr.sync={};tradelr.sync.getInsertString=function(a){a=tradelr.webdb.getTableEntry(a);for(var b=[],d=[],c=0;c<a.columns.length;c++){var f=a.columns[c].name;if(f!="id"){b.push(f);d.push("?")}}return"("+b.join(",")+") VALUES ("+d.join(",")+")"};tradelr.sync.getUpdateString=function(a){a=tradelr.webdb.getTableEntry(a);for(var b="",d=0;d<a.columns.length;d++)if(a.columns[d].name!="id"){b+=a.columns[d].name;b+="=?,"}return b.slice(0,b.length-1)};
tradelr.sync.getResponseDataArray=function(a,b){for(var d=[],c=tradelr.webdb.getTableEntry(b),f=0;f<c.columns.length;f++){var g=c.columns[f].name;if(g!="id")if(g=="cflag")b=="photos"&&a.type=="PRODUCT"?d.push(tradelr.webdb.flags.NOTLINKED):d.push(tradelr.webdb.flags.NONE);else g=="ccount"?d.push(0):d.push(a[g])}if(DEBUG)tradelr.webdb.rows=d;return d};
tradelr.sync.handleResponse=function(a,b){tradelr.webdb.db.transaction(function(d){$.each(a,function(){var c=this.id,f=this.serverid;switch(this.cflag){case tradelr.webdb.flags.UPDATE:if(f==null)DEBUG&&tradelr.log("FAIL: trying to update "+b);else{var g="UPDATE "+b+" SET "+tradelr.sync.getUpdateString(b)+" WHERE serverid="+f;DEBUG&&tradelr.log(g);d.executeSql(g,tradelr.sync.getResponseDataArray(this,b),null,tradelr.webdb.onDbError)}break;case tradelr.webdb.flags.DELETE:g="DELETE FROM "+b+" WHERE id=?";
DEBUG&&tradelr.log(g);d.executeSql(g,[c],null,tradelr.webdb.onDbError);break;case tradelr.webdb.flags.CREATE:switch(b){case "category":g=["category"];var h=[this.parentid];tradelr.webdb.getOfflineID(g,h,this,function(j,k){for(var e=["parentid"],l=[j.parentid],o=false,m=0;m<l.length;m++)if(l[m]!=null)if(k[m]==null)o=true;else j[e[m]]=k[m];if(!o){var n="INSERT INTO "+b+tradelr.sync.getInsertString(b);DEBUG&&tradelr.log(n);tradelr.webdb.db.transaction(function(q){q.executeSql(n,tradelr.sync.getResponseDataArray(j,
b),null,tradelr.webdb.onDbError)})}});break;case "inventorylocitem":g=["inventoryloc","products"];h=[this.locationid,this.productid];tradelr.webdb.getOfflineID(g,h,this,function(j,k){for(var e=["locationid","productid"],l=[j.locationid,j.productid],o=false,m=0;m<l.length;m++)if(l[m]!=null)if(k[m]==null)o=true;else j[e[m]]=k[m];if(!o){var n="INSERT INTO "+b+tradelr.sync.getInsertString(b);DEBUG&&tradelr.log(n);tradelr.webdb.db.transaction(function(q){q.executeSql(n,tradelr.sync.getResponseDataArray(j,
b),null,tradelr.webdb.onDbError)})}});break;case "photos":g="INSERT INTO "+b+tradelr.sync.getInsertString(b);DEBUG&&tradelr.log(g);d.executeSql(g,tradelr.sync.getResponseDataArray(this,b),null,tradelr.webdb.onDbError);break;case "products":g=["category","photos","stockunit"];h=[this.categoryid,this.thumbnailid,this.stockunitid];tradelr.webdb.getOfflineID(g,h,this,function(j,k){for(var e=["categoryid","thumbnailid","stockunitid"],l=[j.categoryid,j.thumbnailid,j.stockunitid],o=false,m=0;m<l.length;m++)if(l[m]!=
null)if(k[m]==null)o=true;else j[e[m]]=k[m];if(!o){var n="INSERT INTO "+b+tradelr.sync.getInsertString(b);DEBUG&&tradelr.log(n);tradelr.webdb.db.transaction(function(q){q.executeSql(n,tradelr.sync.getResponseDataArray(j,b),null,tradelr.webdb.onDbError)})}});break;default:g="INSERT INTO "+b+tradelr.sync.getInsertString(b);DEBUG&&tradelr.log(g);d.executeSql(g,tradelr.sync.getResponseDataArray(this,b),null,tradelr.webdb.onDbError);break}break;case tradelr.webdb.flags.CLEAR:g="SELECT ccount,cflag FROM "+
b+" WHERE id="+c;tradelr.webdb.sqlGetRows(g,[],c,function(j){var k=j.item(0);j=k.ccount;switch(k.cflag){case tradelr.webdb.flags.CREATE:if(j>0)throw"FAIL: modification of row that has been created (cflag not set to UPDATE) table:"+b+" id:"+c;j={tablename:b,params:[{cflag:tradelr.webdb.flags.NONE,ccount:0,serverid:f}],matches:[{id:c}]};tradelr.webdb.sqlUpdateRows([j],false,null);break;case tradelr.webdb.flags.UPDATE:k=tradelr.webdb.flags.NONE;var e=0;if(j>1){e=1;k=tradelr.webdb.flags.UPDATE}j={tablename:b,
params:[{cflag:k,ccount:e}],matches:[{id:c}]};tradelr.webdb.sqlUpdateRows([j],false,null);break;case tradelr.webdb.flags.DELETE:j={tablename:b,matches:[{id:c}]};tradelr.webdb.sqlDeleteRows([j],false);break;default:if(DEBUG){tradelr.log("unknown client flag");tradelr.log(k)}break}});break;default:if(DEBUG){tradelr.log("unknown server flag");tradelr.log(row)}break}})})};
tradelr.sync.init=function(){navigator.onLine&&tradelr.webdb.db!=null&&tradelr.sync.start();setInterval(function(){navigator.onLine&&tradelr.webdb.db!=null&&tradelr.sync.start()},6E4)};
tradelr.sync.start=function(){tradelr.webdb.getDirtyEntries("settings",function(){tradelr.webdb.getDirtyEntries("stockunit",function(){tradelr.webdb.getDirtyEntries("inventoryloc",function(){tradelr.webdb.getDirtyEntries("category",function(){tradelr.webdb.getDirtyEntries("photos",function(){tradelr.webdb.getDirtyEntries("products",function(){tradelr.webdb.sqlLinkUpdate("photos",function(){tradelr.webdb.getDirtyEntries("inventorylocitem",function(){$.post("/sync/touched")})})})})})})})})};
(function(a){a.ajaxswitch=function(b){if(tradelr.webdb.db==null){DEBUG&&tradelr.log("loading from online db");a.ajax(b)}else{if(DEBUG){tradelr.log("loading from offline db");tradelr.log(b)}var d=b.url.split("/"),c="/"+d[1]+"/"+d[2];switch(c){case "/dashboard/category/add":d=convertParamStringToObject(b.data);tradelr.category.add(d.categoryTitle,b.success);break;case "/dashboard/category/addsub":d=convertParamStringToObject(b.data);tradelr.category.addsub(d.categoryTitle,d.id,b.success);break;case "/dashboard/category/delete":tradelr.category.remove(d[3],
b.success);break;case "/dashboard/category/getsub":d=d[d.length-1];b.beforeSend()&&tradelr.category.getsub(d,b.success);break;case "/dashboard/inventory/locationDelete":tradelr.inventory.location.remove(d[3],b.success);break;case "/photos/delete":tradelr.photo.remove(b.data.ids,d[3]);break;case "/dashboard/product/list":if(b.data.supplier)a.ajax(b);else{b.beforeSend();d=b.data;tradelr.product.list(d.cat,d.rows,d.page,d.sidx,d.sord,"",d.location,b.complete)}break;case "/dashboard/product/create":tradelr.product.create(b.data,
b.success);break;case "/dashboard/product/delete":tradelr.product.remove(d[3],b.data.ids,b.success);break;case "/dashboard/product/update":tradelr.product.update(b.data,b.success);break;case "/dashboard/stockUnit/add":d=convertParamStringToObject(b.data);tradelr.stockunit.add(d.unitTitle,b.success);break;default:a.jGrowl("Unable to complete action. You are not online.");DEBUG&&tradelr.log(c);break}}return this}})(jQuery);
tradelr.webdb.ajaxsuccess=function(a,b){if(a==null)a={};var d={statusText:"OK",status:"200",responseText:$.toJSON(a)};b(d,"success")};tradelr.webdb.emptyIfNull=function(a){return a==null?"":a};tradelr.webdb.parsestring=function(a){return a?a:null};tradelr.webdb.parseinteger=function(a){return a?parseInt(a,10):null};tradelr.webdb.parsefloat=function(a){if(a==null||a==undefined)return null;if(typeof a=="string")return parseFloat(a);return a};
tradelr.webdb.sqlDeleteRows=function(a,b,d){DEBUG&&tradelr.log(a);tradelr.webdb.db.transaction(function(c){for(var f=0;f<a.length;f++)for(var g=a[f].tablename,h=a[f].matches,j=0;j<h.length;j++){var k=[];for(var e in h[j])k.push([e,"=",h[j][e]].join(""));var l="";l=b?"UPDATE "+g+" SET cflag="+tradelr.webdb.flags.DELETE+" WHERE "+k.join(" AND "):"DELETE FROM "+g+" WHERE "+k.join(" AND ");DEBUG&&tradelr.log(l);c.executeSql(l,[],function(o,m){m.rowsAffected||DEBUG&&tradelr.log("DELETE FAIL, "+l)},tradelr.webdb.onDbError)}},
tradelr.webdb.onDbError,function(){d!=undefined&&d()})};tradelr.webdb.sqlGetRows=function(a,b,d,c){DEBUG&&tradelr.log(a);tradelr.webdb.db.readTransaction(function(f){f.executeSql(a,b,function(g,h){if(DEBUG)tradelr.sqlrows=h.rows;if(c!=undefined)h.rows.length==0?c(null,d):c(h.rows,d)},tradelr.webdb.onDbError)})};
tradelr.webdb.sqlGetValue=function(a,b,d,c){DEBUG&&tradelr.log(a);tradelr.webdb.db.readTransaction(function(f){f.executeSql(a,b,function(g,h){var j=null;if(h.rows.length>0)j=h.rows.item(0);if(DEBUG)tradelr.sqlval=j;c!=undefined&&c(j,d)},tradelr.webdb.onDbError)})};
tradelr.webdb.sqlInsertRows=function(a,b){DEBUG&&tradelr.log(a);var d=[];tradelr.webdb.db.transaction(function(c){for(var f=0;f<a.length;f++)for(var g=a[f].tablename,h=a[f].params,j=0;j<h.length;j++){var k=[],e=[];for(var l in h[j])if(!(l=="cflag"||l=="ccount"||l=="serverid")){k.push(l);e.push(h[j][l])}k.push("ccount");e.push(0);k.push("cflag");e.push(tradelr.webdb.flags.CREATE);k.push("serverid");e.push(null);for(var o=[],m=0;m<k.length;m++)o.push("?");k="INSERT INTO "+g+" ("+k.join(",")+") VALUES ("+
o.join(",")+")";DEBUG&&tradelr.log(k);c.executeSql(k,e,function(n,q){d.push(q.insertId)},tradelr.webdb.onDbError)}},tradelr.webdb.onDbError,function(){b!=undefined&&b(d)})};
tradelr.webdb.sqlLinkUpdate=function(a,b){switch(a){case "photos":tradelr.webdb.sqlGetRows("SELECT * FROM photos WHERE cflag="+tradelr.webdb.flags.NOTLINKED,[],null,function(d){if(d!=null)for(var c=0;c<d.length;c++){var f=d.item(c),g=[];switch(f.type){case "PRODUCT":g.push("products");break;case "PROFILE":break;case "COMPANY":break;default:break}if(g.length!=0){var h=[f.contextid];tradelr.webdb.getOfflineID(g,h,f,function(j,k){for(var e=false,l=0;l<h.length;l++)if(h[l]!=null)if(k[l]==null)e=true;
if(!e){var o=[k[0],tradelr.webdb.flags.NONE,j.id];DEBUG&&tradelr.log("UPDATE photos SET contextid=?,cflag=? WHERE id=?");tradelr.webdb.db.transaction(function(m){m.executeSql("UPDATE photos SET contextid=?,cflag=? WHERE id=?",o,null,tradelr.webdb.onDbError)})}})}}b()});break;default:break}};
tradelr.webdb.sqlUpdateRows=function(a,b,d){DEBUG&&tradelr.log(a);tradelr.webdb.db.transaction(function(c){for(var f=function(t,v,w,z){c.executeSql(t,v,function(B,p){p.rowsAffected||b&&tradelr.webdb.sqlInsertRows([{tablename:w,params:[z]}])},tradelr.webdb.onDbError)},g=0;g<a.length;g++)for(var h=a[g].tablename,j=a[g].params,k=a[g].matches,e=0;e<j.length;e++){var l=[],o=[],m=[];for(var n in j[e]){var q=j[e][n];if(q.indexOf(n+"+")==0)m.push(n+"="+q+",");else{l.push(n);o.push(q)}}for(q=0;q<l.length;q++)m.push(l[q]);
m.indexOf("ccount")==-1&&m.push("ccount=ccount+1");var r;for(q=0;q<m.length;q++){l=m[q];if(l.charAt(l.length-1)==",")r+=l;else if(q==m.length-1){if(l!="ccount=ccount+1")r+="=?"}else{r+=l;r+="=?,"}}m=[];for(n in k[e])m.push([n,"=",k[e][n]].join(""));m="UPDATE "+h+" SET "+r+" WHERE "+m.join(" AND ");DEBUG&&tradelr.log(m);f(m,o,h,j[e])}},tradelr.webdb.onDbError,d)};tradelr.product={};tradelr.product.create=function(a,b){tradelr.product.modify(a,false,b)};
tradelr.product.list=function(a,b,d,c,f,g,h,j){g="SELECT p.id, p.sellingPrice, p.SKU, p.title,ph.url, c.name, SUM(loc.inventoryLevel), SUM(loc.onOrder), setting.currency FROM products AS p, settings AS setting  LEFT OUTER JOIN photos AS ph ON p.thumbnailid = ph.id AND ph.cflag !="+tradelr.webdb.flags.DELETE+" LEFT OUTER JOIN inventorylocitem AS loc ON loc.productid = p.id";if(h)g+=" AND loc.locationid = "+h;g+=" LEFT OUTER JOIN category AS c ON c.id = p.categoryid";if(a)g+=" WHERE p.categoryid = "+
a+" OR c.parentid = "+a;g+=g.indexOf("WHERE")==-1?" WHERE p.cflag !="+tradelr.webdb.flags.DELETE:" AND p.cflag !="+tradelr.webdb.flags.DELETE;g+=" GROUP BY p.id,p.SKU,p.title,ph.url,c.name,p.sellingPrice";if(c!=undefined&&f!=undefined)if(f=="asc")g+=c=="id"?" ORDER BY p.serverid":" ORDER BY upper(p."+c+")";else if(f=="desc")g+=c=="id"?" ORDER BY p.serverid DESC":" ORDER BY upper(p."+c+") DESC";tradelr.webdb.sqlGetRows(g,[],null,function(k){if(k==null)return tradelr.webdb.ajaxsuccess(k,j);var e=k.length,
l=Math.floor(e/b);e%b!=0&&l++;var o=[],m=b*(d-1),n;n=e-m<b?e:parseInt(b,10)+parseInt(m,10);for(var q=m;q<n;q++){var r=k.item(q);try{var t=[r.id,"",r.url?"<img src='"+r.url+"' class='jqgrid_thumb' />":"<img src='/Content/img/thumbs_none.png' />",r.SKU,tradelr.product.ToProductTitle(r.title,r.sellingPrice,r.name,r.currency),r["SUM(loc.inventoryLevel)"],r["SUM(loc.onOrder)"],"n/a",""];o.push({id:r.id,cell:t})}catch(v){if(DEBUG){tradelr.row=r;tradelr.log(v.message+" "+r.id+" "+m+" "+n)}}}k={page:d,total:l,
records:e,rows:o};if(DEBUG)tradelr.rows=o;tradelr.webdb.ajaxsuccess(k,j)})};tradelr.product.ToProductTitle=function(a,b,d,c){if(b&&d)return["<span class='pt'>",a,"</span><span class='pc'>",d,", </span><span class='sp'>",c,parseFloat(b).toFixed(2),"</span>"].join("");if(b)return["<span class='pt'>",a,"</span><span class='sp'>",c,parseFloat(b).toFixed(2),"</span>"].join("");if(d)return["<span class='pt'>",a,"</span><span class='pc'>",d,"</span>"].join("");return["<span class='pt'>",a,"</span>"].join("")};
tradelr.product.modify=function(a,b,d){var c,f=convertParamStringToObject(a),g=tradelr.webdb.flags.CREATE;if(b){c=tradelr.webdb.parseinteger(f.id);g=tradelr.webdb.flags.UPDATE}var h=[];a={};if(f.costPrice)a.costPrice=tradelr.webdb.parsestring(f.costPrice);if(f.defaultPhotoID)a.thumbnailid=tradelr.webdb.parseinteger(f.defaultPhotoID);if(f.details)a.details=f.details;a.categoryid=f.subcategory?tradelr.webdb.parseinteger(f.subcategory):f.maincategory?tradelr.webdb.parseinteger(f.maincategory):null;if(f.notes)a.notes=
f.notes;if(f.sellingPrice)a.sellingPrice=tradelr.webdb.parsestring(f.sellingPrice);if(f.sku)a.SKU=f.sku;if(f.title)a.title=f.title;if(f.stockUnit)a.stockunitid=tradelr.webdb.parseinteger(f.stockUnit);a.cflag=g;var j=function(k,e,l){if(f.location){var o=[],m=[];if(f.location.length)for(var n=0;n<f.location.length;n++){var q={inventoryLevel:tradelr.webdb.parseinteger(f.inStock[n]),alarmLevel:tradelr.webdb.parseinteger(f.reorderLevel[n]),locationid:tradelr.webdb.parseinteger(f.location[n]),productid:k,
cflag:g};o.push(q);q={locationid:tradelr.webdb.parseinteger(f.location[n]),productid:k};m.push(q)}else{q={inventoryLevel:tradelr.webdb.parseinteger(f.inStock),alarmLevel:tradelr.webdb.parseinteger(f.reorderLevel),cflag:g};o.push(q);q={locationid:tradelr.webdb.parseinteger(f.location),productid:k};m.push(q)}h.push({tablename:"inventorylocitem",params:o,matches:m})}e?tradelr.webdb.sqlUpdateRows(h,true,function(){l({success:true,data:k})}):tradelr.webdb.sqlInsertRows(h,function(){l({success:true,data:k})})};
if(b){h.push({tablename:"products",params:[a],matches:[{id:c}]});j(c,b,d)}else tradelr.webdb.sqlInsertRows([{tablename:"products",params:[a]}],function(k){j(k[0],b,d)})};tradelr.product.remove=function(a,b,d){tradelr.photo.removeByProduct(a);tradelr.inventory.location.removeItem(a);tradelr.webdb.sqlDeleteRows([{tablename:"products",matches:[{id:a}]}],true,function(){d({success:true,data:a})})};tradelr.product.update=function(a,b){tradelr.product.modify(a,true,b)};tradelr.category={};
tradelr.category.add=function(a,b){tradelr.category.exist(a,null,function(d){d?b({success:false,message:"Category already exist"}):tradelr.webdb.sqlInsertRows([{tablename:"category",params:[{name:a,parentid:null}]}],function(c){b({success:true,data:{title:a,id:c[0]}})})})};
tradelr.category.addsub=function(a,b,d){tradelr.category.exist(a,b,function(c){c?d({success:false,message:"Category already exist"}):tradelr.webdb.sqlInsertRows([{tablename:"category",params:[{name:a,parentid:b}]}],function(f){d({success:true,data:{title:a,id:f[0]}})})})};
tradelr.category.exist=function(a,b,d){b==null?tradelr.webdb.sqlGetValue("SELECT id FROM category WHERE name=?",[a],null,function(c){c==null?d(false):d(true)}):tradelr.webdb.sqlGetValue("SELECT id FROM category WHERE name=? AND parentid=?",[a,b],null,function(c){c==null?d(false):d(true)})};
tradelr.category.getsub=function(a,b){tradelr.webdb.sqlGetRows("SELECT * FROM category WHERE parentid=?",[a],a,function(d){var c=[];if(d!=null)for(var f=0;f<d.length;f++){var g=d.item(f);c.push({id:g.id,title:g.name})}b({success:true,data:c})})};
tradelr.category.remove=function(a,b){tradelr.webdb.sqlDeleteRows([{tablename:"category",matches:[{id:a},{parentid:a}]}],true,function(){tradelr.webdb.sqlUpdateRows({tablename:"products",params:[{categoryid:null}],matches:[{categoryid:a}]},false,function(){b({success:true,data:a})})})};tradelr.stockunit={};
tradelr.stockunit.add=function(a,b){tradelr.stockunit.exist(a,function(d){d?b({success:false,message:"Stock Unit already exist"}):tradelr.webdb.sqlInsertRows([{tablename:"stockunit",params:[{name:a}]}],function(c){b({success:true,data:{title:a,id:c[0]}})})})};tradelr.stockunit.exist=function(a,b){tradelr.webdb.sqlGetValue("SELECT id FROM stockunit WHERE name=?",[a],null,function(d){d==null?b(false):b(true)})};tradelr.photo={};tradelr.photo.size={};tradelr.photo.size.MEDIUM=260;
tradelr.photo.remove=function(a,b){var d={tablename:"photos",matches:[{id:a,type:["'",b,"'"].join("").toUpperCase()}]};tradelr.webdb.sqlDeleteRows([d],true);switch(b){case "PRODUCT":d={tablename:"products",params:[{cflag:tradelr.webdb.flags.UPDATE,thumbnailid:null}],matches:[{thumbnailid:a}]};tradelr.webdb.sqlUpdateRows([d],false);break;default:break}};tradelr.photo.removeByProduct=function(a){tradelr.webdb.sqlDeleteRows([{tablename:"photos",matches:[{contextid:a,type:"'PRODUCT'"}]}],true)};
tradelr.photo.resize=function(a,b,d,c){var f=document.createElement("img");f.style.display="none";document.body.appendChild(f);f.addEventListener("load",function(){var g=1;if(f.width>d||f.height>d)g=d/Math.max(f.width,f.height);var h=document.createElement("canvas");h.width=f.width*g;h.height=f.height*g;h.setAttribute("alt",b);h.ctx=h.getContext("2d");h.ctx.save();h.ctx.scale(g,g);h.ctx.drawImage(f,0,0);h.ctx.restore();document.body.removeChild(f);c(h)},true);f.src=a};tradelr.inventory={};
tradelr.inventory.location={};tradelr.inventory.location.order=function(a,b){if(a.locid>b.locid)return-1;if(a.locid<b.locid)return 1;return 0};
tradelr.inventory.location.remove=function(a,b){tradelr.webdb.sqlGetValue("SELECT id FROM inventoryloc WHERE name='Main'",[],null,function(d){if(d!=null){var c=d.id;tradelr.webdb.sqlGetRows("SELECT * FROM inventorylocitem WHERE locationid = ?",[a],null,function(f){for(var g=[],h=0;h<f.length;h++){var j=f.item(h);g.push({productid:j.productid,ilevel:j.inventoryLevel,onOrder:j.onOrder})}f={tablename:"inventorylocitem",params:[],matches:[]};for(h=0;h<g.length;h++){j=g[h].ilevel;var k=g[h].onOrder;if(j!=
null&&j!=0){f.params.push({inventoryLevel:"inventoryLevel+"+j});f.matches.push({locationid:c,productid:g[h].productid})}if(k!=null&&k!=0){f.params.push({onOrder:"onOrder+"+k});f.matches.push({locationid:c,productid:g[h].productid})}}tradelr.webdb.sqlUpdateRows([f],true,function(){tradelr.webdb.sqlDeleteRows([{tablename:"inventorylocitem",matches:[{locationid:a}]}],true);tradelr.webdb.sqlDeleteRows([{tablename:"inventoryloc",matches:[{id:a}]}],true);b({success:true})})})}})};
tradelr.inventory.location.removeItem=function(a){tradelr.webdb.sqlDeleteRows([{tablename:"inventorylocitem",matches:[{productid:a}]}],true)};tradelr.views={};
tradelr.views.sidelocation=function(a){tradelr.webdb.sqlGetRows("SELECT * FROM inventoryloc WHERE cflag !="+tradelr.webdb.flags.DELETE+" ORDER BY serverid",[],null,function(b){var d=[];if(b!=null){for(var c=0;c<b.length;c++){var f=b.item(c);f={id:f.id,name:f.name};d.push(f)}b=[];for(c=0;c<d.length;c++){f=d[c];b.push("<div class='sideboxEntry' fid='");b.push(f.id);b.push("'><div class='title'>");b.push(f.name);b.push("</div>");b.push("<div class='del'></div>");b.push("</div>")}a(b.join(""))}})};
tradelr.views.sidecategory=function(a){tradelr.webdb.sqlGetRows("SELECT * FROM category WHERE cflag !="+tradelr.webdb.flags.DELETE+" ORDER BY parentid,name",[],null,function(b){var d=[];if(b!=null){for(var c=0;c<b.length;c++){var f=b.item(c),g=f.parentid,h=f.name,j=f.id;if(g==null)d.push({id:j,name:h,subcats:[]});else for(f=0;f<d.length;f++){var k=d[f];k.id==g&&k.subcats.push({id:j,name:h})}}b=[];for(c=0;c<d.length;c++){g=d[c];b.push("<div class='sideboxEntry' fid='");b.push(g.id);b.push("'><div class='title'>");
b.push(g.name);b.push("</div>");b.push("<div class='del'></div>");b.push("</div>");for(f=0;f<g.subcats.length;f++){h=g.subcats[f];b.push("<div class='sideboxSubEntry' fid='");b.push(h.id);b.push("'><div class='title'>");b.push(h.name);b.push("</div>");b.push("<div class='del'></div>");b.push("</div>")}}a(b.join(""))}})};
